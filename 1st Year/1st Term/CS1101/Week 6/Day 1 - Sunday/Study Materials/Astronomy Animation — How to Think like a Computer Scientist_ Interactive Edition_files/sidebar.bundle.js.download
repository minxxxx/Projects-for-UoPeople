!function e(t,n,r){var o="function"==typeof hypothesisRequire&&hypothesisRequire;function i(s,a){if(!n[s]){if(!t[s]){var c="function"==typeof hypothesisRequire&&hypothesisRequire;if(!a&&c)return c(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[s]={exports:{}};t[s][0].call(u.exports,(function(e){var n=t[s][1][e];return i(n||e)}),u,u.exports,e,t,n,r)}return n[s].exports}for(var s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,n){t.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},t.exports.default=t.exports,t.exports.__esModule=!0},{}],2:[function(e,t,n){var r=e("./defineProperty.js");function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}t.exports=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e},t.exports.default=t.exports,t.exports.__esModule=!0},{"./defineProperty.js":1}],3:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--cancel"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 8l3.536-3.536L8 8 4.464 4.464 8 8zm0 0l-3.536 3.536L8 8l3.536 3.536L8 8z"></path></g></svg>\n'},{}],4:[function(e,t,n){t.exports='  <svg\n    width="32"\n    height="32"\n    viewBox="-4 -4 39 39"\n    aria-hidden="true"\n    focusable="false"\n  >\n    <rect\n      class="hyp-svg-checkbox--background"\n      width="35"\n      height="35"\n      x="-2"\n      y="-2"\n      stroke="currentColor"\n      fill="none"\n      stroke-width="3"\n      rx="5"\n      ry="5"\n    />\n    <polyline\n      class="hyp-svg-checkbox--checkmark"\n      points="4,14 12,23 28,5"\n      stroke="transparent"\n      stroke-width="5"\n      fill="none"\n    />\n</svg>'},{}],5:[function(e,t,n){t.exports='<svg viewBox="0 0 64 64">\n  <g stroke-width="6" stroke="currentColor" stroke-linecap="round">\n    <line y1="16" y2="28" transform="translate(32,32) rotate(180)">\n      <animate attributeName="stroke-opacity" dur="750ms" values="0;1;.8;.65;.45;.3;.15;0" repeatCount="indefinite"></animate>\n    </line>\n    <line y1="16" y2="28" transform="translate(32,32) rotate(225)">\n      <animate attributeName="stroke-opacity" dur="750ms" values=".15;0;1;.8;.65;.45;.3;.15" repeatCount="indefinite"></animate>\n    </line>\n    <line y1="16" y2="28" transform="translate(32,32) rotate(270)">\n      <animate attributeName="stroke-opacity" dur="750ms" values=".3;.15;0;1;.8;.65;.45;.3" repeatCount="indefinite"></animate>\n    </line>\n    <line y1="16" y2="28" transform="translate(32,32) rotate(315)">\n      <animate attributeName="stroke-opacity" dur="750ms" values=".45;.3;.15;0;1;.85;.65;.45" repeatCount="indefinite"></animate>\n    </line>\n    <line y1="16" y2="28" transform="translate(32,32) rotate(0)">\n      <animate attributeName="stroke-opacity" dur="750ms" values=".65;.45;.3;.15;0;1;.8;.65;" repeatCount="indefinite"></animate>\n    </line>\n    <line y1="16" y2="28" transform="translate(32,32) rotate(45)">\n      <animate attributeName="stroke-opacity" dur="750ms" values=".8;.65;.45;.3;.15;0;1;.8" repeatCount="indefinite"></animate>\n    </line>\n    <line y1="16" y2="28" transform="translate(32,32) rotate(90)">\n      <animate attributeName="stroke-opacity" dur="750ms" values="1;.85;.6;.45;.3;.15;0;1;" repeatCount="indefinite"></animate>\n    </line>\n    <line y1="16" y2="28" transform="translate(32,32) rotate(135)">\n      <animate attributeName="stroke-opacity" dur="750ms" values="0;1;.8;.65;.45;.3;.15;0" repeatCount="indefinite"></animate>\n    </line>\n  </g>\n</svg>'},{}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.normalizeKeyName=function(e){const t={Left:"ArrowLeft",Up:"ArrowUp",Down:"ArrowDown",Right:"ArrowRight",Spacebar:" ",Del:"Delete"};return t[e]?t[e]:e}},{}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Checkbox=u,n.LabeledCheckbox=function(e){var t;let{children:n,id:r}=e,s=l(e,["children","id"]);return null!==(t=r)&&void 0!==t||(r=s.name),(0,o.jsxDEV)("label",{htmlFor:r,className:"Hyp-LabeledCheckbox",children:[(0,o.jsxDEV)(u,a({id:r},s),void 0,!1,{fileName:i,lineNumber:76,columnNumber:7},this),(0,o.jsxDEV)("span",{"data-testid":"label-text",children:n},void 0,!1,{fileName:i,lineNumber:77,columnNumber:7},this)]},void 0,!0,{fileName:i,lineNumber:75,columnNumber:5},this)};var r=e("./SvgIcon"),o=e("preact/compat/jsx-dev-runtime"),i="/home/runner/work/frontend-shared/frontend-shared/src/components/Checkbox.js";function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function u(e){let{inputRef:t,onToggle:n,onClick:s}=e,c=l(e,["inputRef","onToggle","onClick"]);return(0,o.jsxDEV)(o.Fragment,{children:[(0,o.jsxDEV)("input",a({className:"Hyp-Checkbox",ref:t,type:"checkbox",onClick:function(e){null==n||n(e.currentTarget.checked),null==s||s.call(this,e)}},c),void 0,!1,{fileName:i,lineNumber:55,columnNumber:7},this),(0,o.jsxDEV)(r.SvgIcon,{className:"hyp-svg-checkbox",name:"hyp-checkbox"},void 0,!1,{fileName:i,lineNumber:62,columnNumber:7},this)]},void 0,!0)}(0,r.registerIcons)({"hyp-checkbox":e("../../images/icons/checkbox.svg")})},{"../../images/icons/checkbox.svg":4,"./SvgIcon":12,"preact/compat/jsx-dev-runtime":25}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Dialog=function({buttons:e,cancelLabel:t="Cancel",children:n,contentClass:r,icon:u,initialFocus:f,onCancel:p,role:h="dialog",title:m}){const g=d("dialog-description"),v=d("dialog-title"),y=(0,i.useRef)(null);return(0,i.useEffect)((()=>{if(null!==f){const e=null==f?void 0:f.current;e&&!e.disabled?e.focus():y.current.focus()}}),[]),(0,i.useLayoutEffect)((()=>{const e=y.current.querySelector("p");e&&(e.id=g,y.current.setAttribute("aria-describedby",g))}),[g]),(0,c.jsxDEV)("div",{"aria-labelledby":v,className:(0,o.default)("Hyp-Dialog",{"Hyp-Dialog--closeable":!!p},r),ref:y,role:h,tabIndex:-1,children:[(0,c.jsxDEV)("header",{children:[u&&(0,c.jsxDEV)("div",{className:"Hyp-Dialog__header-icon",children:(0,c.jsxDEV)(a.SvgIcon,{name:u,title:m,"data-testid":"header-icon"},void 0,!1,{fileName:l,lineNumber:129,columnNumber:13},this)},void 0,!1,{fileName:l,lineNumber:128,columnNumber:11},this),(0,c.jsxDEV)("h2",{className:"Hyp-Dialog__title",id:v,children:m},void 0,!1,{fileName:l,lineNumber:132,columnNumber:9},this),p&&(0,c.jsxDEV)("div",{className:"Hyp-Dialog__close",children:(0,c.jsxDEV)(s.IconButton,{icon:"hyp-cancel",title:"Close",onClick:p},void 0,!1,{fileName:l,lineNumber:137,columnNumber:13},this)},void 0,!1,{fileName:l,lineNumber:136,columnNumber:11},this)]},void 0,!0,{fileName:l,lineNumber:126,columnNumber:7},this),n,(0,c.jsxDEV)("div",{className:"Hyp-Dialog__actions",children:[p&&(0,c.jsxDEV)(s.LabeledButton,{"data-testid":"cancel-button",onClick:p,children:t},void 0,!1,{fileName:l,lineNumber:144,columnNumber:11},this),e]},void 0,!0,{fileName:l,lineNumber:142,columnNumber:7},this)]},void 0,!0,{fileName:l,lineNumber:115,columnNumber:5},this)};var r,o=(r=e("classnames"))&&r.__esModule?r:{default:r},i=e("preact/hooks"),s=e("./buttons"),a=e("./SvgIcon"),c=e("preact/compat/jsx-dev-runtime"),l="/home/runner/work/frontend-shared/frontend-shared/src/components/Dialog.js";(0,a.registerIcons)({"hyp-cancel":e("../../images/icons/cancel.svg")});let u=0;function d(e){const[t]=(0,i.useState)((()=>(++u,`${e}-${u}`)));return t}},{"../../images/icons/cancel.svg":3,"./SvgIcon":12,"./buttons":15,classnames:19,"preact/compat/jsx-dev-runtime":25,"preact/hooks":27}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Modal=p,n.ConfirmModal=function(e){let{message:t,confirmAction:n,onConfirm:r,onCancel:o}=e,i=f(e,["message","confirmAction","onConfirm","onCancel"]);return(0,a.jsxDEV)(p,u(u({onCancel:o,buttons:[(0,a.jsxDEV)(s.LabeledButton,{onClick:r,variant:"primary","data-testid":"confirm-button",children:n},"ok",!1,{fileName:c,lineNumber:74,columnNumber:9},this)]},i),{},{children:(0,a.jsxDEV)("p",{children:t},void 0,!1,{fileName:c,lineNumber:85,columnNumber:7},this)}),void 0,!1,{fileName:c,lineNumber:71,columnNumber:5},this)};var r=e("preact/hooks"),o=e("../hooks/use-element-should-close"),i=e("./Dialog"),s=e("./buttons"),a=e("preact/compat/jsx-dev-runtime"),c="/home/runner/work/frontend-shared/frontend-shared/src/components/Modal.js";function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function p(e){let{children:t,onCancel:n}=e,s=f(e,["children","onCancel"]);const l=(0,r.useRef)(null);return(0,o.useElementShouldClose)(l,!0,(()=>{n&&n()})),(0,a.jsxDEV)(a.Fragment,{children:[(0,a.jsxDEV)("div",{className:"Hyp-Modal__overlay"},void 0,!1,{fileName:c,lineNumber:37,columnNumber:7},this),(0,a.jsxDEV)("div",{className:"Hyp-Modal",ref:l,children:(0,a.jsxDEV)(i.Dialog,u(u({onCancel:n},s),{},{children:t}),void 0,!1,{fileName:c,lineNumber:39,columnNumber:9},this)},void 0,!1,{fileName:c,lineNumber:38,columnNumber:7},this)]},void 0,!0)}},{"../hooks/use-element-should-close":17,"./Dialog":8,"./buttons":15,"preact/compat/jsx-dev-runtime":25,"preact/hooks":27}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Panel=function({children:e,icon:t,onClose:n,title:r}){const l=!!n;return(0,a.jsxDEV)("div",{className:(0,o.default)("Hyp-Panel",{"Hyp-Panel--closeable":l}),children:[(0,a.jsxDEV)("header",{children:[t&&(0,a.jsxDEV)("div",{className:"Hyp-Panel__header-icon",children:(0,a.jsxDEV)(s.SvgIcon,{name:t,title:r},void 0,!1,{fileName:c,lineNumber:38,columnNumber:13},this)},void 0,!1,{fileName:c,lineNumber:37,columnNumber:11},this),(0,a.jsxDEV)("h2",{className:"Hyp-Panel__title",children:r},void 0,!1,{fileName:c,lineNumber:41,columnNumber:9},this),l&&(0,a.jsxDEV)("div",{className:"Hyp-Panel__close",children:(0,a.jsxDEV)(i.IconButton,{icon:"hyp-cancel",title:"Close",onClick:n},void 0,!1,{fileName:c,lineNumber:44,columnNumber:13},this)},void 0,!1,{fileName:c,lineNumber:43,columnNumber:11},this)]},void 0,!0,{fileName:c,lineNumber:35,columnNumber:7},this),(0,a.jsxDEV)("div",{className:"Hyp-Panel__content",children:e},void 0,!1,{fileName:c,lineNumber:48,columnNumber:7},this)]},void 0,!0,{fileName:c,lineNumber:30,columnNumber:5},this)};var r,o=(r=e("classnames"))&&r.__esModule?r:{default:r},i=e("./buttons"),s=e("./SvgIcon"),a=e("preact/compat/jsx-dev-runtime"),c="/home/runner/work/frontend-shared/frontend-shared/src/components/Panel.js";(0,s.registerIcons)({"hyp-cancel":e("../../images/icons/cancel.svg")})},{"../../images/icons/cancel.svg":3,"./SvgIcon":12,"./buttons":15,classnames:19,"preact/compat/jsx-dev-runtime":25}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Spinner=function({classes:e="",size:t="medium"}){const n=`Hyp-Spinner--${t}`;return(0,s.jsxDEV)(i.SvgIcon,{name:"hyp-spinner",className:(0,o.default)(n,e)},void 0,!1,{fileName:"/home/runner/work/frontend-shared/frontend-shared/src/components/Spinner.js",lineNumber:26,columnNumber:5},this)};var r,o=(r=e("classnames"))&&r.__esModule?r:{default:r},i=e("./SvgIcon"),s=e("preact/compat/jsx-dev-runtime");(0,i.registerIcons)({"hyp-spinner":e("../../images/icons/spinner--spokes.svg")})},{"../../images/icons/spinner--spokes.svg":5,"./SvgIcon":12,classnames:19,"preact/compat/jsx-dev-runtime":25}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SvgIcon=function({name:e,className:t="",inline:n=!1,title:r=""}){if(!l[e])throw new Error(`Icon name "${e}" is not registered`);const u=l[e],d=(0,i.useRef)();(0,i.useLayoutEffect)((()=>{const e=d.current.querySelector("svg");e&&e.setAttribute("class",t)}),[t,u]);const f={};return r&&(f.title=r),(0,s.jsxDEV)("span",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({className:(0,o.default)("Hyp-SvgIcon",{"Hyp-SvgIcon--inline":n}),dangerouslySetInnerHTML:{__html:u},ref:d},f),void 0,!1,{fileName:"/home/runner/work/frontend-shared/frontend-shared/src/components/SvgIcon.js",lineNumber:69,columnNumber:5},this)},n.registerIcons=function(e,{reset:t=!1}={}){t&&(l={}),Object.assign(l,e)},n.availableIcons=function(){return l};var r,o=(r=e("classnames"))&&r.__esModule?r:{default:r},i=e("preact/hooks"),s=e("preact/compat/jsx-dev-runtime");function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let l={}},{classnames:19,"preact/compat/jsx-dev-runtime":25,"preact/hooks":27}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.TextInput=function(e){let{classes:t="",inputRef:n,hasError:r=!1}=e,a=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["classes","inputRef","hasError"]);return(0,i.jsxDEV)("input",c(c({className:(0,o.default)("Hyp-TextInput",{"has-error":r},t)},a),{},{ref:n,type:"text"}),void 0,!1,{fileName:s,lineNumber:39,columnNumber:5},this)},n.TextInputWithButton=function({children:e,classes:t=""}){return(0,i.jsxDEV)("div",{className:(0,o.default)("Hyp-TextInputWithButton",t),children:e},void 0,!1,{fileName:s,lineNumber:67,columnNumber:5},this)};var r,o=(r=e("classnames"))&&r.__esModule?r:{default:r},i=e("preact/compat/jsx-dev-runtime"),s="/home/runner/work/frontend-shared/frontend-shared/src/components/TextInput.js";function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},{classnames:19,"preact/compat/jsx-dev-runtime":25}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Thumbnail=function({children:e,classes:t="",isLoading:n=!1,placeholder:r="...",size:l="medium"}){const u=(0,i.toChildArray)(e).length?e:r;return(0,a.jsxDEV)("div",{className:(0,o.default)("Hyp-Thumbnail",t),children:(0,a.jsxDEV)("div",{className:"Hyp-Thumbnail__content",children:[n&&(0,a.jsxDEV)(s.Spinner,{size:l},void 0,!1,{fileName:c,lineNumber:59,columnNumber:23},this),!n&&u]},void 0,!0,{fileName:c,lineNumber:58,columnNumber:7},this)},void 0,!1,{fileName:c,lineNumber:57,columnNumber:5},this)};var r,o=(r=e("classnames"))&&r.__esModule?r:{default:r},i=e("preact"),s=e("./Spinner"),a=e("preact/compat/jsx-dev-runtime"),c="/home/runner/work/frontend-shared/frontend-shared/src/components/Thumbnail.js"},{"./Spinner":11,classnames:19,preact:26,"preact/compat/jsx-dev-runtime":25}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.IconButton=function(e){let{className:t="Hyp-IconButton"}=e,n=d(e,["className"]);const{icon:r}=n;return(0,s.jsxDEV)(f,l(l({className:t},n),{},{children:(0,s.jsxDEV)(i.SvgIcon,{name:r},void 0,!1,{fileName:a,lineNumber:94,columnNumber:7},this)}),void 0,!1,{fileName:a,lineNumber:93,columnNumber:5},this)},n.LabeledButton=function(e){let{children:t,className:n="Hyp-LabeledButton"}=e,r=d(e,["children","className"]);const{icon:o,iconPosition:c="left"}=r;return(0,s.jsxDEV)(f,l(l({className:n},r),{},{children:[o&&"left"===c&&(0,s.jsxDEV)(i.SvgIcon,{name:o},void 0,!1,{fileName:a,lineNumber:112,columnNumber:43},this),t,o&&"right"===c&&(0,s.jsxDEV)(i.SvgIcon,{name:o},void 0,!1,{fileName:a,lineNumber:114,columnNumber:44},this)]}),void 0,!0,{fileName:a,lineNumber:111,columnNumber:5},this)},n.LinkButton=function(e){return(0,s.jsxDEV)(f,l({className:"Hyp-LinkButton"},e),void 0,!1,{fileName:a,lineNumber:125,columnNumber:10},this)};var r,o=(r=e("classnames"))&&r.__esModule?r:{default:r},i=e("./SvgIcon"),s=e("preact/compat/jsx-dev-runtime"),a="/home/runner/work/frontend-shared/frontend-shared/src/components/buttons.js";function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function f(e){let{buttonRef:t,className:n,icon:r,iconPosition:i="left",size:c="medium",variant:u="normal",expanded:f,pressed:p,type:h="button"}=e,m=d(e,["buttonRef","className","icon","iconPosition","size","variant","expanded","pressed","type"]);const g={"aria-expanded":f,"aria-pressed":p,"aria-label":m.title};return(0,s.jsxDEV)("button",l(l({ref:t,className:(0,o.default)(n,`${n}--${c}`,`${n}--${u}`,{[`${n}--icon-${i}`]:r}),type:h},g),m),void 0,!1,{fileName:a,lineNumber:68,columnNumber:5},this)}},{"./SvgIcon":12,classnames:19,"preact/compat/jsx-dev-runtime":25}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Frame=function({children:e,classes:t=""}){return(0,i.jsxDEV)("div",{className:(0,o.default)("Hyp-Frame",t),children:e},void 0,!1,{fileName:s,lineNumber:21,columnNumber:10},this)},n.Card=function({children:e,classes:t=""}){return(0,i.jsxDEV)("div",{className:(0,o.default)("Hyp-Card",t),children:e},void 0,!1,{fileName:s,lineNumber:30,columnNumber:10},this)},n.Actions=function({children:e,direction:t="row",classes:n=""}){const r=`Hyp-Actions--${t}`;return(0,i.jsxDEV)("div",{className:(0,o.default)(r,n),children:e},void 0,!1,{fileName:s,lineNumber:48,columnNumber:10},this)},n.Scrollbox=function({children:e,classes:t="",withHeader:n=!1}){const r=n?"Hyp-Scrollbox--with-header":"Hyp-Scrollbox";return(0,i.jsxDEV)("div",{className:(0,o.default)(r,t),children:e},void 0,!1,{fileName:s,lineNumber:65,columnNumber:10},this)};var r,o=(r=e("classnames"))&&r.__esModule?r:{default:r},i=e("preact/compat/jsx-dev-runtime"),s="/home/runner/work/frontend-shared/frontend-shared/src/components/containers.js"},{classnames:19,"preact/compat/jsx-dev-runtime":25}],17:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.useElementShouldClose=function(e,t,n){(0,r.useEffect)((()=>{if(!t)return()=>{};const r=i(document.body,["keydown"],(e=>{const t=e;"Escape"===(0,o.normalizeKeyName)(t.key)&&n()})),s=i(document.body,["focus"],(t=>{e.current.contains(t.target)||n()}),{useCapture:!0}),a=i(document.body,["mousedown","click"],(t=>{e.current.contains(t.target)||n()}),{useCapture:!0});return()=>{r(),a(),s()}}),[e,t,n])};var r=e("preact/hooks"),o=e("../browser-compatibility-utils");function i(e,t,n,{useCapture:r=!1}={}){return t.forEach((t=>e.addEventListener(t,n,r))),()=>{t.forEach((t=>e.removeEventListener(t,n,r)))}}},{"../browser-compatibility-utils":6,"preact/hooks":27}],18:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"IconButton",{enumerable:!0,get:function(){return r.IconButton}}),Object.defineProperty(n,"LabeledButton",{enumerable:!0,get:function(){return r.LabeledButton}}),Object.defineProperty(n,"LinkButton",{enumerable:!0,get:function(){return r.LinkButton}}),Object.defineProperty(n,"LabeledCheckbox",{enumerable:!0,get:function(){return o.LabeledCheckbox}}),Object.defineProperty(n,"Checkbox",{enumerable:!0,get:function(){return o.Checkbox}}),Object.defineProperty(n,"Frame",{enumerable:!0,get:function(){return i.Frame}}),Object.defineProperty(n,"Card",{enumerable:!0,get:function(){return i.Card}}),Object.defineProperty(n,"Actions",{enumerable:!0,get:function(){return i.Actions}}),Object.defineProperty(n,"Scrollbox",{enumerable:!0,get:function(){return i.Scrollbox}}),Object.defineProperty(n,"Dialog",{enumerable:!0,get:function(){return s.Dialog}}),Object.defineProperty(n,"Modal",{enumerable:!0,get:function(){return a.Modal}}),Object.defineProperty(n,"ConfirmModal",{enumerable:!0,get:function(){return a.ConfirmModal}}),Object.defineProperty(n,"Panel",{enumerable:!0,get:function(){return c.Panel}}),Object.defineProperty(n,"Spinner",{enumerable:!0,get:function(){return l.Spinner}}),Object.defineProperty(n,"SvgIcon",{enumerable:!0,get:function(){return u.SvgIcon}}),Object.defineProperty(n,"registerIcons",{enumerable:!0,get:function(){return u.registerIcons}}),Object.defineProperty(n,"TextInput",{enumerable:!0,get:function(){return d.TextInput}}),Object.defineProperty(n,"TextInputWithButton",{enumerable:!0,get:function(){return d.TextInputWithButton}}),Object.defineProperty(n,"Thumbnail",{enumerable:!0,get:function(){return f.Thumbnail}}),Object.defineProperty(n,"useElementShouldClose",{enumerable:!0,get:function(){return p.useElementShouldClose}}),Object.defineProperty(n,"normalizeKeyName",{enumerable:!0,get:function(){return h.normalizeKeyName}});var r=e("./components/buttons"),o=e("./components/Checkbox"),i=e("./components/containers"),s=e("./components/Dialog"),a=e("./components/Modal"),c=e("./components/Panel"),l=e("./components/Spinner"),u=e("./components/SvgIcon"),d=e("./components/TextInput"),f=e("./components/Thumbnail"),p=e("./hooks/use-element-should-close"),h=e("./browser-compatibility-utils")},{"./browser-compatibility-utils":6,"./components/Checkbox":7,"./components/Dialog":8,"./components/Modal":9,"./components/Panel":10,"./components/Spinner":11,"./components/SvgIcon":12,"./components/TextInput":13,"./components/Thumbnail":14,"./components/buttons":15,"./components/containers":16,"./hooks/use-element-should-close":17}],19:[function(e,t,n){(function(e){(function(){
/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){"use strict";var n={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var o=arguments[t];if(o){var i=typeof o;if("string"===i||"number"===i)e.push(o);else if(Array.isArray(o)){if(o.length){var s=r.apply(null,o);s&&e.push(s)}}else if("object"===i)if(o.toString===Object.prototype.toString)for(var a in o)n.call(o,a)&&o[a]&&e.push(a);else e.push(o.toString())}}return e.join(" ")}void 0!==t&&t.exports?(r.default=r,t.exports=r):"function"==typeof e&&"object"==typeof e.amd&&e.amd?e("classnames",[],(function(){return r})):window.classNames=r}()}).call(this)}).call(this,void 0)},{}],20:[function(e,t,n){(function(e){(function(){var r,o;r=this,o=function(){"use strict";var e=Object.hasOwnProperty,t=Object.setPrototypeOf,n=Object.isFrozen,r=Object.getPrototypeOf,o=Object.getOwnPropertyDescriptor,i=Object.freeze,s=Object.seal,a=Object.create,c="undefined"!=typeof Reflect&&Reflect,l=c.apply,u=c.construct;l||(l=function(e,t,n){return e.apply(t,n)}),i||(i=function(e){return e}),s||(s=function(e){return e}),u||(u=function(e,t){return new(Function.prototype.bind.apply(e,[null].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t))))});var d,f=w(Array.prototype.forEach),p=w(Array.prototype.pop),h=w(Array.prototype.push),m=w(String.prototype.toLowerCase),g=w(String.prototype.match),v=w(String.prototype.replace),y=w(String.prototype.indexOf),_=w(String.prototype.trim),b=w(RegExp.prototype.test),j=(d=TypeError,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return u(d,t)});function w(e){return function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return l(e,t,r)}}function x(e,r){t&&t(e,null);for(var o=r.length;o--;){var i=r[o];if("string"==typeof i){var s=m(i);s!==i&&(n(r)||(r[o]=s),i=s)}e[i]=!0}return e}function O(t){var n=a(null),r=void 0;for(r in t)l(e,t,[r])&&(n[r]=t[r]);return n}function S(e,t){for(;null!==e;){var n=o(e,t);if(n){if(n.get)return w(n.get);if("function"==typeof n.value)return w(n.value)}e=r(e)}return function(e){return console.warn("fallback value for",e),null}}var k=i(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),P=i(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),E=i(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),A=i(["animate","color-profile","cursor","discard","fedropshadow","feimage","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),N=i(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),T=i(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),C=i(["#text"]),M=i(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),D=i(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),L=i(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),I=i(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),F=s(/\{\{[\s\S]*|[\s\S]*\}\}/gm),R=s(/<%[\s\S]*|[\s\S]*%>/gm),U=s(/^data-[\-\w.\u00B7-\uFFFF]/),B=s(/^aria-[\-\w]+$/),H=s(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),$=s(/^(?:\w+script|data):/i),z=s(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function V(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var W=function(){return"undefined"==typeof window?null:window},q=function(e,t){if("object"!==(void 0===e?"undefined":G(e))||"function"!=typeof e.createPolicy)return null;var n=null,r="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(r)&&(n=t.currentScript.getAttribute(r));var o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML:function(e){return e}})}catch(i){return console.warn("TrustedTypes policy "+o+" could not be created."),null}};return function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W(),n=function(t){return e(t)};if(n.version="2.3.1",n.removed=[],!t||!t.document||9!==t.document.nodeType)return n.isSupported=!1,n;var r=t.document,o=t.document,s=t.DocumentFragment,a=t.HTMLTemplateElement,c=t.Node,l=t.Element,u=t.NodeFilter,d=t.NamedNodeMap,w=void 0===d?t.NamedNodeMap||t.MozNamedAttrMap:d,K=t.Text,Q=t.Comment,Y=t.DOMParser,J=t.trustedTypes,X=l.prototype,Z=S(X,"cloneNode"),ee=S(X,"nextSibling"),te=S(X,"childNodes"),ne=S(X,"parentNode");if("function"==typeof a){var re=o.createElement("template");re.content&&re.content.ownerDocument&&(o=re.content.ownerDocument)}var oe=q(J,r),ie=oe&&Fe?oe.createHTML(""):"",se=o,ae=se.implementation,ce=se.createNodeIterator,le=se.createDocumentFragment,ue=se.getElementsByTagName,de=r.importNode,fe={};try{fe=O(o).documentMode?o.documentMode:{}}catch(yt){}var pe={};n.isSupported="function"==typeof ne&&ae&&void 0!==ae.createHTMLDocument&&9!==fe;var he=F,me=R,ge=U,ve=B,ye=$,_e=z,be=H,je=null,we=x({},[].concat(V(k),V(P),V(E),V(N),V(C))),xe=null,Oe=x({},[].concat(V(M),V(D),V(L),V(I))),Se=null,ke=null,Pe=!0,Ee=!0,Ae=!1,Ne=!1,Te=!1,Ce=!1,Me=!1,De=!1,Le=!1,Ie=!0,Fe=!1,Re=!0,Ue=!0,Be=!1,He={},$e=null,ze=x({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Ge=null,Ve=x({},["audio","video","img","source","image","track"]),We=null,qe=x({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ke="http://www.w3.org/1998/Math/MathML",Qe="http://www.w3.org/2000/svg",Ye="http://www.w3.org/1999/xhtml",Je=Ye,Xe=!1,Ze=null,et=o.createElement("form"),tt=function(e){Ze&&Ze===e||(e&&"object"===(void 0===e?"undefined":G(e))||(e={}),e=O(e),je="ALLOWED_TAGS"in e?x({},e.ALLOWED_TAGS):we,xe="ALLOWED_ATTR"in e?x({},e.ALLOWED_ATTR):Oe,We="ADD_URI_SAFE_ATTR"in e?x(O(qe),e.ADD_URI_SAFE_ATTR):qe,Ge="ADD_DATA_URI_TAGS"in e?x(O(Ve),e.ADD_DATA_URI_TAGS):Ve,$e="FORBID_CONTENTS"in e?x({},e.FORBID_CONTENTS):ze,Se="FORBID_TAGS"in e?x({},e.FORBID_TAGS):{},ke="FORBID_ATTR"in e?x({},e.FORBID_ATTR):{},He="USE_PROFILES"in e&&e.USE_PROFILES,Pe=!1!==e.ALLOW_ARIA_ATTR,Ee=!1!==e.ALLOW_DATA_ATTR,Ae=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Ne=e.SAFE_FOR_TEMPLATES||!1,Te=e.WHOLE_DOCUMENT||!1,De=e.RETURN_DOM||!1,Le=e.RETURN_DOM_FRAGMENT||!1,Ie=!1!==e.RETURN_DOM_IMPORT,Fe=e.RETURN_TRUSTED_TYPE||!1,Me=e.FORCE_BODY||!1,Re=!1!==e.SANITIZE_DOM,Ue=!1!==e.KEEP_CONTENT,Be=e.IN_PLACE||!1,be=e.ALLOWED_URI_REGEXP||be,Je=e.NAMESPACE||Ye,Ne&&(Ee=!1),Le&&(De=!0),He&&(je=x({},[].concat(V(C))),xe=[],!0===He.html&&(x(je,k),x(xe,M)),!0===He.svg&&(x(je,P),x(xe,D),x(xe,I)),!0===He.svgFilters&&(x(je,E),x(xe,D),x(xe,I)),!0===He.mathMl&&(x(je,N),x(xe,L),x(xe,I))),e.ADD_TAGS&&(je===we&&(je=O(je)),x(je,e.ADD_TAGS)),e.ADD_ATTR&&(xe===Oe&&(xe=O(xe)),x(xe,e.ADD_ATTR)),e.ADD_URI_SAFE_ATTR&&x(We,e.ADD_URI_SAFE_ATTR),e.FORBID_CONTENTS&&($e===ze&&($e=O($e)),x($e,e.FORBID_CONTENTS)),Ue&&(je["#text"]=!0),Te&&x(je,["html","head","body"]),je.table&&(x(je,["tbody"]),delete Se.tbody),i&&i(e),Ze=e)},nt=x({},["mi","mo","mn","ms","mtext"]),rt=x({},["foreignobject","desc","title","annotation-xml"]),ot=x({},P);x(ot,E),x(ot,A);var it=x({},N);x(it,T);var st=function(e){var t=ne(e);t&&t.tagName||(t={namespaceURI:Ye,tagName:"template"});var n=m(e.tagName),r=m(t.tagName);if(e.namespaceURI===Qe)return t.namespaceURI===Ye?"svg"===n:t.namespaceURI===Ke?"svg"===n&&("annotation-xml"===r||nt[r]):Boolean(ot[n]);if(e.namespaceURI===Ke)return t.namespaceURI===Ye?"math"===n:t.namespaceURI===Qe?"math"===n&&rt[r]:Boolean(it[n]);if(e.namespaceURI===Ye){if(t.namespaceURI===Qe&&!rt[r])return!1;if(t.namespaceURI===Ke&&!nt[r])return!1;var o=x({},["title","style","font","a","script"]);return!it[n]&&(o[n]||!ot[n])}return!1},at=function(e){h(n.removed,{element:e});try{e.parentNode.removeChild(e)}catch(yt){try{e.outerHTML=ie}catch(yt){e.remove()}}},ct=function(e,t){try{h(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(yt){h(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!xe[e])if(De||Le)try{at(t)}catch(yt){}else try{t.setAttribute(e,"")}catch(yt){}},lt=function(e){var t=void 0,n=void 0;if(Me)e="<remove></remove>"+e;else{var r=g(e,/^[\r\n\t ]+/);n=r&&r[0]}var i=oe?oe.createHTML(e):e;if(Je===Ye)try{t=(new Y).parseFromString(i,"text/html")}catch(yt){}if(!t||!t.documentElement){t=ae.createDocument(Je,"template",null);try{t.documentElement.innerHTML=Xe?"":i}catch(yt){}}var s=t.body||t.documentElement;return e&&n&&s.insertBefore(o.createTextNode(n),s.childNodes[0]||null),Je===Ye?ue.call(t,Te?"html":"body")[0]:Te?t.documentElement:s},ut=function(e){return ce.call(e.ownerDocument||e,e,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT,null,!1)},dt=function(e){return!(e instanceof K||e instanceof Q||"string"==typeof e.nodeName&&"string"==typeof e.textContent&&"function"==typeof e.removeChild&&e.attributes instanceof w&&"function"==typeof e.removeAttribute&&"function"==typeof e.setAttribute&&"string"==typeof e.namespaceURI&&"function"==typeof e.insertBefore)},ft=function(e){return"object"===(void 0===c?"undefined":G(c))?e instanceof c:e&&"object"===(void 0===e?"undefined":G(e))&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},pt=function(e,t,r){pe[e]&&f(pe[e],(function(e){e.call(n,t,r,Ze)}))},ht=function(e){var t=void 0;if(pt("beforeSanitizeElements",e,null),dt(e))return at(e),!0;if(g(e.nodeName,/[\u0080-\uFFFF]/))return at(e),!0;var r=m(e.nodeName);if(pt("uponSanitizeElement",e,{tagName:r,allowedTags:je}),!ft(e.firstElementChild)&&(!ft(e.content)||!ft(e.content.firstElementChild))&&b(/<[/\w]/g,e.innerHTML)&&b(/<[/\w]/g,e.textContent))return at(e),!0;if("select"===r&&b(/<template/i,e.innerHTML))return at(e),!0;if(!je[r]||Se[r]){if(Ue&&!$e[r]){var o=ne(e)||e.parentNode,i=te(e)||e.childNodes;if(i&&o)for(var s=i.length-1;s>=0;--s)o.insertBefore(Z(i[s],!0),ee(e))}return at(e),!0}return e instanceof l&&!st(e)?(at(e),!0):"noscript"!==r&&"noembed"!==r||!b(/<\/no(script|embed)/i,e.innerHTML)?(Ne&&3===e.nodeType&&(t=e.textContent,t=v(t,he," "),t=v(t,me," "),e.textContent!==t&&(h(n.removed,{element:e.cloneNode()}),e.textContent=t)),pt("afterSanitizeElements",e,null),!1):(at(e),!0)},mt=function(e,t,n){if(Re&&("id"===t||"name"===t)&&(n in o||n in et))return!1;if(Ee&&!ke[t]&&b(ge,t));else if(Pe&&b(ve,t));else{if(!xe[t]||ke[t])return!1;if(We[t]);else if(b(be,v(n,_e,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==y(n,"data:")||!Ge[e])if(Ae&&!b(ye,v(n,_e,"")));else if(n)return!1}return!0},gt=function(e){var t=void 0,r=void 0,o=void 0,i=void 0;pt("beforeSanitizeAttributes",e,null);var s=e.attributes;if(s){var a={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:xe};for(i=s.length;i--;){var c=t=s[i],l=c.name,u=c.namespaceURI;if(r=_(t.value),o=m(l),a.attrName=o,a.attrValue=r,a.keepAttr=!0,a.forceKeepAttr=void 0,pt("uponSanitizeAttribute",e,a),r=a.attrValue,!a.forceKeepAttr&&(ct(l,e),a.keepAttr))if(b(/\/>/i,r))ct(l,e);else{Ne&&(r=v(r,he," "),r=v(r,me," "));var d=e.nodeName.toLowerCase();if(mt(d,o,r))try{u?e.setAttributeNS(u,l,r):e.setAttribute(l,r),p(n.removed)}catch(yt){}}}pt("afterSanitizeAttributes",e,null)}},vt=function e(t){var n=void 0,r=ut(t);for(pt("beforeSanitizeShadowDOM",t,null);n=r.nextNode();)pt("uponSanitizeShadowNode",n,null),ht(n)||(n.content instanceof s&&e(n.content),gt(n));pt("afterSanitizeShadowDOM",t,null)};return n.sanitize=function(e,o){var i=void 0,a=void 0,l=void 0,u=void 0,d=void 0;if((Xe=!e)&&(e="\x3c!--\x3e"),"string"!=typeof e&&!ft(e)){if("function"!=typeof e.toString)throw j("toString is not a function");if("string"!=typeof(e=e.toString()))throw j("dirty is not a string, aborting")}if(!n.isSupported){if("object"===G(t.toStaticHTML)||"function"==typeof t.toStaticHTML){if("string"==typeof e)return t.toStaticHTML(e);if(ft(e))return t.toStaticHTML(e.outerHTML)}return e}if(Ce||tt(o),n.removed=[],"string"==typeof e&&(Be=!1),Be);else if(e instanceof c)1===(a=(i=lt("\x3c!----\x3e")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===a.nodeName||"HTML"===a.nodeName?i=a:i.appendChild(a);else{if(!De&&!Ne&&!Te&&-1===e.indexOf("<"))return oe&&Fe?oe.createHTML(e):e;if(!(i=lt(e)))return De?null:ie}i&&Me&&at(i.firstChild);for(var f=ut(Be?e:i);l=f.nextNode();)3===l.nodeType&&l===u||ht(l)||(l.content instanceof s&&vt(l.content),gt(l),u=l);if(u=null,Be)return e;if(De){if(Le)for(d=le.call(i.ownerDocument);i.firstChild;)d.appendChild(i.firstChild);else d=i;return Ie&&(d=de.call(r,d,!0)),d}var p=Te?i.outerHTML:i.innerHTML;return Ne&&(p=v(p,he," "),p=v(p,me," ")),oe&&Fe?oe.createHTML(p):p},n.setConfig=function(e){tt(e),Ce=!0},n.clearConfig=function(){Ze=null,Ce=!1},n.isValidAttribute=function(e,t,n){Ze||tt({});var r=m(e),o=m(t);return mt(r,o,n)},n.addHook=function(e,t){"function"==typeof t&&(pe[e]=pe[e]||[],h(pe[e],t))},n.removeHook=function(e){pe[e]&&p(pe[e])},n.removeHooks=function(e){pe[e]&&(pe[e]=[])},n.removeAllHooks=function(){pe={}},n}()},"object"==typeof n&&void 0!==t?t.exports=o():"function"==typeof e&&e.amd?e(o):(r=r||self).DOMPurify=o()}).call(this)}).call(this,void 0)},{}],21:[function(e,t,n){
/*!
 * escape-html
 * Copyright(c) 2012-2013 TJ Holowaychuk
 * Copyright(c) 2015 Andreas Lubbe
 * Copyright(c) 2015 Tiancheng "Timothy" Gu
 * MIT Licensed
 */
"use strict";var r=/["'&<>]/;t.exports=function(e){var t,n=""+e,o=r.exec(n);if(!o)return n;var i="",s=0,a=0;for(s=o.index;s<n.length;s++){switch(n.charCodeAt(s)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#39;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}a!==s&&(i+=n.substring(a,s)),a=s+1,i+=t}return a!==s?i+n.substring(a,s):i}},{}],22:[function(e,t,n){"use strict";t.exports=e=>{if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}},{}],23:[function(e,t,n){(function(e){(function(){var r;r=function(){"use strict";function e(e){var t=!0,n=!1,r=null,o={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function i(e){return!!(e&&e!==document&&"HTML"!==e.nodeName&&"BODY"!==e.nodeName&&"classList"in e&&"contains"in e.classList)}function s(e){e.classList.contains("focus-visible")||(e.classList.add("focus-visible"),e.setAttribute("data-focus-visible-added",""))}function a(e){t=!1}function c(){document.addEventListener("mousemove",l),document.addEventListener("mousedown",l),document.addEventListener("mouseup",l),document.addEventListener("pointermove",l),document.addEventListener("pointerdown",l),document.addEventListener("pointerup",l),document.addEventListener("touchmove",l),document.addEventListener("touchstart",l),document.addEventListener("touchend",l)}function l(e){e.target.nodeName&&"html"===e.target.nodeName.toLowerCase()||(t=!1,document.removeEventListener("mousemove",l),document.removeEventListener("mousedown",l),document.removeEventListener("mouseup",l),document.removeEventListener("pointermove",l),document.removeEventListener("pointerdown",l),document.removeEventListener("pointerup",l),document.removeEventListener("touchmove",l),document.removeEventListener("touchstart",l),document.removeEventListener("touchend",l))}document.addEventListener("keydown",(function(n){n.metaKey||n.altKey||n.ctrlKey||(i(e.activeElement)&&s(e.activeElement),t=!0)}),!0),document.addEventListener("mousedown",a,!0),document.addEventListener("pointerdown",a,!0),document.addEventListener("touchstart",a,!0),document.addEventListener("visibilitychange",(function(e){"hidden"===document.visibilityState&&(n&&(t=!0),c())}),!0),c(),e.addEventListener("focus",(function(e){var n,r,a;i(e.target)&&(t||(r=(n=e.target).type,"INPUT"===(a=n.tagName)&&o[r]&&!n.readOnly||"TEXTAREA"===a&&!n.readOnly||n.isContentEditable))&&s(e.target)}),!0),e.addEventListener("blur",(function(e){var t;i(e.target)&&(e.target.classList.contains("focus-visible")||e.target.hasAttribute("data-focus-visible-added"))&&(n=!0,window.clearTimeout(r),r=window.setTimeout((function(){n=!1}),100),(t=e.target).hasAttribute("data-focus-visible-added")&&(t.classList.remove("focus-visible"),t.removeAttribute("data-focus-visible-added")))}),!0),e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&e.host?e.host.setAttribute("data-js-focus-visible",""):e.nodeType===Node.DOCUMENT_NODE&&(document.documentElement.classList.add("js-focus-visible"),document.documentElement.setAttribute("data-js-focus-visible",""))}if("undefined"!=typeof window&&"undefined"!=typeof document){var t;window.applyFocusVisiblePolyfill=e;try{t=new CustomEvent("focus-visible-polyfill-ready")}catch(n){(t=document.createEvent("CustomEvent")).initCustomEvent("focus-visible-polyfill-ready",!1,!1,{})}window.dispatchEvent(t)}"undefined"!=typeof document&&e(document)},"object"==typeof n&&void 0!==t?r():"function"==typeof e&&e.amd?e(r):r()}).call(this)}).call(this,void 0)},{}],24:[function(e,t,n){(function(e){(function(){var n=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,i=/^0o[0-7]+$/i,s=parseInt,a="object"==typeof e&&e&&e.Object===Object&&e,c="object"==typeof self&&self&&self.Object===Object&&self,l=a||c||Function("return this")(),u=Object.prototype.toString,d=Math.max,f=Math.min,p=function(){return l.Date.now()};function h(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function m(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==u.call(e)}(e))return NaN;if(h(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=h(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(n,"");var a=o.test(e);return a||i.test(e)?s(e.slice(2),a?2:8):r.test(e)?NaN:+e}t.exports=function(e,t,n){var r,o,i,s,a,c,l=0,u=!1,g=!1,v=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var n=r,i=o;return r=o=void 0,l=t,s=e.apply(i,n)}function _(e){return l=e,a=setTimeout(j,t),u?y(e):s}function b(e){var n=e-c;return void 0===c||n>=t||n<0||g&&e-l>=i}function j(){var e=p();if(b(e))return w(e);a=setTimeout(j,function(e){var n=t-(e-c);return g?f(n,i-(e-l)):n}(e))}function w(e){return a=void 0,v&&r?y(e):(r=o=void 0,s)}function x(){var e=p(),n=b(e);if(r=arguments,o=this,c=e,n){if(void 0===a)return _(c);if(g)return a=setTimeout(j,t),y(c)}return void 0===a&&(a=setTimeout(j,t)),s}return t=m(t)||0,h(n)&&(u=!!n.leading,i=(g="maxWait"in n)?d(m(n.maxWait)||0,t):i,v="trailing"in n?!!n.trailing:v),x.cancel=function(){void 0!==a&&clearTimeout(a),l=0,r=c=o=a=void 0},x.flush=function(){return void 0===a?s:w(p())},x}}).call(this)}).call(this,window)},{}],25:[function(e,t,n){t.exports=e("preact/jsx-runtime")},{"preact/jsx-runtime":28}],26:[function(e,t,n){var r,o,i,s,a,c,l={},u=[],d=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function f(e,t){for(var n in t)e[n]=t[n];return e}function p(e){var t=e.parentNode;t&&t.removeChild(e)}function h(e,t,n){var r,o,i,s=arguments,a={};for(i in t)"key"==i?r=t[i]:"ref"==i?o=t[i]:a[i]=t[i];if(arguments.length>3)for(n=[n],i=3;i<arguments.length;i++)n.push(s[i]);if(null!=n&&(a.children=n),"function"==typeof e&&null!=e.defaultProps)for(i in e.defaultProps)void 0===a[i]&&(a[i]=e.defaultProps[i]);return m(e,a,r,o,null)}function m(e,t,n,o,i){var s={type:e,props:t,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==i?++r.__v:i};return null!=r.vnode&&r.vnode(s),s}function g(e){return e.children}function v(e,t){this.props=e,this.context=t}function y(e,t){if(null==t)return e.__?y(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?y(e):null}function _(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return _(e)}}function b(e){(!e.__d&&(e.__d=!0)&&i.push(e)&&!j.__r++||a!==r.debounceRendering)&&((a=r.debounceRendering)||s)(j)}function j(){for(var e;j.__r=i.length;)e=i.sort((function(e,t){return e.__v.__b-t.__v.__b})),i=[],e.some((function(e){var t,n,r,o,i,s;e.__d&&(i=(o=(t=e).__v).__e,(s=t.__P)&&(n=[],(r=f({},o)).__v=o.__v+1,A(s,o,r,t.__n,void 0!==s.ownerSVGElement,null!=o.__h?[i]:null,n,null==i?y(o):i,o.__h),N(n,o),o.__e!=i&&_(o)))}))}function w(e,t,n,r,o,i,s,a,c,d){var f,p,h,v,_,b,j,w=r&&r.__k||u,S=w.length;for(n.__k=[],f=0;f<t.length;f++)if(null!=(v=n.__k[f]=null==(v=t[f])||"boolean"==typeof v?null:"string"==typeof v||"number"==typeof v||"bigint"==typeof v?m(null,v,null,null,v):Array.isArray(v)?m(g,{children:v},null,null,null):v.__b>0?m(v.type,v.props,v.key,null,v.__v):v)){if(v.__=n,v.__b=n.__b+1,null===(h=w[f])||h&&v.key==h.key&&v.type===h.type)w[f]=void 0;else for(p=0;p<S;p++){if((h=w[p])&&v.key==h.key&&v.type===h.type){w[p]=void 0;break}h=null}A(e,v,h=h||l,o,i,s,a,c,d),_=v.__e,(p=v.ref)&&h.ref!=p&&(j||(j=[]),h.ref&&j.push(h.ref,null,v),j.push(p,v.__c||_,v)),null!=_?(null==b&&(b=_),"function"==typeof v.type&&null!=v.__k&&v.__k===h.__k?v.__d=c=x(v,c,e):c=O(e,v,h,w,_,c),d||"option"!==n.type?"function"==typeof n.type&&(n.__d=c):e.value=""):c&&h.__e==c&&c.parentNode!=e&&(c=y(h))}for(n.__e=b,f=S;f--;)null!=w[f]&&("function"==typeof n.type&&null!=w[f].__e&&w[f].__e==n.__d&&(n.__d=y(r,f+1)),M(w[f],w[f]));if(j)for(f=0;f<j.length;f++)C(j[f],j[++f],j[++f])}function x(e,t,n){var r,o;for(r=0;r<e.__k.length;r++)(o=e.__k[r])&&(o.__=e,t="function"==typeof o.type?x(o,t,n):O(n,o,o,e.__k,o.__e,t));return t}function O(e,t,n,r,o,i){var s,a,c;if(void 0!==t.__d)s=t.__d,t.__d=void 0;else if(null==n||o!=i||null==o.parentNode)e:if(null==i||i.parentNode!==e)e.appendChild(o),s=null;else{for(a=i,c=0;(a=a.nextSibling)&&c<r.length;c+=2)if(a==o)break e;e.insertBefore(o,i),s=i}return void 0!==s?s:o.nextSibling}function S(e,t,n){"-"===t[0]?e.setProperty(t,n):e[t]=null==n?"":"number"!=typeof n||d.test(t)?n:n+"px"}function k(e,t,n,r,o){var i;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||S(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||S(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])i=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+i]=n,n?r||e.addEventListener(t,i?E:P,i):e.removeEventListener(t,i?E:P,i);else if("dangerouslySetInnerHTML"!==t){if(o)t=t.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if("href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null!=n&&(!1!==n||"a"===t[0]&&"r"===t[1])?e.setAttribute(t,n):e.removeAttribute(t))}}function P(e){this.l[e.type+!1](r.event?r.event(e):e)}function E(e){this.l[e.type+!0](r.event?r.event(e):e)}function A(e,t,n,o,i,s,a,c,l){var u,d,p,h,m,y,_,b,j,x,O,S=t.type;if(void 0!==t.constructor)return null;null!=n.__h&&(l=n.__h,c=t.__e=n.__e,t.__h=null,s=[c]),(u=r.__b)&&u(t);try{e:if("function"==typeof S){if(b=t.props,j=(u=S.contextType)&&o[u.__c],x=u?j?j.props.value:u.__:o,n.__c?_=(d=t.__c=n.__c).__=d.__E:("prototype"in S&&S.prototype.render?t.__c=d=new S(b,x):(t.__c=d=new v(b,x),d.constructor=S,d.render=D),j&&j.sub(d),d.props=b,d.state||(d.state={}),d.context=x,d.__n=o,p=d.__d=!0,d.__h=[]),null==d.__s&&(d.__s=d.state),null!=S.getDerivedStateFromProps&&(d.__s==d.state&&(d.__s=f({},d.__s)),f(d.__s,S.getDerivedStateFromProps(b,d.__s))),h=d.props,m=d.state,p)null==S.getDerivedStateFromProps&&null!=d.componentWillMount&&d.componentWillMount(),null!=d.componentDidMount&&d.__h.push(d.componentDidMount);else{if(null==S.getDerivedStateFromProps&&b!==h&&null!=d.componentWillReceiveProps&&d.componentWillReceiveProps(b,x),!d.__e&&null!=d.shouldComponentUpdate&&!1===d.shouldComponentUpdate(b,d.__s,x)||t.__v===n.__v){d.props=b,d.state=d.__s,t.__v!==n.__v&&(d.__d=!1),d.__v=t,t.__e=n.__e,t.__k=n.__k,t.__k.forEach((function(e){e&&(e.__=t)})),d.__h.length&&a.push(d);break e}null!=d.componentWillUpdate&&d.componentWillUpdate(b,d.__s,x),null!=d.componentDidUpdate&&d.__h.push((function(){d.componentDidUpdate(h,m,y)}))}d.context=x,d.props=b,d.state=d.__s,(u=r.__r)&&u(t),d.__d=!1,d.__v=t,d.__P=e,u=d.render(d.props,d.state,d.context),d.state=d.__s,null!=d.getChildContext&&(o=f(f({},o),d.getChildContext())),p||null==d.getSnapshotBeforeUpdate||(y=d.getSnapshotBeforeUpdate(h,m)),O=null!=u&&u.type===g&&null==u.key?u.props.children:u,w(e,Array.isArray(O)?O:[O],t,n,o,i,s,a,c,l),d.base=t.__e,t.__h=null,d.__h.length&&a.push(d),_&&(d.__E=d.__=null),d.__e=!1}else null==s&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=T(n.__e,t,n,o,i,s,a,l);(u=r.diffed)&&u(t)}catch(e){t.__v=null,(l||null!=s)&&(t.__e=c,t.__h=!!l,s[s.indexOf(c)]=null),r.__e(e,t,n)}}function N(e,t){r.__c&&r.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){r.__e(e,t.__v)}}))}function T(e,t,n,r,o,i,s,a){var c,d,f,h,m=n.props,g=t.props,v=t.type,y=0;if("svg"===v&&(o=!0),null!=i)for(;y<i.length;y++)if((c=i[y])&&(c===e||(v?c.localName==v:3==c.nodeType))){e=c,i[y]=null;break}if(null==e){if(null===v)return document.createTextNode(g);e=o?document.createElementNS("http://www.w3.org/2000/svg",v):document.createElement(v,g.is&&g),i=null,a=!1}if(null===v)m===g||a&&e.data===g||(e.data=g);else{if(i=i&&u.slice.call(e.childNodes),d=(m=n.props||l).dangerouslySetInnerHTML,f=g.dangerouslySetInnerHTML,!a){if(null!=i)for(m={},h=0;h<e.attributes.length;h++)m[e.attributes[h].name]=e.attributes[h].value;(f||d)&&(f&&(d&&f.__html==d.__html||f.__html===e.innerHTML)||(e.innerHTML=f&&f.__html||""))}if(function(e,t,n,r,o){var i;for(i in n)"children"===i||"key"===i||i in t||k(e,i,null,n[i],r);for(i in t)o&&"function"!=typeof t[i]||"children"===i||"key"===i||"value"===i||"checked"===i||n[i]===t[i]||k(e,i,t[i],n[i],r)}(e,g,m,o,a),f)t.__k=[];else if(y=t.props.children,w(e,Array.isArray(y)?y:[y],t,n,r,o&&"foreignObject"!==v,i,s,e.firstChild,a),null!=i)for(y=i.length;y--;)null!=i[y]&&p(i[y]);a||("value"in g&&void 0!==(y=g.value)&&(y!==e.value||"progress"===v&&!y)&&k(e,"value",y,m.value,!1),"checked"in g&&void 0!==(y=g.checked)&&y!==e.checked&&k(e,"checked",y,m.checked,!1))}return e}function C(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){r.__e(e,n)}}function M(e,t,n){var o,i,s;if(r.unmount&&r.unmount(e),(o=e.ref)&&(o.current&&o.current!==e.__e||C(o,null,t)),n||"function"==typeof e.type||(n=null!=(i=e.__e)),e.__e=e.__d=void 0,null!=(o=e.__c)){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(e){r.__e(e,t)}o.base=o.__P=null}if(o=e.__k)for(s=0;s<o.length;s++)o[s]&&M(o[s],t,n);null!=i&&p(i)}function D(e,t,n){return this.constructor(e,n)}function L(e,t,n){var o,i,s;r.__&&r.__(e,t),i=(o="function"==typeof n)?null:n&&n.__k||t.__k,s=[],A(t,e=(!o&&n||t).__k=h(g,null,[e]),i||l,l,void 0!==t.ownerSVGElement,!o&&n?[n]:i?null:t.firstChild?u.slice.call(t.childNodes):null,s,!o&&n?n:i?i.__e:t.firstChild,o),N(s,e)}r={__e:function(e,t){for(var n,r,o;t=t.__;)if((n=t.__c)&&!n.__)try{if((r=n.constructor)&&null!=r.getDerivedStateFromError&&(n.setState(r.getDerivedStateFromError(e)),o=n.__d),null!=n.componentDidCatch&&(n.componentDidCatch(e),o=n.__d),o)return n.__E=n}catch(t){e=t}throw e},__v:0},o=function(e){return null!=e&&void 0===e.constructor},v.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=f({},this.state),"function"==typeof e&&(e=e(f({},n),this.props)),e&&f(n,e),null!=e&&this.__v&&(t&&this.__h.push(t),b(this))},v.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),b(this))},v.prototype.render=g,i=[],s="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,j.__r=0,c=0,n.render=L,n.hydrate=function e(t,n){L(t,n,e)},n.createElement=h,n.h=h,n.Fragment=g,n.createRef=function(){return{current:null}},n.isValidElement=o,n.Component=v,n.cloneElement=function(e,t,n){var r,o,i,s=arguments,a=f({},e.props);for(i in t)"key"==i?r=t[i]:"ref"==i?o=t[i]:a[i]=t[i];if(arguments.length>3)for(n=[n],i=3;i<arguments.length;i++)n.push(s[i]);return null!=n&&(a.children=n),m(e.type,a,r||e.key,o||e.ref,null)},n.createContext=function(e,t){var n={__c:t="__cC"+c++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e){var n,r;return this.getChildContext||(n=[],(r={})[t]=this,this.getChildContext=function(){return r},this.shouldComponentUpdate=function(e){this.props.value!==e.value&&n.some(b)},this.sub=function(e){n.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){n.splice(n.indexOf(e),1),t&&t.call(e)}}),e.children}};return n.Provider.__=n.Consumer.contextType=n},n.toChildArray=function e(t,n){return n=n||[],null==t||"boolean"==typeof t||(Array.isArray(t)?t.some((function(t){e(t,n)})):n.push(t)),n},n.options=r},{}],27:[function(e,t,n){var r,o,i,s=e("preact"),a=0,c=[],l=s.options.__b,u=s.options.__r,d=s.options.diffed,f=s.options.__c,p=s.options.unmount;function h(e,t){s.options.__h&&s.options.__h(o,e,a||t),a=0;var n=o.__H||(o.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function m(e){return a=1,g(O,e)}function g(e,t,n){var i=h(r++,2);return i.t=e,i.__c||(i.__=[n?n(t):O(void 0,t),function(e){var t=i.t(i.__[0],e);i.__[0]!==t&&(i.__=[t,i.__[1]],i.__c.setState({}))}],i.__c=o),i.__}function v(e,t){var n=h(r++,4);!s.options.__s&&x(n.__H,t)&&(n.__=e,n.__H=t,o.__h.push(n))}function y(e,t){var n=h(r++,7);return x(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function _(){c.forEach((function(e){if(e.__P)try{e.__H.__h.forEach(j),e.__H.__h.forEach(w),e.__H.__h=[]}catch(o){e.__H.__h=[],s.options.__e(o,e.__v)}})),c=[]}s.options.__b=function(e){o=null,l&&l(e)},s.options.__r=function(e){u&&u(e),r=0;var t=(o=e.__c).__H;t&&(t.__h.forEach(j),t.__h.forEach(w),t.__h=[])},s.options.diffed=function(e){d&&d(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(1!==c.push(t)&&i===s.options.requestAnimationFrame||((i=s.options.requestAnimationFrame)||function(e){var t,n=function(){clearTimeout(r),b&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);b&&(t=requestAnimationFrame(n))})(_)),o=void 0},s.options.__c=function(e,t){t.some((function(e){try{e.__h.forEach(j),e.__h=e.__h.filter((function(e){return!e.__||w(e)}))}catch(i){t.some((function(e){e.__h&&(e.__h=[])})),t=[],s.options.__e(i,e.__v)}})),f&&f(e,t)},s.options.unmount=function(e){p&&p(e);var t=e.__c;if(t&&t.__H)try{t.__H.__.forEach(j)}catch(e){s.options.__e(e,t.__v)}};var b="function"==typeof requestAnimationFrame;function j(e){var t=o;"function"==typeof e.__c&&e.__c(),o=t}function w(e){var t=o;e.__c=e.__(),o=t}function x(e,t){return!e||e.length!==t.length||t.some((function(t,n){return t!==e[n]}))}function O(e,t){return"function"==typeof t?t(e):t}n.useState=m,n.useReducer=g,n.useEffect=function(e,t){var n=h(r++,3);!s.options.__s&&x(n.__H,t)&&(n.__=e,n.__H=t,o.__H.__h.push(n))},n.useLayoutEffect=v,n.useRef=function(e){return a=5,y((function(){return{current:e}}),[])},n.useImperativeHandle=function(e,t,n){a=6,v((function(){"function"==typeof e?e(t()):e&&(e.current=t())}),null==n?n:n.concat(e))},n.useMemo=y,n.useCallback=function(e,t){return a=8,y((function(){return e}),t)},n.useContext=function(e){var t=o.context[e.__c],n=h(r++,9);return n.__c=e,t?(null==n.__&&(n.__=!0,t.sub(o)),t.props.value):e.__},n.useDebugValue=function(e,t){s.options.useDebugValue&&s.options.useDebugValue(t?t(e):e)},n.useErrorBoundary=function(e){var t=h(r++,10),n=m();return t.__=e,o.componentDidCatch||(o.componentDidCatch=function(e){t.__&&t.__(e),n[1](e)}),[n[0],function(){n[1](void 0)}]}},{preact:26}],28:[function(e,t,n){var r=e("preact");function o(e,t,n,o,i){var s={};for(var a in t)"ref"!=a&&(s[a]=t[a]);var c,l,u={type:e,props:s,key:n,ref:t&&t.ref,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:++r.options.__v,__source:o,__self:i};if("function"==typeof e&&(c=e.defaultProps))for(l in c)void 0===s[l]&&(s[l]=c[l]);return r.options.vnode&&r.options.vnode(u),u}n.Fragment=r.Fragment,n.jsx=o,n.jsxs=o,n.jsxDEV=o},{preact:26}],29:[function(e,t,n){"use strict";function r(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(o){return"function"==typeof o?o(n,r,e):t(o)}}}}n.__esModule=!0;var o=r();o.withExtraArgument=r,n.default=o},{}],30:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("@babel/runtime/helpers/objectSpread2");var o,i=(o=r)&&"object"==typeof o&&"default"in o?o:{default:o};function s(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var a="function"==typeof Symbol&&Symbol.observable||"@@observable",c=function(){return Math.random().toString(36).substring(7).split("").join(".")},l={INIT:"@@redux/INIT"+c(),REPLACE:"@@redux/REPLACE"+c(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+c()}};function u(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function d(e,t){return function(){return t(e.apply(this,arguments))}}function f(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}n.__DO_NOT_USE__ActionTypes=l,n.applyMiddleware=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error(s(15))},o={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},a=t.map((function(e){return e(o)}));return r=f.apply(void 0,a)(n.dispatch),i.default(i.default({},n),{},{dispatch:r})}}},n.bindActionCreators=function(e,t){if("function"==typeof e)return d(e,t);if("object"!=typeof e||null===e)throw new Error(s(16));var n={};for(var r in e){var o=e[r];"function"==typeof o&&(n[r]=d(o,t))}return n},n.combineReducers=function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var o=t[r];"function"==typeof e[o]&&(n[o]=e[o])}var i,a=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if(void 0===n(void 0,{type:l.INIT}))throw new Error(s(12));if(void 0===n(void 0,{type:l.PROBE_UNKNOWN_ACTION()}))throw new Error(s(13))}))}(n)}catch(c){i=c}return function(e,t){if(void 0===e&&(e={}),i)throw i;for(var r=!1,o={},c=0;c<a.length;c++){var l=a[c],u=n[l],d=e[l],f=u(d,t);if(void 0===f)throw t&&t.type,new Error(s(14));o[l]=f,r=r||f!==d}return(r=r||a.length!==Object.keys(e).length)?o:e}},n.compose=f,n.createStore=function e(t,n,r){var o;if("function"==typeof n&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error(s(0));if("function"==typeof n&&void 0===r&&(r=n,n=void 0),void 0!==r){if("function"!=typeof r)throw new Error(s(1));return r(e)(t,n)}if("function"!=typeof t)throw new Error(s(2));var i=t,c=n,d=[],f=d,p=!1;function h(){f===d&&(f=d.slice())}function m(){if(p)throw new Error(s(3));return c}function g(e){if("function"!=typeof e)throw new Error(s(4));if(p)throw new Error(s(5));var t=!0;return h(),f.push(e),function(){if(t){if(p)throw new Error(s(6));t=!1,h();var n=f.indexOf(e);f.splice(n,1),d=null}}}function v(e){if(!u(e))throw new Error(s(7));if(void 0===e.type)throw new Error(s(8));if(p)throw new Error(s(9));try{p=!0,c=i(c,e)}finally{p=!1}for(var t=d=f,n=0;n<t.length;n++)(0,t[n])();return e}function y(e){if("function"!=typeof e)throw new Error(s(10));i=e,v({type:l.REPLACE})}function _(){var e,t=g;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(s(11));function n(){e.next&&e.next(m())}return n(),{unsubscribe:t(n)}}})[a]=function(){return this},e}return v({type:l.INIT}),(o={dispatch:v,subscribe:g,getState:m,replaceReducer:y})[a]=_,o}},{"@babel/runtime/helpers/objectSpread2":2}],31:[function(e,t,n){"use strict";function r(e,t){return e===t}function o(e,t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var r=t.length,o=0;o<r;o++)if(!e(t[o],n[o]))return!1;return!0}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,n=null,i=null;return function(){return o(t,n,arguments)||(i=e.apply(null,arguments)),n=arguments,i}}function s(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"==typeof e}))){var n=t.map((function(e){return typeof e})).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+n+"]")}return t}function a(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];var i=0,a=r.pop(),c=s(r),l=e.apply(void 0,[function(){return i++,a.apply(null,arguments)}].concat(n)),u=e((function(){for(var e=[],t=c.length,n=0;n<t;n++)e.push(c[n].apply(null,arguments));return l.apply(null,e)}));return u.resultFunc=a,u.dependencies=c,u.recomputations=function(){return i},u.resetRecomputations=function(){return i=0},u}}n.__esModule=!0,n.defaultMemoize=i,n.createSelectorCreator=a,n.createStructuredSelector=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c;if("object"!=typeof e)throw new Error("createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);var n=Object.keys(e);return t(n.map((function(t){return e[t]})),(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce((function(e,t,r){return e[n[r]]=t,e}),{})}))};var c=n.createSelector=a(i)},{}],32:[function(e,t,n){t.exports=e("./lib/retry")},{"./lib/retry":33}],33:[function(e,t,n){var r=e("./retry_operation");n.operation=function(e){var t=n.timeouts(e);return new r(t,{forever:e&&(e.forever||e.retries===1/0),unref:e&&e.unref,maxRetryTime:e&&e.maxRetryTime})},n.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var n in e)t[n]=e[n];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var r=[],o=0;o<t.retries;o++)r.push(this.createTimeout(o,t));return e&&e.forever&&!r.length&&r.push(this.createTimeout(o,t)),r.sort((function(e,t){return e-t})),r},n.createTimeout=function(e,t){var n=t.randomize?Math.random()+1:1,r=Math.round(n*Math.max(t.minTimeout,1)*Math.pow(t.factor,e));return Math.min(r,t.maxTimeout)},n.wrap=function(e,t,r){if(t instanceof Array&&(r=t,t=null),!r)for(var o in r=[],e)"function"==typeof e[o]&&r.push(o);for(var i=0;i<r.length;i++){var s=r[i],a=e[s];e[s]=function(r){var o=n.operation(t),i=Array.prototype.slice.call(arguments,1),s=i.pop();i.push((function(e){o.retry(e)||(e&&(arguments[0]=o.mainError()),s.apply(this,arguments))})),o.attempt((function(){r.apply(e,i)}))}.bind(e,a),e[s].options=t}}},{"./retry_operation":34}],34:[function(e,t,n){function r(e,t){"boolean"==typeof t&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}t.exports=r,r.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},r.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},r.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=(new Date).getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var n=this._timeouts.shift();if(void 0===n){if(!this._cachedTimeouts)return!1;this._errors.splice(0,this._errors.length-1),n=this._cachedTimeouts.slice(-1)}var r=this;return this._timer=setTimeout((function(){r._attempts++,r._operationTimeoutCb&&(r._timeout=setTimeout((function(){r._operationTimeoutCb(r._attempts)}),r._operationTimeout),r._options.unref&&r._timeout.unref()),r._fn(r._attempts)}),n),this._options.unref&&this._timer.unref(),!0},r.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout((function(){n._operationTimeoutCb()}),n._operationTimeout)),this._operationStart=(new Date).getTime(),this._fn(this._attempts)},r.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},r.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},r.prototype.start=r.prototype.try,r.prototype.errors=function(){return this._errors},r.prototype.attempts=function(){return this._attempts},r.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,n=0,r=0;r<this._errors.length;r++){var o=this._errors[r],i=o.message,s=(e[i]||0)+1;e[i]=s,s>=n&&(t=o,n=s)}return t}},{}],35:[function(e,t,n){var r="complete",o="canceled";function i(e,t,n){Math.max(0,t),Math.max(0,n),e.self===e?e.scrollTo(t,n):(e.scrollLeft=t,e.scrollTop=n)}function s(e){var t=e._scrollSettings;if(t){var n=t.maxSynchronousAlignments,o=function(e,t){var n,r,o,i,s,a,c,l=e.align,u=e.target.getBoundingClientRect(),d=l&&null!=l.left?l.left:.5,f=l&&null!=l.top?l.top:.5,p=l&&null!=l.leftOffset?l.leftOffset:0,h=l&&null!=l.topOffset?l.topOffset:0,m=d,g=f;if(e.isWindow(t))a=Math.min(u.width,t.innerWidth),c=Math.min(u.height,t.innerHeight),r=u.left+t.pageXOffset-t.innerWidth*m+a*m,o=u.top+t.pageYOffset-t.innerHeight*g+c*g,r-=p,o-=h,r=e.align.lockX?t.pageXOffset:r,o=e.align.lockY?t.pageYOffset:o,i=r-t.pageXOffset,s=o-t.pageYOffset;else{a=u.width,c=u.height,n=t.getBoundingClientRect();var v=u.left-(n.left-t.scrollLeft),y=u.top-(n.top-t.scrollTop);r=v+a*m-t.clientWidth*m,o=y+c*g-t.clientHeight*g,r-=p,o-=h,r=Math.max(Math.min(r,t.scrollWidth-t.clientWidth),0),o=Math.max(Math.min(o,t.scrollHeight-t.clientHeight),0),r=e.align.lockX?t.scrollLeft:r,o=e.align.lockY?t.scrollTop:o,i=r-t.scrollLeft,s=o-t.scrollTop}return{x:r,y:o,differenceX:i,differenceY:s}}(t,e),a=Date.now()-t.startTime,c=Math.min(1/t.time*a,1);if(t.endIterations>=n)return i(e,o.x,o.y),e._scrollSettings=null,t.end(r);var l=1-t.ease(c);if(i(e,o.x-o.differenceX*l,o.y-o.differenceY*l),a>=t.time)return t.endIterations++,t.scrollAncestor&&s(t.scrollAncestor),void s(e);!function(e){if("requestAnimationFrame"in window)return window.requestAnimationFrame(e);setTimeout(e,16)}(s.bind(null,e))}}function a(e){return e.self===e}function c(e){return"pageXOffset"in e||(e.scrollHeight!==e.clientHeight||e.scrollWidth!==e.clientWidth)&&"hidden"!==getComputedStyle(e).overflow}function l(){return!0}function u(e){if(e.assignedSlot)return u(e.assignedSlot);if(e.parentElement)return"BODY"===e.parentElement.tagName?e.parentElement.ownerDocument.defaultView||e.parentElement.ownerDocument.ownerWindow:e.parentElement;if(e.getRootNode){var t=e.getRootNode();if(11===t.nodeType)return t.host}}t.exports=function(e,t,n){if(e){"function"==typeof t&&(n=t,t=null),t||(t={}),t.time=isNaN(t.time)?1e3:t.time,t.ease=t.ease||function(e){return 1-Math.pow(1-e,e/2)},t.align=t.align||{};var i=u(e),d=1,f=t.validTarget||l,p=t.isScrollable;t.debug&&(console.log("About to scroll to",e),i||console.error("Target did not have a parent, is it mounted in the DOM?"));for(var h=[];i;)if(t.debug&&console.log("Scrolling parent node",i),f(i,d)&&(p?p(i,c):c(i))&&(d++,h.push(i)),!(i=u(i))){m(r);break}return h.reduce(((n,r,i)=>function(e,t,n,r,i){var c,l=!t._scrollSettings,u=t._scrollSettings,d=Date.now(),f={passive:!0};function p(e){t._scrollSettings=null,t.parentElement&&t.parentElement._scrollSettings&&t.parentElement._scrollSettings.end(e),n.debug&&console.log("Scrolling ended with type",e,"for",t),i(e),c&&(t.removeEventListener("touchstart",c,f),t.removeEventListener("wheel",c,f))}u&&u.end(o);var h=n.maxSynchronousAlignments;return null==h&&(h=3),t._scrollSettings={startTime:d,endIterations:0,target:e,time:n.time,ease:n.ease,align:n.align,isWindow:n.isWindow||a,maxSynchronousAlignments:h,end:p,scrollAncestor:r},"cancellable"in n&&!n.cancellable||(c=p.bind(null,o),t.addEventListener("touchstart",c,f),t.addEventListener("wheel",c,f)),l&&s(t),c}(e,r,t,h[i+1],m)),null)}function m(e){--d||n&&n(e)}}},{}],36:[function(e,t,n){t.exports=function(e,t,n,r){var o=n?n.call(r,e,t):void 0;if(void 0!==o)return!!o;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var i=Object.keys(e),s=Object.keys(t);if(i.length!==s.length)return!1;for(var a=Object.prototype.hasOwnProperty.bind(t),c=0;c<i.length;c++){var l=i[c];if(!a(l))return!1;var u=e[l],d=t[l];if(!1===(o=n?n.call(r,u,d,l):void 0)||void 0===o&&u!==d)return!1}return!0}},{}],37:[function(e,t,n){function r(){}r.prototype={on:function(e,t,n){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var r=this;function o(){r.off(e,o),t.apply(n,arguments)}return o._=t,this.on(e,o,n)},emit:function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),r=0,o=n.length;r<o;r++)n[r].fn.apply(n[r].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),r=n[e],o=[];if(r&&t)for(var i=0,s=r.length;i<s;i++)r[i].fn!==t&&r[i].fn._!==t&&o.push(r[i]);return o.length?n[e]=o:delete n[e],this}},t.exports=r,t.exports.TinyEmitter=r},{}],38:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ListenerCollection=void 0;n.ListenerCollection=class{constructor(){this._listeners=[]}add(e,t,n,r){e.addEventListener(t,n,r),this._listeners.push({eventTarget:e,eventType:t,listener:n})}removeAll(){this._listeners.forEach((({eventTarget:e,eventType:t,listener:n})=>{e.removeEventListener(t,n)})),this._listeners=[]}}},{}],39:[function(e,t,n){"use strict";function r(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}Object.defineProperty(n,"__esModule",{value:!0}),n.parseJsonConfig=function(e){for(var t={},n=e.querySelectorAll("script.js-hypothesis-config"),o=0;o<n.length;o++){var i=void 0;try{i=JSON.parse(n[o].textContent||"")}catch(s){console.warn("Could not parse settings from js-hypothesis-config tags",s),i={}}r(t,i)}return t}},{}],40:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--plus"><g fill-rule="evenodd"><path fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 8V3v5H3h5zm0 0v5-5h5-5z"></path><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect></g></svg>'},{}],41:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path fill="currentColor" fill-rule="nonzero" d="M15 0c.27 0 .505.099.703.297A.961.961 0 0116 1v15l-4-3H1a.974.974 0 01-.703-.29A.953.953 0 010 12V1C0 .719.096.482.29.29A.966.966 0 011 0h14zM7 3l-.469.063c-.312.041-.656.187-1.031.437-.375.25-.719.646-1.031 1.188C4.156 5.229 4 6 4 7l.002.063.006.062a.896.896 0 01.008.11l-.002.074-.006.066a1.447 1.447 0 00.43 1.188C4.729 8.854 5.082 9 5.5 9c.417 0 .77-.146 1.063-.438C6.854 8.271 7 7.918 7 7.5c0-.417-.146-.77-.438-1.063A1.447 1.447 0 005.5 6c-.073 0-.146.005-.219.016-.073.01-.14.026-.203.046.177-1.03.542-1.632 1.094-1.804L7 4V3zm5 0l-.469.063c-.312.041-.656.187-1.031.437-.375.25-.719.646-1.031 1.188C9.156 5.229 9 6 9 7l.002.063.006.062a.896.896 0 01.008.11l-.002.074-.006.066a1.447 1.447 0 00.43 1.188c.291.291.645.437 1.062.437.417 0 .77-.146 1.063-.438.291-.291.437-.645.437-1.062 0-.417-.146-.77-.438-1.063A1.447 1.447 0 0010.5 6c-.073 0-.146.005-.219.016-.073.01-.14.026-.203.046.177-1.03.542-1.632 1.094-1.804L12 4V3z"/>\n</svg>\n'},{}],42:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--arrow-left"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 12L3 8l4-4M4 8h9-9z"></path></g></svg>\n'},{}],43:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--arrow-right"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 4l4 4-4 4m3-4H3h9z"></path></g></svg>\n'},{}],44:[function(e,t,n){arguments[4][3][0].apply(n,arguments)},{dup:3}],45:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--caret-right"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 4l4 4-4 4"></path></g></svg>\n'},{}],46:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--cc-std"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M7.985 0c2.238 0 4.143.781 5.715 2.343a7.694 7.694 0 011.714 2.579C15.804 5.888 16 6.914 16 8a8.164 8.164 0 01-.579 3.078 7.344 7.344 0 01-1.707 2.536 8.222 8.222 0 01-2.657 1.772c-.99.41-2.014.614-3.071.614a7.775 7.775 0 01-3.036-.607 8.047 8.047 0 01-2.6-1.757A7.846 7.846 0 010 8c0-1.057.202-2.074.607-3.05A8.033 8.033 0 012.371 2.33C3.895.777 5.766 0 7.985 0zm.03 1.443c-1.83 0-3.367.638-4.615 1.914a6.878 6.878 0 00-1.45 2.15A6.301 6.301 0 001.443 8c0 .858.168 1.684.507 2.479a6.627 6.627 0 001.45 2.129 6.593 6.593 0 002.129 1.428c.79.329 1.619.493 2.485.493.857 0 1.688-.166 2.494-.5a6.91 6.91 0 002.178-1.442c1.247-1.22 1.871-2.748 1.871-4.586a6.57 6.57 0 00-.486-2.515 6.397 6.397 0 00-1.413-2.114C11.37 2.086 9.824 1.443 8.014 1.443zm-.1 5.229l-1.073.557c-.114-.238-.254-.405-.42-.5a.95.95 0 00-.465-.143c-.714 0-1.072.472-1.072 1.415 0 .428.09.77.271 1.028.181.257.448.386.8.386.467 0 .796-.229.987-.686l.985.5a2.35 2.35 0 01-2.1 1.257c-.714 0-1.29-.218-1.729-.657-.438-.438-.657-1.047-.657-1.828 0-.762.222-1.367.665-1.814.442-.448 1.002-.672 1.678-.672.991 0 1.7.385 2.13 1.157zm4.613 0l-1.057.557c-.114-.238-.255-.405-.421-.5a.972.972 0 00-.479-.143c-.714 0-1.072.472-1.072 1.415 0 .428.091.77.272 1.028.18.257.447.386.8.386.466 0 .795-.229.985-.686l1 .5c-.218.39-.514.698-.885.922a2.308 2.308 0 01-1.214.335c-.724 0-1.302-.218-1.735-.657-.434-.438-.65-1.047-.65-1.828 0-.762.22-1.367.664-1.814.442-.448 1.002-.672 1.678-.672.99 0 1.696.385 2.114 1.157z"></path></g></svg>\n'},{}],47:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--cc-zero"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M7.983 0c2.238 0 4.148.78 5.72 2.342a7.662 7.662 0 011.715 2.582c.39.962.582 1.99.582 3.076a8.13 8.13 0 01-.583 3.087 7.262 7.262 0 01-1.703 2.526 8.213 8.213 0 01-2.655 1.77c-.99.41-2.018.617-3.076.617a7.902 7.902 0 01-3.042-.6 8.301 8.301 0 01-2.6-1.759A8.087 8.087 0 01.6 11.042 7.84 7.84 0 010 8c0-1.057.2-2.07.6-3.042a8.12 8.12 0 011.77-2.633C3.893.772 5.764 0 7.983 0zm.034 1.44c-1.829 0-3.369.64-4.616 1.915a6.962 6.962 0 00-1.457 2.157 6.388 6.388 0 000 4.969 6.83 6.83 0 003.585 3.558c.79.324 1.62.487 2.488.487.857 0 1.681-.165 2.482-.498a6.88 6.88 0 002.184-1.446C13.931 11.364 14.56 9.838 14.56 8a6.57 6.57 0 00-.487-2.515 6.418 6.418 0 00-1.418-2.118C11.37 2.081 9.826 1.44 8.017 1.44zM8 3.395c2.641 0 3.305 2.492 3.305 4.605 0 2.113-.664 4.605-3.305 4.605S4.694 10.113 4.694 8l.007-.355c.073-2.027.804-4.25 3.299-4.25zm1.316 3.227L7.35 10.017c-.274.412-.083.645.219.774l.135.044c.091.022.19.034.297.034 1.357 0 1.422-1.938 1.422-2.869l-.007-.409a7.282 7.282 0 00-.06-.72l-.04-.25zM8 5.132c-1.258 0-1.406 1.66-1.421 2.646L6.577 8c0 .24.005.544.035.865l.027.244 1.759-3.232c.182-.316.09-.542-.101-.706A1.222 1.222 0 008 5.13z"></path></g></svg>\n'},{}],48:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="Icon Icon--check"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 3L6 13 3 8"></path></g></svg>\n'},{}],49:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path fill="currentColor" fill-rule="nonzero" d="M7.456 4.212a.804.804 0 0 1 1.088 0l6.23 5.867c.301.283.301.742 0 1.025l-.726.684a.804.804 0 0 1-1.087.001L8 7.139l-4.961 4.65a.804.804 0 0 1-1.087-.001l-.727-.684a.695.695 0 0 1 0-1.025l6.23-5.867z"/>\n</svg>'},{}],50:[function(e,t,n){t.exports='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg width="16" height="16" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg">\n    <g transform="matrix(6.12323e-17,1,-1,6.12323e-17,15.9996,0.000432345)">\n        <path fill="currentColor" d="M7.456,4.212C7.762,3.931 8.238,3.931 8.544,4.212L14.774,10.079C15.075,10.362 15.075,10.821 14.774,11.104L14.048,11.788C13.742,12.069 13.267,12.069 12.961,11.789L8,7.139L3.039,11.789C2.733,12.069 2.258,12.069 1.952,11.788L1.225,11.104C1.081,10.972 0.999,10.786 0.999,10.592C0.999,10.397 1.081,10.211 1.225,10.079L7.455,4.212L7.456,4.212Z" />\n    </g>\n</svg>\n'},{}],51:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--copy"><g fill-rule="evenodd"><path fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 15H1V5h3m11-4v10H7V1h8z"></path><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect></g></svg>'},{}],52:[function(e,t,n){t.exports='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg width="10px" height="30px" viewBox="0 0 10 30" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    \x3c!-- Generator: Sketch 46.2 (44496) - http://www.bohemiancoding.com/sketch --\x3e\n    <title>Shape</title>\n    <desc>Created with Sketch.</desc>\n    <defs></defs>\n    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g transform="translate(-239.000000, -73.000000)" fill-rule="nonzero" fill="#000000">\n            <g transform="translate(1.000000, 1.000000)">\n                <path d="M243.3125,75.186875 C243.3125,73.535 243.3125,72.625 246.434687,72.625 L248,72.625 L248,72 L246.434687,72 C244.324375,72 243.402813,72.4684375 243,73.183125 C242.597187,72.4684375 241.675625,72 239.565313,72 L238,72 L238,72.625 L239.565313,72.625 C242.6875,72.6246875 242.6875,73.5346875 242.6875,75.186875 L242.6875,82 L242.6875,86.6875 L240.929375,86.6875 L240.929375,87.3125 L242.6875,87.3125 L242.6875,92 L242.6875,98.5434375 C242.6875,100.187188 242.6875,101.375 239.565313,101.375 L238,101.375 L238,102 L239.565313,102 C241.675625,102 242.5975,101.442813 243,100.6525 C243.402813,101.442813 244.324375,102 246.434687,102 L248,102 L248,101.375 L246.434687,101.375 C243.3125,101.374688 243.3125,100.187188 243.3125,98.5434375 L243.3125,91.9996875 L243.3125,87.3121875 L245.070312,87.3121875 L245.070312,86.6871875 L243.3125,86.6871875 L243.3125,81.9996875 L243.3125,75.186875 Z"></path>\n            </g>\n        </g>\n    </g>\n</svg>\n'},{}],53:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--edit"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 4l1 1-9 9-2 1 1-2 9-9zm3-3l1 1-1 1-1-1 1-1z"></path></g></svg>\n'},{}],54:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--email"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 3v10h14V3H1zm0 0l7 6 7-6H1z"></path></g></svg>\n'},{}],55:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path fill="currentColor" fill-rule="nonzero" d="M7.456 11.788L1.226 5.92a.695.695 0 0 1 0-1.025l.726-.684a.804.804 0 0 1 1.087-.001L8 8.861l4.961-4.65a.804.804 0 0 1 1.087.001l.727.684c.3.283.3.742 0 1.025l-6.23 5.867a.804.804 0 0 1-1.09 0z"/>\n</svg>'},{}],56:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--external"><g fill-rule="evenodd"><path fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 3h6v6m-1-5l-9 9 9-9z"></path><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect></g></svg>'},{}],57:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--social-facebook"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M15.999 8.049c0-4.445-3.582-8.049-8-8.049S0 3.604 0 8.049C0 12.066 2.925 15.396 6.75 16v-5.624H4.717V8.049H6.75V6.276c0-2.018 1.195-3.132 3.022-3.132.875 0 1.79.157 1.79.157v1.981h-1.008c-.994 0-1.304.62-1.304 1.257v1.51h2.219l-.355 2.327H9.25V16c3.825-.604 6.75-3.934 6.75-7.951z"></path></g></svg>\n'},{}],58:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--flag-filled"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M2 1a1 1 0 01.883-.993L3 0h12c.852 0 1.297.986.783 1.623l-.076.084L12.415 5l3.292 3.293c.575.575.253 1.523-.485 1.684l-.108.017L15 10H4v5a1 1 0 01-1.993.117L2 15V1z"></path></g></svg>\n'},{}],59:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--flag"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9v6V1h12l-4 4 4 4H3z"></path></g></svg>\n'},{}],60:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--editor-type-bold"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M8.661 16c.805 0 1.536-.117 2.193-.351a4.953 4.953 0 001.69-.993c.47-.428.831-.947 1.081-1.557s.375-1.287.375-2.03c0-.29-.038-.588-.114-.893a4.123 4.123 0 00-.325-.87 3.937 3.937 0 00-.495-.754 4.412 4.412 0 00-.604-.597c-.17-.126-.17-.264 0-.412.381-.335.699-.772.953-1.311.254-.54.382-1.062.382-1.568 0-.64-.132-1.244-.394-1.813a4.628 4.628 0 00-1.081-1.484c-.458-.42-1-.753-1.627-.999A5.531 5.531 0 008.66 0h-6.14a.534.534 0 00-.362.14A.415.415 0 002 .456v15.086c0 .119.053.225.159.318.106.093.227.139.362.139h6.14zm-.127-9.852H5.826c-.17 0-.254-.075-.254-.223V3.437c0-.157.085-.235.254-.235h2.708c.45 0 .847.145 1.195.435.347.29.521.633.521 1.027 0 .394-.174.74-.521 1.038a1.784 1.784 0 01-1.195.446zm0 6.65H5.826c-.17 0-.254-.075-.254-.223v-2.99c0-.157.085-.235.254-.235h2.708c.56 0 1.004.177 1.335.53.33.353.495.75.495 1.188 0 .454-.165.856-.495 1.205-.33.35-.776.525-1.335.525z"></path></g></svg>\n'},{}],61:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--editor-latex"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M13.392 16c.158 0 .299-.036.423-.108.123-.073.185-.155.185-.248v-1.778c0-.099-.062-.183-.185-.252a.848.848 0 00-.423-.104H6.85c-.138 0-.227-.028-.267-.083-.04-.055-.04-.105 0-.152l5.533-5.101c.158-.14.223-.265.193-.378a.755.755 0 00-.193-.325L6.88 2.707c-.04-.046-.042-.094-.007-.143.034-.05.13-.074.289-.074h6.17a.782.782 0 00.416-.108c.119-.073.178-.155.178-.248V.356c0-.093-.06-.175-.178-.248A.782.782 0 0013.333 0H2.905c-.158 0-.3.036-.423.108-.124.073-.185.155-.185.248v1.943c0 .128.037.236.11.326l.171.204 5.31 4.815c.04.047.065.106.075.178a.221.221 0 01-.074.195l-5.622 5.154c-.04.047-.094.113-.163.2A.512.512 0 002 13.7v1.943c0 .093.062.175.185.248a.822.822 0 00.423.108h10.784z"></path></g></svg>\n'},{}],62:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--editor-type-italic"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M10.61 16c.12 0 .23-.046.329-.14a.633.633 0 00.191-.317l.457-2.176a.348.348 0 00-.064-.313.336.336 0 00-.276-.133H8.845c-.142-.008-.198-.086-.17-.235l1.892-9.372c.035-.149.124-.223.266-.223H13a.49.49 0 00.335-.14.62.62 0 00.196-.318L13.99.457a.542.542 0 00.011-.1.337.337 0 00-.085-.223.336.336 0 00-.276-.134H5.805a.49.49 0 00-.335.14.62.62 0 00-.196.317l-.457 2.176a.353.353 0 00.069.318c.074.093.168.14.281.14h2.18c.141 0 .198.074.17.223l-1.893 9.372c-.028.156-.113.235-.255.235H2.967a.489.489 0 00-.324.133.59.59 0 00-.197.313l-.435 2.176a.542.542 0 00-.011.1c0 .082.025.156.074.223.071.09.16.134.266.134h8.27z"></path></g></svg>\n'},{}],63:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--list-ordered"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M2.748 11.5c.227 0 .443.034.646.103.203.069.381.164.534.286.155.123.276.267.364.432.089.168.134.35.134.543 0 .17-.042.333-.124.484a1.384 1.384 0 01-.19.269l-.062.061.047.035c.047.041.09.086.13.134l.058.075.075.122c.093.172.14.352.14.538 0 .201-.048.39-.143.566a1.44 1.44 0 01-.384.45c-.16.125-.344.223-.554.294-.21.072-.434.108-.67.108-.237 0-.461-.036-.671-.108a1.871 1.871 0 01-.555-.295 1.42 1.42 0 01-.382-.45 1.178 1.178 0 01-.132-.417L1 14.582l.002-.078.01-.05a.249.249 0 01.077-.111.283.283 0 01.121-.06l.07-.008h.708l.05.007c.044.01.084.028.12.056a.24.24 0 01.089.133l.006.054v.047l.005.077a.279.279 0 00.112.186c.088.066.213.101.378.101a.615.615 0 00.376-.102.29.29 0 00.12-.252.29.29 0 00-.12-.252.538.538 0 00-.262-.096l-.114-.007h-.1l-.051-.007a.292.292 0 01-.12-.059.244.244 0 01-.087-.13l-.006-.053.001-.57.01-.05a.249.249 0 01.078-.112.283.283 0 01.121-.06l.07-.008h.076l.112-.006a.454.454 0 00.224-.086.26.26 0 00.104-.222.246.246 0 00-.103-.213.533.533 0 00-.329-.09.527.527 0 00-.324.09.24.24 0 00-.098.148l-.006.065-.002.11-.01.05a.249.249 0 01-.081.112.292.292 0 01-.12.059l-.066.007h-.712l-.052-.007a.292.292 0 01-.12-.059.244.244 0 01-.087-.13l-.006-.054v-.096l.008-.135c.018-.141.062-.275.132-.402.091-.164.213-.307.366-.43.152-.122.33-.217.533-.286.203-.069.418-.103.645-.103zM15 13a1 1 0 01.117 1.993L15 15H7a1 1 0 01-.117-1.993L7 13h8zM2.777 5.5c.234 0 .454.034.66.101.207.068.389.164.544.288.156.124.28.27.372.437.093.17.14.355.14.551 0 .19-.049.37-.145.542-.07.123-.156.237-.258.34l-.108.1L2.71 8.932l1.52.001.053.006c.044.01.084.029.12.056.047.036.078.08.091.132l.007.054-.002.59-.01.05a.25.25 0 01-.083.113.298.298 0 01-.121.059L4.216 10H1.27l-.053-.007a.298.298 0 01-.122-.059.246.246 0 01-.089-.132L1 9.748v-.711l.004-.05a.26.26 0 01.04-.115l.034-.043.035-.033L3.04 7.167l.036-.036a.98.98 0 00.08-.114.295.295 0 00.055-.145.27.27 0 00-.099-.21c-.068-.062-.167-.094-.303-.094-.163 0-.285.032-.369.093a.244.244 0 00-.103.147l-.006.064-.002.123-.01.052a.25.25 0 01-.084.112.298.298 0 01-.12.058l-.069.008h-.726l-.053-.007a.298.298 0 01-.121-.059.246.246 0 01-.09-.132l-.006-.054V6.87l.01-.137c.017-.143.063-.28.135-.407.094-.167.22-.313.379-.437.157-.123.339-.219.544-.287.206-.067.425-.101.658-.101zM15 7a1 1 0 01.117 1.993L15 9H7a1 1 0 01-.117-1.993L7 7h8zM3.237 0l.052.008c.044.01.084.031.12.061a.248.248 0 01.083.132l.006.052-.004 3.167.744.001.051.007c.044.01.084.03.119.058.044.036.074.08.086.132l.006.053-.001.595-.01.05a.278.278 0 01-.197.176l-.07.008H1.29l-.051-.008a.287.287 0 01-.12-.061.248.248 0 01-.084-.132l-.006-.052.001-.596.01-.05a.247.247 0 01.077-.113.28.28 0 01.12-.06l.069-.008.932.002.003-1.959-.796.629-.068.037a.295.295 0 01-.196-.002.25.25 0 01-.172-.179L1 1.881v-.587l.007-.089.015-.075a.345.345 0 01.073-.132l.06-.059.83-.758.04-.036A.994.994 0 012.139.07a.498.498 0 01.183-.062L2.428 0h.809zM15 1a1 1 0 01.117 1.993L15 3H7a1 1 0 01-.117-1.993L7 1h8z"></path></g></svg>\n'},{}],64:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--list-unordered"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M15 1a1 1 0 01.117 1.993L15 3H7a1 1 0 01-.117-1.993L7 1h8zm0 6a1 1 0 01.117 1.993L15 9H7a1 1 0 01-.117-1.993L7 7h8zM2 12a2 2 0 110 4 2 2 0 010-4zm13 1a1 1 0 01.117 1.993L15 15H7a1 1 0 01-.117-1.993L7 13h8zM2 6a2 2 0 110 4 2 2 0 010-4zm0-6a2 2 0 110 4 2 2 0 010-4z"></path></g></svg>\n'},{}],65:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--editor-quote"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M2.701 14c.38 0 .659-.085.837-.255.177-.17.328-.343.45-.52l2.408-3.25c.246-.328.445-.725.598-1.19a4.69 4.69 0 00.23-1.475V2.775a.752.752 0 00-.23-.539A.713.713 0 006.47 2H1.947a.713.713 0 00-.524.236.752.752 0 00-.23.539v4.649c0 .214.077.396.23.548a.726.726 0 00.524.226h.901c.123 0 .23.054.322.161.092.107.101.224.028.35l-2.041 3.817c-.196.365-.208.702-.037 1.011.172.309.447.463.827.463h.754zm7.795 0c.367 0 .64-.085.818-.255.178-.17.328-.343.45-.52l2.409-3.25c.257-.328.46-.725.606-1.19A4.87 4.87 0 0015 7.31V2.775a.752.752 0 00-.23-.539.713.713 0 00-.524-.236H9.742a.703.703 0 00-.533.236.767.767 0 00-.22.539v4.649c0 .214.076.396.23.548a.726.726 0 00.523.226h.9c.123 0 .228.054.313.161.086.107.092.224.019.35L8.95 12.526c-.208.365-.223.702-.045 1.011.177.309.456.463.836.463h.754z"></path></g></svg>\n'},{}],66:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--groups"><g fill-rule="evenodd"><path fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 15a3 3 0 0 1 6 0m2-4a3 3 0 0 1 6 0M4 9a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm8-4a2 2 0 1 1 0-4 2 2 0 0 1 0 4z"></path><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect></g></svg>\n'},{}],67:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--help"><g fill-rule="evenodd"><path fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4c0-1.657 1.79-3 4-3s4 1.343 4 3-1.79 3-4 3m0 0v2-2zm0 8a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"></path><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect></g></svg>\n'},{}],68:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15H1h11zm-.5-6v2l-1 1v-2l1-1zm.5-7v6h-2V2h2zm0-1h-2 2zm0 8h-2 2z"></path></g></svg>\n'},{}],69:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--image"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 1v14H1V1h14zM1 15l3-8 4 6 3-4 4 6m-4-9a1 1 0 110-2 1 1 0 010 2z"></path></g></svg>\n'},{}],70:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path fill="currentColor" fill-rule="nonzero" d="M8 0c4.42 0 8 3.58 8 8s-3.58 8-8 8-8-3.58-8-8 3.58-8 8-8zm0 14.452A6.45 6.45 0 0 0 14.452 8 6.45 6.45 0 0 0 8 1.548 6.45 6.45 0 0 0 1.548 8 6.45 6.45 0 0 0 8 14.452zm3.284-8.458L9.277 8l2.007 2.006a.387.387 0 0 1 0 .549l-.73.729a.387.387 0 0 1-.548 0L8 9.277l-2.006 2.007a.387.387 0 0 1-.549 0l-.729-.73a.387.387 0 0 1 0-.548L6.723 8 4.716 5.994a.387.387 0 0 1 0-.549l.73-.729a.387.387 0 0 1 .548 0L8 6.723l2.006-2.007a.387.387 0 0 1 .549 0l.729.73a.387.387 0 0 1 0 .548z"/>\n</svg>'},{}],71:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--link"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.069 3.042l1.057-1.274c1.193-1.106 3.035-.938 4.046 0 1.012.94 1.193 2.649 0 3.755L11.046 9.17m0 0c-1.193 1.107-2.853 1.107-4.046 0m-.069 3.788l-1.057 1.274c-1.193 1.106-3.035.938-4.046 0-1.012-.94-1.193-2.649 0-3.755L4.954 6.83m0 0C6.147 5.723 7.807 5.723 9 6.8"></path></g></svg>\n'},{}],72:[function(e,t,n){t.exports='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg width="48px" height="56px" viewBox="0 0 48 56" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g fill="currentColor">\n            <rect x="0" y="24" width="48" height="32"></rect>\n            <path d="M24,0 C24,0 8,0 8,16 L8,32 L16,32 L16,16.0000004 C16,8 24,8 24,8 C24,8 32,8 32,16 L32,32 L40,32 L40,16 C40,0 24,0 24,0 Z"></path>\n        </g>\n    </g>\n</svg>\n'},{}],73:[function(e,t,n){t.exports='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg width="24px" height="28px" viewBox="0 0 24 28" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <rect fill="#ffffff" stroke="none" width="17.14407" height="16.046612" x="3.8855932" y="3.9449153" />\n    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <path d="M0,2.00494659 C0,0.897645164 0.897026226,0 2.00494659,0 L21.9950534,0 C23.1023548,0 24,0.897026226 24,2.00494659 L24,21.9950534 C24,23.1023548 23.1029738,24 21.9950534,24 L2.00494659,24 C0.897645164,24 0,23.1029738 0,21.9950534 L0,2.00494659 Z M9,24 L12,28 L15,24 L9,24 Z M7.00811294,4 L4,4 L4,20 L7.00811294,20 L7.00811294,15.0028975 C7.00811294,12.004636 8.16824717,12.0097227 9,12 C10,12.0072451 11.0189302,12.0606714 11.0189302,14.003477 L11.0189302,20 L14.0270431,20 L14.0270431,13.1087862 C14.0270433,10 12,9.00309038 10,9.00309064 C8.01081726,9.00309091 8,9.00309086 7.00811294,11.0019317 L7.00811294,4 Z M19,19.9869002 C20.1045695,19.9869002 21,19.0944022 21,17.9934501 C21,16.892498 20.1045695,16 19,16 C17.8954305,16 17,16.892498 17,17.9934501 C17,19.0944022 17.8954305,19.9869002 19,19.9869002 Z" fill="currentColor"></path>\n    </g>\n</svg>\n'},{}],74:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="15" height="8" viewBox="0 0 15 8" aria-hidden="true" focusable="false"><path d="M0 8 L7 0 L15 8" stroke="currentColor" strokeWidth="2" /></svg>\n'},{}],75:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--profile"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 15c0-2.761 3.134-5 7-5s7 2.239 7 5M8 7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"></path></g></svg>\n'},{}],76:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path fill="currentColor" fill-rule="nonzero" d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0zm2.655 11.535c.244-.242.442-.719.442-1.063a1.13 1.13 0 0 0-.288-.696l-.442-.442a1.033 1.033 0 0 0-.73-.302H7.484C7.181 8.88 6.791 8 6.452 8c-.34 0-.674-.08-.978-.231l-.357-.179a.386.386 0 0 1-.213-.345c0-.153.118-.317.263-.366l1.006-.335a.618.618 0 0 1 .163-.026c.106 0 .258.056.338.126l.3.26c.046.04.106.063.169.063h.182a.258.258 0 0 0 .23-.373l-.503-1.006a.306.306 0 0 1-.027-.116c0-.06.035-.143.078-.185l.32-.31a.258.258 0 0 1 .18-.074h.29c.06 0 .141-.034.183-.076l.258-.258c.1-.1.1-.264 0-.364l-.151-.152c-.101-.1-.101-.264 0-.365l.333-.333.151-.151a.516.516 0 0 0 0-.73l-.912-.913a6.45 6.45 0 0 0-.787.078v.365a.516.516 0 0 1-.747.461l-.775-.387a6.487 6.487 0 0 0-3.329 3.287c.32.474.813 1.205 1.116 1.65.138.203.4.503.582.668l.026.023c.308.278.65.516 1.021.702.452.227 1.111.586 1.575.842.328.182.53.527.53.903v1.032c0 .274.11.537.303.73.484.484.785 1.246.73 1.653v.884c.473 0 .932-.055 1.376-.152l.56-1.511c.067-.177.106-.362.155-.544a.771.771 0 0 1 .199-.346l.365-.364zm2.797-2.946l.94.235c.036-.27.06-.544.06-.824a6.4 6.4 0 0 0-.688-2.882l-.419.21a.773.773 0 0 0-.298.263l-.632.947a.908.908 0 0 0-.13.43c0 .13.058.321.13.43l.58.87c.107.16.27.274.457.32z"/>\n</svg>\n'},{}],77:[function(e,t,n){t.exports='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    \x3c!-- Generator: Sketch 39.1 (31720) - http://www.bohemiancoding.com/sketch --\x3e\n    <defs/>\n    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g fill="currentColor">\n            <g>\n                <path d="M0,8 C0,12.418278 3.581722,16 8,16 C12.418278,16 16,12.418278 16,8 C16,4.89580324 14.2154684,2.11256098 11.4682644,0.789110134 L10.6002482,2.59092808 C12.661769,3.58405472 14,5.6712248 14,8 C14,11.3137085 11.3137085,14 8,14 C4.6862915,14 2,11.3137085 2,8 C2,5.65296151 3.35941993,3.55225774 5.44569583,2.56903563 L4.59307587,0.759881355 C1.81273067,2.07020511 0,4.87140735 0,8 Z" />\n                <polygon points="7 8.58578644 7 0 9 0 9 8.58578644 10.2928932 7.29289322 11 6.58578644 12.4142136 8 11.7071068 8.70710678 8.70710678 11.7071068 8 12.4142136 7.64644661 12.0606602 7.29289322 11.7071068 4.29289322 8.70710678 3.58578644 8 5 6.58578644 5.70710678 7.29289322"/>\n            </g>\n        </g>\n    </g>\n</svg>\n'},{}],78:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path fill="currentColor" fill-rule="nonzero" d="M6.422 5.422c2 0 3.542.417 4.625 1.25 1.083.833 1.875 1.75 2.375 2.75s.792 1.917.875 2.75l.125 1.25h-2l-.094-.938c-.062-.625-.281-1.312-.656-2.062-.375-.75-.969-1.438-1.781-2.063-.813-.625-1.97-.937-3.47-.937H4.829l2 2-1.406 1.422L1 6.422 5.422 2l1.406 1.422-2 2h1.594z"/>\n</svg>\n'},{}],79:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 1C4.5 1 1 4.5 1 8s3.5 7 7 7 7-3.5 7-7-3.5-7-7-7zm0 7l-4 4 4-4 4-4-4 4z"></path></g></svg>\n'},{}],80:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--search"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.536 9.536a5 5 0 1 1-7.071-7.071 5 5 0 0 1 7.07 7.07L15 15 9.536 9.536z"></path></g></svg>\n'},{}],81:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--share"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 11V2m7 8v5H1v-5m3-5l4-4 4 4"></path></g></svg>\n'},{}],82:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--sort"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 9V2v7zM1 5l4-4 4 4m2 2v7-7zm-4 4l4 4 4-4"></path></g></svg>\n'},{}],83:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--trash"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2 4h12l-2 11H4L2 4zM1 1h14H1z"></path></g></svg>\n'},{}],84:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--social-twitter"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M15.969 3.049c-.59.259-1.22.436-1.884.516a3.305 3.305 0 0 0 1.442-1.815c-.634.37-1.336.64-2.084.79a3.28 3.28 0 0 0-5.59 2.988 9.29 9.29 0 0 1-6.76-3.418A3.214 3.214 0 0 0 .65 3.76c0 1.14.58 2.142 1.459 2.73a3.27 3.27 0 0 1-1.485-.41v.04a3.282 3.282 0 0 0 2.63 3.218 3.33 3.33 0 0 1-1.474.057 3.291 3.291 0 0 0 3.069 2.278A6.578 6.578 0 0 1 .78 13.076c-.26 0-.52-.015-.78-.044a9.33 9.33 0 0 0 5.038 1.472c6.036 0 9.332-4.997 9.332-9.323 0-.14 0-.28-.01-.42.64-.46 1.2-1.04 1.64-1.7l-.031-.012z"></path></g></svg>\n'},{}],85:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default={FEATURE_FLAGS_UPDATED:"featureFlagsUpdated",HELP_REQUESTED:"helpRequested",LOGIN_REQUESTED:"loginRequested",LOGOUT_REQUESTED:"logoutRequested",PROFILE_REQUESTED:"profileRequested",PUBLIC_ANNOTATION_COUNT_CHANGED:"publicAnnotationCountChanged",SIGNUP_REQUESTED:"signupRequested"}},{}],86:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Bridge=void 0;var r=e("./port-rpc");n.Bridge=class{constructor(){this.links=[],this.channelListeners={},this.onConnectListeners=[],this.on("connect",(e=>e()))}destroy(){this.links.forEach((e=>e.destroy())),this.links=[]}createChannel(e){const t=new r.PortRPC(e,this.channelListeners);let n=!1;return t.call("connect",(()=>{n||(n=!0,this.onConnectListeners.forEach((e=>e(t))))})),this.links.push(t),t}call(e,...t){let n;const r=t[t.length-1];"function"==typeof r&&(n=r,t=t.slice(0,-1));const o=e=>t=>{throw e.destroy(),this.links=this.links.filter((t=>t!==e)),t},i=this.links.map((n=>new Promise(((r,o)=>{const i=setTimeout((()=>r(null)),1e3);try{n.call(e,...t,((e,t)=>{clearTimeout(i),e?o(e):r(t)}))}catch(s){o(s)}})).catch(o(n))));let s=Promise.all(i);return n&&(s=s.then((e=>n(null,e))).catch((e=>n(e)))),s}on(e,t){if(this.links.length>0)throw new Error(`Listener '${e}' can't be registered because a channel has already been created`);if(this.channelListeners[e])throw new Error(`Listener '${e}' already bound in Bridge`);return this.channelListeners[e]=t,this}onConnect(e){return this.onConnectListeners.push(e),this}}},{"./port-rpc":88}],87:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Injector=void 0;n.Injector=class{constructor(){this._providers=new Map,this._instances=new Map,this._constructing=new Set}get(e){if(this._instances.has(e))return this._instances.get(e);const t=this._providers.get(e);if(!t)throw new Error(`"${e}" is not registered`);if("value"in t)return this._instances.set(e,t.value),t.value;if(this._constructing.has(e))throw new Error(`Encountered a circular dependency when constructing "${e}"`);this._constructing.add(e);try{const r=[],o="class"in t&&t.class.$inject||"factory"in t&&t.factory.$inject||[];for(const t of o)try{r.push(this.get(t))}catch(n){const r=new Error(`Failed to construct dependency "${t}" of "${e}": ${n.message}`);throw r.cause=n,r}let i;return i=t.class?new t.class(...r):(0,t.factory)(...r),this._instances.set(e,i),i}finally{this._constructing.delete(e)}}register(e,t){if("function"==typeof t)t={class:t};else if(!function(e){return"object"==typeof e&&null!==e&&("value"in e||"function"==typeof e.class||"function"==typeof e.factory)}(t))throw new Error(`Invalid provider for "${e}"`);return this._providers.set(e,t),this}run(e){const t="Injector.run";this.register(t,{factory:e});try{return this.get(t)}finally{this._instances.delete(t),this._providers.delete(t)}}}},{}],88:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.PortRPC=void 0;var r=e("../annotator/util/listener-collection");const o="frame-rpc";n.PortRPC=class{constructor(e,t){this._port=e,this._methods=t,this._sequence=0,this._callbacks={},this._destroyed=!1,this._listeners=new r.ListenerCollection,this._listeners.add(this._port,"message",(e=>this._handle(e))),this._port.start()}destroy(){this._destroyed=!0,this._listeners.removeAll(),this._port.close()}call(e,...t){if(this._destroyed)return;const n=this._sequence++,r=t[t.length-1];"function"==typeof r&&(this._callbacks[n]=r,t=t.slice(0,-1));const i={arguments:t,method:e,protocol:o,sequence:n,version:"1.0.0"};this._port.postMessage(i)}_parseMessage({data:e}){return e&&"object"==typeof e?e.protocol!==o||"1.0.0"!==e.version?null:Array.isArray(e.arguments)?e:null:null}_handle(e){const t=this._parseMessage(e);if(null!==t)if("method"in t){if(!this._methods.hasOwnProperty(t.method))return;const e=(...e)=>{const n={arguments:e,protocol:o,response:t.sequence,version:"1.0.0"};this._port.postMessage(n)};this._methods[t.method](...t.arguments,e)}else if("response"in t){const e=this._callbacks[t.response];delete this._callbacks[t.response],e&&e(...t.arguments)}}}},{"../annotator/util/listener-collection":38}],89:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.confirm=async function({title:e="Confirm",message:t,confirmAction:n="Yes"}){const s=document.createElement("div");return s.setAttribute("data-testid","confirm-container"),s.style.position="relative",s.style.zIndex="10",document.body.appendChild(s),new Promise((a=>{const c=e=>{(0,r.render)(null,s),s.remove(),a(e)};(0,r.render)((0,i.jsx)(o.ConfirmModal,{title:e,message:t,confirmAction:n,onConfirm:()=>c(!0),onCancel:()=>c(!1)}),s)}))};var r=e("preact"),o=e("@hypothesis/frontend-shared"),i=e("preact/jsx-runtime")},{"@hypothesis/frontend-shared":18,preact:26,"preact/jsx-runtime":28}],90:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.setupBrowserFixes=function(e=r.options){let t=!1;try{document.createElement("div").dir="auto"}catch(n){t=!0}if(t){const t=e.vnode;e.vnode=e=>{"string"==typeof e.type&&"dir"in e.props&&"auto"===e.props.dir&&(e.props.dir=""),t&&t(e)}}};var r=e("preact")},{preact:26}],91:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.toBoolean=function(e){if("string"==typeof e&&"false"===e.trim().toLocaleLowerCase())return!1;const t=Number(e);return isNaN(t)?"string"==typeof e:Boolean(t)},n.toInteger=function(e){return parseInt(e)},n.toObject=function(e){return"object"==typeof e&&null!==e?e:{}},n.toString=function(e){return e&&"function"==typeof e.toString?e.toString():""}},{}],92:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isTouchDevice=n.isIOS=n.isMacOS=void 0;n.isMacOS=(e=window.navigator.userAgent)=>e.indexOf("Mac OS")>=0;n.isIOS=(e=window.navigator,t="ontouchend"in document)=>["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(e.platform)||e.userAgent.includes("Mac")&&t;n.isTouchDevice=(e=window)=>e.matchMedia("(pointer: coarse)").matches},{}],93:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=o;let r={};function o(...e){const t=e.join();t in r||(console.warn(...e),r[t]=!0)}o.reset=()=>{r={}}},{}],94:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=h(e("classnames")),o=e("../../store/use-store"),i=e("../../helpers/annotation-metadata"),s=e("../../service-context"),a=h(e("./AnnotationActionBar")),c=h(e("./AnnotationBody")),l=h(e("./AnnotationEditor")),u=h(e("./AnnotationHeader")),d=h(e("./AnnotationQuote")),f=h(e("./AnnotationReplyToggle")),p=e("preact/jsx-runtime");function h(e){return e&&e.__esModule?e:{default:e}}var m=(0,s.withServices)((function({annotation:e,hasAppliedFilter:t,isReply:n,onToggleReplies:s,replyCount:h,threadIsCollapsed:m,annotationsService:g}){const v=n&&m,y=(0,o.useStoreProxy)(),_=e&&!!(0,i.quote)(e),b=e&&y.isAnnotationFocused(e.$tag),j=e&&y.isSavingAnnotation(e),w=e&&!!y.getDraft(e)&&!j,x=y.profile().userid,O=!j&&!w,S=!n&&!t&&h>0;return(0,p.jsxs)("article",{className:(0,r.default)("Annotation",{"Annotation--missing":!e,"Annotation--reply":n,"is-collapsed":m,"is-focused":b}),children:[e&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(u.default,{annotation:e,isEditing:w,replyCount:h,threadIsCollapsed:m}),_&&(0,p.jsx)(d.default,{annotation:e,isFocused:b}),!v&&!w&&(0,p.jsx)(c.default,{annotation:e}),w&&(0,p.jsx)(l.default,{annotation:e})]}),!e&&!v&&(0,p.jsx)("div",{children:(0,p.jsx)("em",{children:"Message not available."})}),!v&&(0,p.jsx)("footer",{className:"Annotation__footer",children:(0,p.jsxs)("div",{className:"Annotation__controls u-layout-row",children:[S&&(0,p.jsx)(f.default,{onToggleReplies:s,replyCount:h,threadIsCollapsed:m}),j&&(0,p.jsx)("div",{className:"Annotation__actions",children:"Saving..."}),e&&O&&(0,p.jsx)("div",{className:"u-layout-row--justify-right u-stretch",children:(0,p.jsx)(a.default,{annotation:e,onReply:()=>g.reply(e,x)})})]})})]})}),["annotationsService"]);n.default=m},{"../../helpers/annotation-metadata":164,"../../service-context":188,"../../store/use-store":227,"./AnnotationActionBar":95,"./AnnotationBody":96,"./AnnotationEditor":98,"./AnnotationHeader":99,"./AnnotationQuote":102,"./AnnotationReplyToggle":103,classnames:19,"preact/jsx-runtime":28}],95:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,o=e("@hypothesis/frontend-shared"),i=e("../../../shared/prompts"),s=e("../../config/service-config"),a=e("../../helpers/annotation-sharing"),c=e("../../helpers/permissions"),l=e("../../service-context"),u=e("../../store/use-store"),d=(r=e("./AnnotationShareControl"))&&r.__esModule?r:{default:r},f=e("preact/jsx-runtime");var p=(0,l.withServices)((function({annotation:e,annotationsService:t,onReply:n,settings:r,toastMessenger:l}){const p=(0,u.useStoreProxy)(),h=p.profile(),m=p.getGroup(e.group),g=p.isLoggedIn(),v=t=>(0,c.permits)(e.permissions,t,h.userid),y=v("delete"),_=v("update"),b=function(e){const t=(0,s.serviceConfig)(e);return!1!==(null==t?void 0:t.allowFlagging)}(r)&&!!h.userid&&h.userid!==e.user,j=(0,a.sharingEnabled)(r)&&(0,a.annotationSharingLink)(e);return(0,f.jsxs)("div",{className:"AnnotationActionBar u-layout-row u-font--xlarge",children:[_&&(0,f.jsx)(o.IconButton,{icon:"edit",title:"Edit",onClick:()=>{p.createDraft(e,{tags:e.tags,text:e.text,isPrivate:(0,c.isPrivate)(e.permissions)})}}),y&&(0,f.jsx)(o.IconButton,{icon:"trash",title:"Delete",onClick:async()=>{if(await(0,i.confirm)({title:"Delete annotation?",message:"Are you sure you want to delete this annotation?",confirmAction:"Delete"}))try{await t.delete(e)}catch(n){l.error(n.message)}}}),(0,f.jsx)(o.IconButton,{icon:"reply",title:"Reply",onClick:()=>{g?n():p.openSidebarPanel("loginPrompt")}}),j&&(0,f.jsx)(d.default,{annotation:e,group:m,shareUri:j}),b&&!e.flagged&&(0,f.jsx)(o.IconButton,{icon:"flag",title:"Report this annotation to moderators",onClick:()=>{t.flag(e).catch((()=>l.error("Flagging annotation failed")))}}),b&&e.flagged&&(0,f.jsx)(o.IconButton,{pressed:!0,icon:"flag--active",title:"Annotation has been reported to the moderators"})]})}),["annotationsService","settings","toastMessenger"]);n.default=p},{"../../../shared/prompts":89,"../../config/service-config":161,"../../helpers/annotation-sharing":165,"../../helpers/permissions":172,"../../service-context":188,"../../store/use-store":227,"./AnnotationShareControl":104,"@hypothesis/frontend-shared":18,"preact/jsx-runtime":28}],96:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@hypothesis/frontend-shared"),o=e("preact/hooks"),i=e("../../store/use-store"),s=e("../../helpers/annotation-metadata"),a=e("../../service-context"),c=e("../../helpers/theme"),l=p(e("../Excerpt")),u=p(e("../MarkdownView")),d=p(e("../TagList")),f=e("preact/jsx-runtime");function p(e){return e&&e.__esModule?e:{default:e}}var h=(0,a.withServices)((function({annotation:e,settings:t}){var n,a;const[p,h]=(0,o.useState)(!0),[m,g]=(0,o.useState)(!1),v=(0,i.useStoreProxy)().getDraft(e),y=p?"More":"Less",_=null!==(n=null==v?void 0:v.tags)&&void 0!==n?n:e.tags,b=null!==(a=null==v?void 0:v.text)&&void 0!==a?a:e.text,j=b.length>0,w=_.length>0,x=(0,c.applyTheme)(["annotationFontFamily"],t);return(0,f.jsxs)("div",{className:"AnnotationBody",children:[j&&(0,f.jsx)(l.default,{collapse:p,collapsedHeight:400,inlineControls:!1,onCollapsibleChanged:g,onToggleCollapsed:h,overflowThreshold:20,children:(0,f.jsx)(u.default,{textStyle:x,markdown:b,textClass:{AnnotationBody__text:!0,"is-hidden":(0,s.isHidden)(e)}})}),m&&(0,f.jsx)("div",{className:"AnnotationBody__collapse-toggle",children:(0,f.jsx)(r.LabeledButton,{expanded:!p,onClick:()=>h(!p),title:`Toggle visibility of full annotation text: Show ${y}`,children:y})}),w&&(0,f.jsx)(d.default,{annotation:e,tags:_})]})}),["settings"]);n.default=h},{"../../helpers/annotation-metadata":164,"../../helpers/theme":175,"../../service-context":188,"../../store/use-store":227,"../Excerpt":111,"../MarkdownView":124,"../TagList":147,"@hypothesis/frontend-shared":18,"preact/hooks":27,"preact/jsx-runtime":28}],97:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({domain:e,link:t,title:n}){return(0,r.jsxs)("div",{className:"u-layout-row u-horizontal-rhythm",children:[(0,r.jsxs)("div",{className:"u-color-text--muted",children:['on "',t?(0,r.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",children:n}):(0,r.jsx)("span",{children:n}),'"']}),e&&(0,r.jsxs)("span",{className:"u-color-text--muted",children:["(",e,")"]})]})};var r=e("preact/jsx-runtime")},{"preact/jsx-runtime":28}],98:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@hypothesis/frontend-shared"),o=e("preact/hooks"),i=e("../../service-context"),s=e("../../helpers/theme"),a=e("../../store/use-store"),c=p(e("../MarkdownEditor")),l=p(e("../TagEditor")),u=p(e("./AnnotationLicense")),d=p(e("./AnnotationPublishControl")),f=e("preact/jsx-runtime");function p(e){return e&&e.__esModule?e:{default:e}}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=(0,i.withServices)((function({annotation:e,annotationsService:t,settings:n,tags:i,toastMessenger:p}){const[h,g]=(0,o.useState)(null),v=(0,a.useStoreProxy)(),y=v.getDraft(e),_=v.getGroup(e.group);if(!y)return null;const b=!y.isPrivate&&_&&"private"!==_.type,j=y.tags,w=y.text,x=!w&&!j.length,O=({tags:e})=>{v.createDraft(y.annotation,m(m({},y),{},{tags:e}))},S=e=>{if(!e||j.indexOf(e)>=0)return!1;const t=[...j,e];return i.store(t),O({tags:t}),!0},k=async()=>{h&&S(h);try{await t.save(e)}catch(n){p.error("Saving annotation failed")}},P=(0,s.applyTheme)(["annotationFontFamily"],n);return(0,f.jsxs)("div",{className:"AnnotationEditor u-vertical-rhythm",onKeyDown:e=>{const t=(0,r.normalizeKeyName)(e.key);x||(e.metaKey||e.ctrlKey)&&"Enter"===t&&(e.stopPropagation(),e.preventDefault(),k())},children:[(0,f.jsx)(c.default,{textStyle:P,label:"Annotation body",text:w,onEditText:({text:e})=>{v.createDraft(y.annotation,m(m({},y),{},{text:e}))}}),(0,f.jsx)(l.default,{onAddTag:S,onRemoveTag:e=>{const t=[...j],n=t.indexOf(e);return n>=0&&(t.splice(n,1),O({tags:t}),!0)},onTagInput:g,tagList:j}),(0,f.jsx)("div",{className:"annotation__form-actions u-layout-row",children:(0,f.jsx)(d.default,{annotation:e,isDisabled:x,onSave:k})}),b&&(0,f.jsx)(u.default,{})]})}),["annotationsService","settings","tags","toastMessenger"]);n.default=v},{"../../helpers/theme":175,"../../service-context":188,"../../store/use-store":227,"../MarkdownEditor":123,"../TagEditor":146,"./AnnotationLicense":100,"./AnnotationPublishControl":101,"@hypothesis/frontend-shared":18,"preact/hooks":27,"preact/jsx-runtime":28}],99:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@hypothesis/frontend-shared"),o=e("preact/hooks"),i=e("../../service-context"),s=e("../../store/use-store"),a=e("../../helpers/account-id"),c=e("../../helpers/annotation-metadata"),l=e("../../helpers/annotation-user"),u=e("../../helpers/permissions"),d=g(e("./AnnotationDocumentInfo")),f=g(e("./AnnotationShareInfo")),p=g(e("./AnnotationTimestamps")),h=g(e("./AnnotationUser")),m=e("preact/jsx-runtime");function g(e){return e&&e.__esModule?e:{default:e}}var v=(0,i.withServices)((function({annotation:e,isEditing:t,replyCount:n,threadIsCollapsed:i,settings:g}){var v;const y=(0,s.useStoreProxy)(),_=y.defaultAuthority(),b=y.isFeatureEnabled("client_display_names"),j=(0,a.isThirdPartyUser)(e.user,_),w=(0,l.annotationDisplayName)(e,j,b),x=j?null!==(O=g.usernameUrl&&`${g.usernameUrl}${(0,a.username)(e.user)}`)&&void 0!==O?O:void 0:y.getLink("user",{user:e.user});var O;const S=(0,c.isReply)(e)&&i,k=(0,u.isPrivate)(e.permissions),P=(null===(v=e.links)||void 0===v?void 0:v.html)||"",E=!t&&e.created,A=(0,o.useMemo)((()=>(0,c.hasBeenEdited)(e)&&!S),[e,S]),N=`${n} ${n>1?"replies":"reply"}`,T=n>0&&S,C=!(0,c.isReply)(e),M=(0,c.domainAndTitle)(e),D=P&&M.titleLink?M.titleLink:"",L="sidebar"!==y.route()&&M.titleText;return(0,m.jsxs)("header",{className:"AnnotationHeader",children:[(0,m.jsxs)("div",{className:"AnnotationHeader__row u-horizontal-rhythm",children:[k&&!t&&(0,m.jsx)(r.SvgIcon,{className:"AnnotationHeader__icon",name:"lock",title:"This annotation is visible only to you"}),(0,m.jsx)(h.default,{authorLink:x,displayName:w}),T&&(0,m.jsx)(r.LinkButton,{onClick:()=>y.setExpanded(e.id,!0),title:"Expand replies",children:N}),E&&(0,m.jsx)("div",{className:"u-layout-row--justify-right u-stretch",children:(0,m.jsx)(p.default,{annotationCreated:e.created,annotationUpdated:e.updated,annotationUrl:P,withEditedTimestamp:A})})]}),C&&(0,m.jsxs)("div",{className:"AnnotationHeader__row u-horizontal-rhythm",children:[(0,m.jsx)(f.default,{annotation:e}),!t&&(0,c.isHighlight)(e)&&(0,m.jsx)("div",{className:"AnnotationHeader__highlight",children:(0,m.jsx)(r.SvgIcon,{name:"highlight",title:"This is a highlight. Click 'edit' to add a note or tag.",inline:!0,className:"AnnotationHeader__highlight-icon"})}),L&&(0,m.jsx)(d.default,{domain:M.domain,link:D,title:M.titleText})]})]})}),["settings"]);n.default=v},{"../../helpers/account-id":163,"../../helpers/annotation-metadata":164,"../../helpers/annotation-user":166,"../../helpers/permissions":172,"../../service-context":188,"../../store/use-store":227,"./AnnotationDocumentInfo":97,"./AnnotationShareInfo":105,"./AnnotationTimestamps":106,"./AnnotationUser":107,"@hypothesis/frontend-shared":18,"preact/hooks":27,"preact/jsx-runtime":28}],100:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){return(0,o.jsx)("div",{className:"AnnotationLicense",children:(0,o.jsxs)("a",{className:"u-layout-row u-color-text--muted",href:"http://creativecommons.org/publicdomain/zero/1.0/",title:"View more information about the Creative Commons Public Domain dedication",target:"_blank",rel:"noopener noreferrer",children:[(0,o.jsxs)("div",{className:"AnnotationLicense__icons",children:[(0,o.jsx)(r.SvgIcon,{name:"cc-std",inline:!0,className:"u-icon--xsmall"}),(0,o.jsx)(r.SvgIcon,{name:"cc-zero",inline:!0,className:"u-icon--xsmall"})]}),"Annotations can be freely reused by anyone for any purpose."]})})};var r=e("@hypothesis/frontend-shared"),o=e("preact/jsx-runtime")},{"@hypothesis/frontend-shared":18,"preact/jsx-runtime":28}],101:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@hypothesis/frontend-shared"),o=e("../../store/use-store"),i=e("../../helpers/annotation-metadata"),s=e("../../helpers/permissions"),a=e("../../service-context"),c=e("../../helpers/theme"),l=f(e("../Menu")),u=f(e("../MenuItem")),d=e("preact/jsx-runtime");function f(e){return e&&e.__esModule?e:{default:e}}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=(0,a.withServices)((function({annotation:e,isDisabled:t,onSave:n,settings:a}){const f=(0,o.useStoreProxy)(),p=f.getDraft(e),m=f.getGroup(e.group);if(!m)return null;const g=p?p.isPrivate:!(0,s.isShared)(e.permissions),v=g?"Only Me":m.name,y=t=>{f.createDraft(e,h(h({},p),{},{isPrivate:"private"===t})),(0,i.isReply)(e)||f.setDefault("annotationPrivacy",t)},_=(0,c.applyTheme)(["ctaTextColor","ctaBackgroundColor"],a),b=(0,d.jsx)("div",{className:"annotation-publish-button__menu-label",style:_,children:(0,d.jsx)(r.SvgIcon,{name:"expand-menu",className:"u-icon--small"})});return(0,d.jsxs)("div",{className:"AnnotationPublishControl",children:[(0,d.jsxs)("div",{className:"annotation-publish-button",children:[(0,d.jsxs)(r.LabeledButton,{className:"PublishControlButton",style:_,onClick:n,disabled:t,size:"large",variant:"primary",children:["Post to ",v]}),(0,d.jsx)("div",{className:"annotation-publish-button__menu-wrapper",style:_,children:(0,d.jsxs)(l.default,{arrowClass:"annotation-publish-button__menu-arrow",containerPositioned:!1,contentClass:"annotation-publish-button__menu-content",label:b,menuIndicator:!1,title:"Change annotation sharing setting",align:"left",children:[(0,d.jsx)(u.default,{icon:"open"===m.type?"public":"groups",label:m.name,isSelected:!g,onClick:()=>y("shared")}),(0,d.jsx)(u.default,{icon:"lock",label:"Only Me",isSelected:g,onClick:()=>y("private")})]})})]}),(0,d.jsx)("div",{children:(0,d.jsx)(r.LabeledButton,{icon:"cancel",onClick:()=>{f.removeDraft(e),(0,i.isNew)(e)&&f.removeAnnotations([e])},size:"large",children:"Cancel"})})]})}),["settings"]);n.default=g},{"../../helpers/annotation-metadata":164,"../../helpers/permissions":172,"../../helpers/theme":175,"../../service-context":188,"../../store/use-store":227,"../Menu":125,"../MenuItem":126,"@hypothesis/frontend-shared":18,"preact/jsx-runtime":28}],102:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=l(e("classnames")),o=e("../../helpers/annotation-metadata"),i=e("../../service-context"),s=e("../../helpers/theme"),a=l(e("../Excerpt")),c=e("preact/jsx-runtime");function l(e){return e&&e.__esModule?e:{default:e}}var u=(0,i.withServices)((function({annotation:e,isFocused:t,settings:n={}}){return(0,c.jsx)("div",{className:(0,r.default)("AnnotationQuote",{"is-orphan":(0,o.isOrphan)(e)}),children:(0,c.jsx)(a.default,{collapsedHeight:35,inlineControls:!0,overflowThreshold:20,children:(0,c.jsx)("blockquote",{className:(0,r.default)("AnnotationQuote__quote",{"is-focused":t}),dir:"auto",lang:"",style:(0,s.applyTheme)(["selectionFontFamily"],n),children:(0,o.quote)(e)})})})}),["settings"]);n.default=u},{"../../helpers/annotation-metadata":164,"../../helpers/theme":175,"../../service-context":188,"../Excerpt":111,classnames:19,"preact/jsx-runtime":28}],103:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@hypothesis/frontend-shared"),o=e("preact/jsx-runtime");var i=function({onToggleReplies:e,replyCount:t,threadIsCollapsed:n}){const i=`${n?"Show replies":"Hide replies"} (${t})`;return(0,o.jsx)(r.LinkButton,{onClick:e,title:i,children:i})};n.default=i},{"@hypothesis/frontend-shared":18,"preact/jsx-runtime":28}],104:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,o=e("@hypothesis/frontend-shared"),i=e("preact/hooks"),s=e("../../helpers/annotation-sharing"),a=e("../../util/copy-to-clipboard"),c=e("../../helpers/permissions"),l=e("../../service-context"),u=e("../../../shared/user-agent"),d=(r=e("../ShareLinks"))&&r.__esModule?r:{default:r},f=e("preact/jsx-runtime");var p=(0,l.withServices)((function({annotation:e,toastMessenger:t,group:n,shareUri:r}){const l=(0,c.isPrivate)(e.permissions),p=(0,s.isShareableURI)(e.uri),h=(0,i.useRef)(null),m=(0,i.useRef)(null),[g,v]=(0,i.useState)(!1),y=(0,i.useRef)(g);if((0,o.useElementShouldClose)(h,g,(()=>v(!1))),(0,i.useEffect)((()=>{var e,t;y.current!==g&&(y.current=g,g&&!(0,u.isIOS)()&&(null===(e=m.current)||void 0===e||e.focus(),null===(t=m.current)||void 0===t||t.select()))}),[g]),!n)return null;const _=p,b="private"===n.type?(0,f.jsxs)("span",{children:["Only members of the group ",(0,f.jsx)("em",{children:n.name})," may view this annotation."]}):(0,f.jsx)("span",{children:"Anyone using this link may view this annotation."}),j=l?(0,f.jsx)("span",{children:"Only you may view this annotation."}):b;return(0,f.jsxs)("div",{className:"AnnotationShareControl",ref:h,children:[(0,f.jsx)(o.IconButton,{icon:"share",title:"Share",onClick:()=>v(!g),expanded:g}),g&&(0,f.jsxs)("div",{className:"annotation-share-panel",children:[(0,f.jsx)("div",{className:"annotation-share-panel__header",children:(0,f.jsx)("div",{className:"annotation-share-panel__title",children:"Share this annotation"})}),(0,f.jsxs)("div",{className:"annotation-share-panel__content",children:[(0,f.jsxs)("div",{className:"u-layout-row",children:[(0,f.jsx)("input",{"aria-label":"Use this URL to share this annotation",className:"annotation-share-panel__form-input",type:"text",value:r,readOnly:!0,ref:m}),(0,f.jsx)(o.IconButton,{className:"InputButton",icon:"copy",title:"Copy share link to clipboard",onClick:()=>{try{(0,a.copyText)(r),t.success("Copied share link to clipboard")}catch(e){t.error("Unable to copy link")}},size:"small"})]}),p?(0,f.jsx)("div",{className:"annotation-share-panel__details",children:j}):(0,f.jsx)("div",{className:"annotation-share-panel__details",children:"This annotation cannot be shared in its original context because it was made on a document that is not available on the web. This link shares the annotation by itself."}),_&&(0,f.jsx)(d.default,{shareURI:r})]}),(0,f.jsx)(o.SvgIcon,{name:"pointer",inline:!0,className:"annotation-share-panel__arrow"})]})]})}),["toastMessenger"]);n.default=p},{"../../../shared/user-agent":92,"../../helpers/annotation-sharing":165,"../../helpers/permissions":172,"../../service-context":188,"../../util/copy-to-clipboard":230,"../ShareLinks":138,"@hypothesis/frontend-shared":18,"preact/hooks":27,"preact/jsx-runtime":28}],105:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@hypothesis/frontend-shared"),o=e("../../store/use-store"),i=e("../../helpers/permissions"),s=e("preact/jsx-runtime");var a=function({annotation:e}){const t=(0,o.useStoreProxy)().getGroup(e.group),n=null==t?void 0:t.links.html,a=(0,i.isPrivate)(e.permissions);return(0,s.jsxs)("div",{className:"AnnotationShareInfo u-layout-row--align-baseline",children:[t&&n&&(0,s.jsxs)("a",{className:"u-layout-row--align-baseline u-color-text--muted",href:t.links.html,target:"_blank",rel:"noopener noreferrer",children:["open"===t.type?(0,s.jsx)(r.SvgIcon,{className:"AnnotationShareInfo__icon",name:"public"}):(0,s.jsx)(r.SvgIcon,{className:"AnnotationShareInfo__icon",name:"groups"}),(0,s.jsx)("span",{className:"AnnotationShareInfo__group-info",children:t.name})]}),a&&!n&&(0,s.jsx)("span",{className:"u-layout-row--align-baseline u-color-text--muted",children:(0,s.jsx)("span",{className:"AnnotationShareInfo__private-info",children:"Only me"})})]})};n.default=a},{"../../helpers/permissions":172,"../../store/use-store":227,"@hypothesis/frontend-shared":18,"preact/jsx-runtime":28}],106:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({annotationCreated:e,annotationUpdated:t,annotationUrl:n,withEditedTimestamp:s}){const[a,c]=(0,r.useState)((()=>new Date)),l=(0,r.useMemo)((()=>new Date(e)),[e]),u=(0,r.useMemo)((()=>s&&new Date(t)),[t,s]),d=(0,r.useMemo)((()=>({absolute:(0,o.formatDate)(l),relative:(0,o.formatRelativeDate)(l,a)})),[l,a]),f=(0,r.useMemo)((()=>u?{absolute:(0,o.formatDate)(u),relative:(0,o.formatRelativeDate)(u,a)}:{}),[u,a]);(0,r.useEffect)((()=>{const n=u?t:e;return(0,o.decayingInterval)(n,(()=>c(new Date)))}),[e,t,l,u,a]);const p=f&&f.relative!==d.relative?`edited ${f.relative}`:"edited";return(0,i.jsxs)("div",{className:"AnnotationTimestamps",children:[s&&(0,i.jsxs)("span",{className:"AnnotationTimestamps__timestamp AnnotationTimestamps__edited",title:f.absolute,children:["(",p,")"," "]}),n?(0,i.jsx)("a",{className:"AnnotationTimestamps__timestamp AnnotationTimestamps__timestamp--linked",target:"_blank",rel:"noopener noreferrer",title:d.absolute,href:n,children:d.relative}):(0,i.jsx)("span",{className:"AnnotationTimestamps__timestamp AnnotationTimestamps__created",title:d.absolute,children:d.relative})]})};var r=e("preact/hooks"),o=e("../../util/time"),i=e("preact/jsx-runtime")},{"../../util/time":244,"preact/hooks":27,"preact/jsx-runtime":28}],107:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact/jsx-runtime");var o=function({authorLink:e,displayName:t}){return e?(0,r.jsx)("div",{className:"AnnotationUser",children:(0,r.jsx)("a",{className:"AnnotationUser__link",href:e,target:"_blank",rel:"noopener noreferrer",children:(0,r.jsx)("h3",{className:"AnnotationUser__user-name",children:t})})}):(0,r.jsx)("div",{className:"AnnotationUser",children:(0,r.jsx)("h3",{className:"AnnotationUser__user-name",children:t})})};n.default=o},{"preact/jsx-runtime":28}],108:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return o.default}});var r,o=(r=e("./Annotation"))&&r.__esModule?r:{default:r}},{"./Annotation":94}],109:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact/hooks"),o=e("../store/use-store"),i=e("../service-context"),s=u(e("./hooks/use-root-thread")),a=u(e("./ThreadList")),c=u(e("./SidebarContentError")),l=e("preact/jsx-runtime");function u(e){return e&&e.__esModule?e:{default:e}}var d=(0,i.withServices)((function({loadAnnotationsService:e,onLogin:t}){const n=(0,o.useStoreProxy)(),i=n.routeParams().id,u=(0,s.default)(),d=n.profile().userid,[f,p]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{p(!1),n.clearAnnotations(),e.loadThread(i).then((e=>{const t=e.filter((e=>0===(e.references||[]).length))[0];t&&(e.forEach((e=>n.setExpanded(e.id,!0))),t.id!==i&&n.highlightAnnotations([i]))})).catch((()=>{p(!0)}))}),[i,d,e,n]),(0,l.jsxs)(l.Fragment,{children:[f&&(0,l.jsx)(c.default,{errorType:"annotation",onLoginRequest:t}),(0,l.jsx)(a.default,{threads:u.children})]})}),["loadAnnotationsService"]);n.default=d},{"../service-context":188,"../store/use-store":227,"./SidebarContentError":139,"./ThreadList":150,"./hooks/use-root-thread":157,"preact/hooks":27,"preact/jsx-runtime":28}],110:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({activeItem:e=-1,id:t,itemPrefixId:n,list:r,listFormatter:a=u,onSelectItem:l,open:d=!1}){const f=(0,i.useMemo)((()=>r.map(((t,r)=>{const i=n?{id:`${n}${r}`}:{};return(0,s.jsx)("li",c(c({role:"option","aria-selected":(e===r).toString(),className:(0,o.default)({"is-selected":e===r},"AutocompleteList__li"),onClick:()=>{l(t)}},i),{},{children:a(t,r)}),`AutocompleteList-${r}`)}))),[e,n,r,a,l]),p=t?{id:t}:{},h=0===r.length||!d;return(0,s.jsx)("div",{className:(0,o.default)({"is-hidden":h},"AutocompleteList"),children:(0,s.jsx)("ul",c(c({className:"AutocompleteList__items",tabIndex:-1,"aria-label":"Suggestions",role:"listbox"},p),{},{children:f}))})};var r,o=(r=e("classnames"))&&r.__esModule?r:{default:r},i=e("preact/hooks"),s=e("preact/jsx-runtime");function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const u=e=>e},{classnames:19,"preact/hooks":27,"preact/jsx-runtime":28}],111:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@hypothesis/frontend-shared"),o=u(e("classnames")),i=e("preact/hooks"),s=u(e("../util/observe-element-size")),a=e("../service-context"),c=e("../helpers/theme"),l=e("preact/jsx-runtime");function u(e){return e&&e.__esModule?e:{default:e}}function d({isCollapsed:e,setCollapsed:t,linkStyle:n={}}){const o=e?"More":"Less";return(0,l.jsx)("div",{className:"Excerpt__inline-controls",children:(0,l.jsx)("div",{className:"Excerpt__toggle-container",children:(0,l.jsx)(r.LinkButton,{className:"InlineLinkButton",onClick:()=>t(!e),expanded:!e,title:"Toggle visibility of full excerpt text",style:n,variant:"dark",children:o})})})}const f=()=>{};var p=(0,a.withServices)((function({children:e,collapse:t=!1,collapsedHeight:n,inlineControls:r=!0,onCollapsibleChanged:a=f,onToggleCollapsed:u=f,overflowThreshold:p=0,settings:h={}}){const[m,g]=(0,i.useState)(!0),v=(0,i.useRef)(null),[y,_]=(0,i.useState)(0),b=(0,i.useCallback)((()=>{const e=v.current.clientHeight;_(e),a(e>n+p)}),[n,a,p]);(0,i.useLayoutEffect)((()=>{const e=(0,s.default)(v.current,b);return b(),e}),[b]);const j=y>n+p,w=j&&(r?m:t),x={};0!==y&&(x["max-height"]=w?n:y);const O=e=>r?g(e):u(e);return(0,l.jsxs)("div",{className:"Excerpt",style:x,children:[(0,l.jsx)("div",{className:"Excerpt__content",ref:v,children:e}),(0,l.jsx)("div",{role:"presentation",onClick:()=>O(!1),className:(0,o.default)({Excerpt__shadow:!0,"Excerpt__shadow--transparent":r,"is-hidden":!w}),title:"Show the full excerpt"}),j&&r&&(0,l.jsx)(d,{isCollapsed:m,setCollapsed:O,linkStyle:(0,c.applyTheme)(["selectionFontFamily"],h)})]})}),["settings"]);n.default=p},{"../helpers/theme":175,"../service-context":188,"../util/observe-element-size":237,"@hypothesis/frontend-shared":18,classnames:19,"preact/hooks":27,"preact/jsx-runtime":28}],112:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@hypothesis/frontend-shared"),o=a(e("./Menu")),i=a(e("./MenuItem")),s=e("preact/jsx-runtime");function a(e){return e&&e.__esModule?e:{default:e}}var c=function({defaultOption:e,icon:t,onSelect:n,options:a,selectedOption:c,title:l}){const u=[e,...a],d=null!=c?c:e,f=(0,s.jsxs)("span",{className:"FilterSelect__menu-label",children:[t&&(0,s.jsx)(r.SvgIcon,{name:t,className:"FilterSelect__menu-icon"}),d.display]});return(0,s.jsx)(o.default,{label:f,title:l,contentClass:"FilterSelect__menu",children:u.map((e=>(0,s.jsx)(i.default,{onClick:()=>n(e),isSelected:e.value===d.value,label:e.display},e.value)))})};n.default=c},{"./Menu":125,"./MenuItem":126,"@hypothesis/frontend-shared":18,"preact/jsx-runtime":28}],113:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){const e=(0,c.default)(),t=(0,a.useStoreProxy)(),n=t.focusState(),r=t.forcedVisibleThreads().length,o=t.filterQuery(),s=t.selectedAnnotations().length,u=(0,i.useMemo)((()=>({filterQuery:o,focusActive:n.active,focusConfigured:n.configured,focusDisplayName:n.displayName,forcedVisibleCount:r,selectedCount:s})),[n,r,o,s]);return u.selectedCount>0?(0,l.jsx)(h,{filterState:u,rootThread:e}):u.filterQuery?(0,l.jsx)(m,{filterState:u,rootThread:e}):u.focusConfigured?(0,l.jsx)(g,{filterState:u,rootThread:e}):null};var r,o=e("@hypothesis/frontend-shared"),i=e("preact/hooks"),s=e("../helpers/thread"),a=e("../store/use-store"),c=(r=e("./hooks/use-root-thread"))&&r.__esModule?r:{default:r},l=e("preact/jsx-runtime");function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p({actionButton:e,additionalCount:t=0,entitySingular:n="annotation",entityPlural:r="annotations",filterQuery:o,focusDisplayName:i,resultCount:s}){return(0,l.jsx)("div",{className:"FilterStatus",children:(0,l.jsxs)("div",{className:"u-layout-row--align-center",children:[(0,l.jsxs)("div",{className:"FilterStatus__text",children:[s>0&&(0,l.jsx)("span",{children:"Showing "}),(0,l.jsxs)("span",{className:"filter-facet",children:[s>0?s:"No"," ",1===s?n:r]}),o&&(0,l.jsxs)("span",{children:[" ","for"," ",(0,l.jsxs)("span",{className:"filter-facet--pre",children:["'",o,"'"]})]}),i&&(0,l.jsxs)("span",{children:[" ","by ",(0,l.jsx)("span",{className:"filter-facet",children:i})]}),t>0&&(0,l.jsxs)("span",{className:"filter-facet--muted",children:[" ","(and ",t," more)"]})]}),(0,l.jsx)("div",{children:e})]})})}function h({filterState:e,rootThread:t}){const n=(0,a.useStoreProxy)(),r=n.directLinkedAnnotationId(),i=n.annotationCount(),s=(t.children||[]).filter((e=>e.annotation&&e.visible)).length-e.selectedCount,c=e.focusConfigured||r?"Show all":`Show all (${i})`,u=(0,l.jsx)(o.LabeledButton,{title:c,variant:"primary",onClick:()=>n.clearSelection(),icon:"cancel",children:c});return(0,l.jsx)(p,{resultCount:e.selectedCount,additionalCount:s,actionButton:u})}function m({filterState:e,rootThread:t}){const n=(0,a.useStoreProxy)(),r=(0,s.countVisible)(t)-e.forcedVisibleCount,i=(0,l.jsx)(o.LabeledButton,{icon:"cancel",variant:"primary",title:"Clear search",onClick:()=>n.clearSelection(),children:"Clear search"});return(0,l.jsx)(p,{actionButton:i,additionalCount:e.forcedVisibleCount,entitySingular:"result",entityPlural:"results",filterQuery:e.filterQuery,focusDisplayName:e.focusDisplayName,resultCount:r})}function g({filterState:e,rootThread:t}){const n=(0,a.useStoreProxy)(),r=(0,s.countVisible)(t)-e.forcedVisibleCount,i={};e.forcedVisibleCount>0?(i.onClick=()=>n.clearSelection(),i.title="Reset filters"):(i.onClick=()=>n.toggleFocusMode(),i.title=e.focusActive?"Show all":`Show only ${e.focusDisplayName}`);const c=e.focusActive?e.focusDisplayName:"",u=(0,l.jsx)(o.LabeledButton,d(d({variant:"primary"},i),{},{children:i.title}));return(0,l.jsx)(p,{resultCount:r,actionButton:u,additionalCount:e.forcedVisibleCount,filterQuery:e.filterQuery,focusDisplayName:c})}},{"../helpers/thread":178,"../store/use-store":227,"./hooks/use-root-thread":157,"@hypothesis/frontend-shared":18,"preact/hooks":27,"preact/jsx-runtime":28}],114:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact/hooks"),o=e("../../config/service-config"),i=e("../../helpers/account-id"),s=e("../../helpers/group-list-item-common"),a=m(e("../../helpers/group-organizations")),c=e("../../helpers/is-third-party-service"),l=e("../../service-context"),u=e("../../store/use-store"),d=m(e("../Menu")),f=m(e("../MenuItem")),p=m(e("./GroupListSection")),h=e("preact/jsx-runtime");function m(e){return e&&e.__esModule?e:{default:e}}var g=(0,l.withServices)((function({settings:e}){const t=(0,u.useStoreProxy)(),n=t.getCurrentlyViewingGroups(),l=t.getFeaturedGroups(),m=t.getMyGroups(),g=t.focusedGroup(),v=t.profile().userid,y=(0,r.useMemo)((()=>(0,a.default)(m)),[m]),_=(0,r.useMemo)((()=>(0,a.default)(l)),[l]),b=(0,r.useMemo)((()=>(0,a.default)(n)),[n]),j=t.defaultAuthority(),w=v&&!(0,i.isThirdPartyUser)(v,j),x=t.getLink("groups.new"),[O,S]=(0,r.useState)(null);let k;if(g){const t=g.organization.logo||function(e){const t=(0,o.serviceConfig)(e);return t&&t.icon?t.icon:null}(e)||"",n=(0,s.orgName)(g)?(0,s.orgName)(g):"";k=(0,h.jsxs)("span",{className:"GroupList__menu-label",children:[t&&(0,h.jsx)("img",{className:"GroupList__menu-icon",src:t,alt:n}),g.name]})}else k=(0,h.jsx)("span",{children:"…"});if((0,c.isThirdPartyService)(e)&&n.length+l.length+m.length<2)return k;const P=g?`Select group (now viewing: ${g.name})`:"Select group";return(0,h.jsxs)(d.default,{align:"left",contentClass:"GroupList__content",label:k,onOpenChanged:()=>S(null),title:P,children:[b.length>0&&(0,h.jsx)(p.default,{expandedGroup:O,onExpandGroup:S,heading:"Currently Viewing",groups:b}),_.length>0&&(0,h.jsx)(p.default,{expandedGroup:O,onExpandGroup:S,heading:"Featured Groups",groups:_}),y.length>0&&(0,h.jsx)(p.default,{expandedGroup:O,onExpandGroup:S,heading:"My Groups",groups:y}),w&&(0,h.jsx)(f.default,{icon:"add",href:x,label:"New private group"})]})}),["settings"]);n.default=g},{"../../config/service-config":161,"../../helpers/account-id":163,"../../helpers/group-list-item-common":168,"../../helpers/group-organizations":169,"../../helpers/is-third-party-service":171,"../../service-context":188,"../../store/use-store":227,"../Menu":125,"../MenuItem":126,"./GroupListSection":116,"preact/hooks":27,"preact/jsx-runtime":28}],115:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,o=e("../../helpers/group-list-item-common"),i=e("../../service-context"),s=e("../../store/use-store"),a=e("../../util/copy-to-clipboard"),c=e("../../../shared/prompts"),l=(r=e("../MenuItem"))&&r.__esModule?r:{default:r},u=e("preact/jsx-runtime");var d=(0,i.withServices)((function({isExpanded:e,group:t,groups:n,onExpand:r,toastMessenger:i}){const d=t.links.html,f=d||t.canLeave,p=t.scopes&&!t.scopes.enforced||t.isScopedToUri,h=(0,s.useStoreProxy)(),m=h.focusedGroupId(),g=t.id===m,v=t=>{t.stopPropagation(),t.preventDefault(),r(!e)},y="private"===t.type?"Copy invite link":"Copy activity link";return(0,u.jsx)(l.default,{icon:t.logo||"blank",iconAlt:(0,o.orgName)(t),isDisabled:!p,isExpanded:!!f&&e,isSelected:g,isSubmenuVisible:f?e:void 0,label:t.name,onClick:p?()=>{h.clearDirectLinkedGroupFetchFailed(),h.clearDirectLinkedIds(),n.focus(t.id)}:v,onToggleSubmenu:v,submenu:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("ul",{children:[d&&(0,u.jsx)("li",{children:(0,u.jsx)(l.default,{href:d,icon:"external",isSubmenuItem:!0,label:"View group activity"})}),d&&(0,u.jsx)("li",{children:(0,u.jsx)(l.default,{onClick:()=>(e=>{try{(0,a.copyText)(e),i.success(`Copied link for "${t.name}"`)}catch(n){i.error("Unable to copy link")}})(d),icon:"copy",isSubmenuItem:!0,label:y})}),t.canLeave&&(0,u.jsx)("li",{children:(0,u.jsx)(l.default,{icon:"leave",isSubmenuItem:!0,label:"Leave group",onClick:async()=>{const e=`Are you sure you want to leave the group "${t.name}"?`;await(0,c.confirm)({title:"Leave group?",message:e,confirmAction:"Leave"})&&n.leave(t.id)}})})]}),!p&&(0,u.jsx)("p",{className:"GroupListItem__footer",children:"This group is restricted to specific URLs."})]})})}),["groups","toastMessenger"]);n.default=d},{"../../../shared/prompts":89,"../../helpers/group-list-item-common":168,"../../service-context":188,"../../store/use-store":227,"../../util/copy-to-clipboard":230,"../MenuItem":126,"preact/jsx-runtime":28}],116:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({expandedGroup:e,onExpandGroup:t,groups:n,heading:s}){return(0,i.jsx)(r.default,{heading:s,children:n.map((n=>(0,i.jsx)(o.default,{isExpanded:n===e,onExpand:e=>t(e?n:null),group:n},n.id)))})};var r=s(e("../MenuSection")),o=s(e("./GroupListItem")),i=e("preact/jsx-runtime");function s(e){return e&&e.__esModule?e:{default:e}}},{"../MenuSection":128,"./GroupListItem":115,"preact/jsx-runtime":28}],117:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return o.default}});var r,o=(r=e("./GroupList"))&&r.__esModule?r:{default:r}},{"./GroupList":114}],118:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@hypothesis/frontend-shared"),o=e("preact/hooks"),i=e("../store/use-store"),s=e("../service-context"),a=f(e("../helpers/version-data")),c=f(e("./SidebarPanel")),l=f(e("./Tutorial")),u=f(e("./VersionInfo")),d=e("preact/jsx-runtime");function f(e){return e&&e.__esModule?e:{default:e}}function p({linkText:e,url:t}){return(0,d.jsx)("div",{className:"HelpPanel-tabs__tab",children:(0,d.jsxs)("a",{href:t,className:"HelpPanel-tabs__link",target:"_blank",rel:"noopener noreferrer",children:[e," ",(0,d.jsx)(r.SvgIcon,{name:"external",className:"HelpPanel-tabs__icon",inline:!0})]})})}var h=(0,s.withServices)((function({auth:e,session:t}){const n=(0,i.useStoreProxy)(),s=n.mainFrame(),f=!!n.profile().preferences.show_sidebar_tutorial,[h,m]=(0,o.useState)("tutorial"),g=(0,o.useMemo)((()=>{const t=e||{status:"logged-out"},n=s||{};return new a.default(t,n)}),[e,s]),v=`https://web.hypothes.is/get-help/?sys_info=${g.asEncodedURLString()}`,y=(e,t)=>{e.preventDefault(),m(t)},_=(0,o.useCallback)((e=>{!e&&f&&t.dismissSidebarTutorial()}),[t,f]);return(0,d.jsx)(c.default,{title:"Help",panelName:"help",onActiveChanged:_,children:(0,d.jsxs)("div",{className:"HelpPanel__content u-vertical-rhythm",children:[(0,d.jsxs)("div",{className:"u-layout-row--align-middle",children:[(0,d.jsx)("h3",{className:"HelpPanel__sub-panel-title",children:{tutorial:"Getting started",versionInfo:"About this version"}[h]}),(0,d.jsxs)("div",{children:["versionInfo"===h&&(0,d.jsxs)("button",{className:"HelpPanel__sub-panel-navigation-button",onClick:e=>y(e,"tutorial"),"aria-label":"Show tutorial panel",children:["Getting started",(0,d.jsx)(r.SvgIcon,{name:"arrow-right",className:"HelpPanel__sub-panel-link-icon"})]}),"tutorial"===h&&(0,d.jsxs)("button",{className:"HelpPanel__sub-panel-navigation-button",onClick:e=>y(e,"versionInfo"),"aria-label":"Show version information panel",children:["About this version",(0,d.jsx)(r.SvgIcon,{name:"arrow-right"})]})]})]}),(0,d.jsxs)("div",{className:"HelpPanel__subcontent",children:["tutorial"===h&&(0,d.jsx)(l.default,{}),"versionInfo"===h&&(0,d.jsx)(u.default,{versionData:g})]}),(0,d.jsxs)("div",{className:"HelpPanel-tabs",children:[(0,d.jsx)(p,{linkText:"Help topics",url:"https://web.hypothes.is/help/"}),(0,d.jsx)(p,{linkText:"New support ticket",url:v})]})]})})}),["session"]);n.default=h},{"../helpers/version-data":179,"../service-context":188,"../store/use-store":227,"./SidebarPanel":140,"./Tutorial":153,"./VersionInfo":155,"@hypothesis/frontend-shared":18,"preact/hooks":27,"preact/jsx-runtime":28}],119:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=w(e("classnames")),o=e("preact/hooks"),i=w(e("../../shared/bridge-events")),s=e("../../shared/prompts"),a=e("../config/service-config"),c=e("../store/use-store"),l=e("../helpers/account-id"),u=e("../helpers/session"),d=e("../helpers/theme"),f=e("../service-context"),p=w(e("./AnnotationView")),h=w(e("./SidebarView")),m=w(e("./StreamView")),g=w(e("./HelpPanel")),v=w(e("./NotebookView")),y=w(e("./ShareAnnotationsPanel")),_=w(e("./ToastMessages")),b=w(e("./TopBar")),j=e("preact/jsx-runtime");function w(e){return e&&e.__esModule?e:{default:e}}var x=(0,f.withServices)((function({auth:e,bridge:t,settings:n,session:f,toastMessenger:w}){const x=(0,c.useStoreProxy)(),O=x.hasFetchedProfile(),S=x.profile(),k=x.route(),P=(0,o.useMemo)((()=>O?function(e){const t=(0,l.parseAccountID)(e.userid);if(t&&e.userid){let n=t.username;return e.user_info&&e.user_info.display_name&&(n=e.user_info.display_name),{status:"logged-in",displayName:n,userid:e.userid,username:t.username}}return{status:"logged-out"}}(S):{status:"unknown"}),[O,S]),E=(0,o.useMemo)((()=>(0,d.applyTheme)(["appBackgroundColor"],n)),[n]),A="clean"===n.theme,N="sidebar"===k;(0,o.useEffect)((()=>{(0,u.shouldAutoDisplayTutorial)(N,S,n)&&x.openSidebarPanel("help")}),[N,S,n,x]);const T=async()=>{if((0,a.serviceConfig)(n))t.call(i.default.LOGIN_REQUESTED);else try{await e.login(),x.closeSidebarPanel("loginPrompt"),x.clearGroups(),f.reload()}catch(O){w.error(O.message)}},C=()=>{(0,a.serviceConfig)(n)?t.call(i.default.SIGNUP_REQUESTED):window.open(x.getLink("signup"))};return(0,j.jsxs)("div",{className:(0,r.default)("HypothesisApp","js-thread-list-scroll-root",{"theme-clean":A,"HypothesisApp--notebook":"notebook"===k}),style:E,children:["notebook"!==k&&(0,j.jsx)(b.default,{auth:P,onLogin:T,onSignUp:C,onLogout:async()=>{await(async()=>{const e=x.countDrafts();if(0===e)return!0;let t="";return 1===e?t="You have an unsaved annotation.\nDo you really want to discard this draft?":e>1&&(t="You have "+e+" unsaved annotations.\nDo you really want to discard these drafts?"),(0,s.confirm)({title:"Discard drafts?",message:t,confirmAction:"Discard"})})()&&(x.clearGroups(),x.removeAnnotations(x.unsavedAnnotations()),x.discardAllDrafts(),(0,a.serviceConfig)(n)?t.call(i.default.LOGOUT_REQUESTED):f.logout())},isSidebar:N}),(0,j.jsxs)("div",{className:"HypothesisApp__content",children:[(0,j.jsx)(_.default,{}),(0,j.jsx)(g.default,{auth:"logged-in"===P.status?P:{}}),(0,j.jsx)(y.default,{}),k&&(0,j.jsxs)("main",{children:["annotation"===k&&(0,j.jsx)(p.default,{onLogin:T}),"notebook"===k&&(0,j.jsx)(v.default,{}),"stream"===k&&(0,j.jsx)(m.default,{}),"sidebar"===k&&(0,j.jsx)(h.default,{onLogin:T,onSignUp:C})]})]})]})}),["auth","bridge","session","settings","toastMessenger"]);n.default=x},{"../../shared/bridge-events":85,"../../shared/prompts":89,"../config/service-config":161,"../helpers/account-id":163,"../helpers/session":173,"../helpers/theme":175,"../service-context":188,"../store/use-store":227,"./AnnotationView":109,"./HelpPanel":118,"./NotebookView":132,"./ShareAnnotationsPanel":137,"./SidebarView":141,"./StreamView":145,"./ToastMessages":151,"./TopBar":152,classnames:19,"preact/hooks":27,"preact/jsx-runtime":28}],120:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({error:e}){return(0,o.jsx)("div",{className:"LaunchErrorPanel",children:(0,o.jsx)(r.Panel,{title:"Unable to start Hypothesis",children:e.message})})};var r=e("@hypothesis/frontend-shared"),o=e("preact/jsx-runtime")},{"@hypothesis/frontend-shared":18,"preact/jsx-runtime":28}],121:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@hypothesis/frontend-shared"),o=e("../store/use-store"),i=e("preact/jsx-runtime");var s=function({onLogin:e}){const t=(0,o.useStoreProxy)();return(0,i.jsxs)("div",{className:"LoggedOutMessage",children:[(0,i.jsxs)("span",{children:["This is a public annotation created with Hypothesis. ",(0,i.jsx)("br",{}),"To reply or make your own annotations on this document,"," ",(0,i.jsx)("a",{className:"LoggedOutMessage__link",href:t.getLink("signup"),target:"_blank",rel:"noopener noreferrer",children:"create a free account"})," ","or"," ",(0,i.jsx)(r.LinkButton,{className:"InlineLinkButton",onClick:e,variant:"dark",children:"log in"}),"."]}),(0,i.jsx)("div",{className:"LoggedOutMessage__logo",children:(0,i.jsx)("a",{href:"https://hypothes.is","aria-label":"Hypothesis homepage",title:"Hypothesis homepage",children:(0,i.jsx)(r.SvgIcon,{name:"logo",className:"LoggedOutMessage__logo-icon"})})})]})};n.default=s},{"../store/use-store":227,"@hypothesis/frontend-shared":18,"preact/jsx-runtime":28}],122:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({onLogin:e,onSignUp:t}){return(0,i.useStoreProxy)().isLoggedIn()?null:(0,a.jsxs)(s.default,{icon:"restricted",title:"Login needed",panelName:"loginPrompt",children:[(0,a.jsx)("p",{children:"Please log in to create annotations or highlights."}),(0,a.jsxs)(o.Actions,{children:[(0,a.jsx)(o.LabeledButton,{title:"Sign up",onClick:t,children:"Sign up"}),(0,a.jsx)(o.LabeledButton,{title:"Log in",variant:"primary",onClick:e,children:"Log in"})]})]})};var r,o=e("@hypothesis/frontend-shared"),i=e("../store/use-store"),s=(r=e("./SidebarPanel"))&&r.__esModule?r:{default:r},a=e("preact/jsx-runtime")},{"../store/use-store":227,"./SidebarPanel":140,"@hypothesis/frontend-shared":18,"preact/jsx-runtime":28}],123:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({label:e="",onEditText:t=(()=>{}),text:n="",textStyle:r={}}){const[i,c]=(0,s.useState)(!1),d=(0,s.useRef)(null);(0,s.useEffect)((()=>{i||d.current.focus()}),[i]);const p=e=>{const n=d.current;(function(e,t){const n=e=>{const n=e({text:t.value,selectionStart:t.selectionStart,selectionEnd:t.selectionEnd});t.value=n.text,t.selectionStart=n.selectionStart,t.selectionEnd=n.selectionEnd,t.focus()},r=e=>{const t=e.text.slice(0,e.selectionStart);return 0===t.length||"\n"===t.slice(-1)||"$$"===t.slice(-2)?(0,a.toggleSpanStyle)(e,"$$","$$","Insert LaTeX"):(0,a.toggleSpanStyle)(e,"\\(","\\)","Insert LaTeX")};switch(e){case"bold":n((e=>(0,a.toggleSpanStyle)(e,"**","**","Bold")));break;case"italic":n((e=>(0,a.toggleSpanStyle)(e,"*","*","Italic")));break;case"quote":n((e=>(0,a.toggleBlockStyle)(e,"> ")));break;case"link":n((e=>(0,a.convertSelectionToLink)(e)));break;case"image":n((e=>(0,a.convertSelectionToLink)(e,a.LinkType.IMAGE_LINK)));break;case"math":n(r);break;case"numlist":n((e=>(0,a.toggleBlockStyle)(e,"1. ")));break;case"list":n((e=>(0,a.toggleBlockStyle)(e,"* ")));break;default:throw new Error(`Unknown toolbar command "${e}"`)}})(e,n),t({text:n.value})};return(0,u.jsxs)("div",{className:"MarkdownEditor",children:[(0,u.jsx)(h,{onCommand:p,isPreviewing:i,onTogglePreview:()=>c(!i)}),i?(0,u.jsx)(l.default,{markdown:n,textClass:{MarkdownEditor__preview:!0},textStyle:r}):(0,u.jsx)("textarea",{"aria-label":e,className:"MarkdownEditor__input",dir:"auto",ref:d,onClick:e=>e.stopPropagation(),onKeyDown:e=>{if(e.ctrlKey||e.metaKey)for(let[t,n]of Object.entries(f))n===(0,o.normalizeKeyName)(e.key)&&(e.stopPropagation(),e.preventDefault(),p(t))},onInput:e=>{t({text:e.target.value})},value:n,style:r})]})};var r=d(e("classnames")),o=e("@hypothesis/frontend-shared"),i=e("preact"),s=e("preact/hooks"),a=e("../markdown-commands"),c=e("../../shared/user-agent"),l=d(e("./MarkdownView")),u=e("preact/jsx-runtime");function d(e){return e&&e.__esModule?e:{default:e}}const f={bold:"b",italic:"i",link:"l",quote:"q",image:"g",numlist:"o",list:"u"};function p({buttonRef:e,disabled:t=!1,iconName:n,label:i,onClick:a,shortcutKey:l,tabIndex:d,title:f=""}){const p=(0,s.useMemo)((()=>(0,c.isMacOS)()?"Cmd":"Ctrl"),[]);let h=f;return l&&(h+=` (${p}-${l.toUpperCase()})`),(0,u.jsxs)("button",{className:(0,r.default)("MarkdownEditor__toolbar-button",i&&"is-text"),disabled:t,onClick:a,"aria-label":h,title:h,tabIndex:d,ref:e,children:[n&&(0,u.jsx)(o.SvgIcon,{name:n,className:"MarkdownEditor__toolbar-button-icon"}),i]})}function h({isPreviewing:e,onCommand:t,onTogglePreview:n}){const[r,a]=(0,s.useState)(0),c=(0,s.useRef)([]).current;if(0===c.length)for(let o=0;o<=10;o++)c.push((0,i.createRef)());const l=e=>r===e?0:-1;return(0,u.jsxs)("div",{className:"MarkdownEditor__toolbar",role:"toolbar","aria-label":"Markdown editor toolbar",onKeyDown:t=>{let n=0;e&&(n=8);let i=null;switch((0,o.normalizeKeyName)(t.key)){case"ArrowLeft":i=r<=n?9:r-1;break;case"ArrowRight":i=r>=9?n:r+1;break;case"Home":i=n;break;case"End":i=9}var s;null!==i&&(a(s=i),c[s].current.focus(),t.preventDefault())},children:[(0,u.jsx)(p,{disabled:e,iconName:"format-bold",onClick:()=>t("bold"),shortcutKey:f.bold,buttonRef:c[0],tabIndex:l(0),title:"Bold"}),(0,u.jsx)(p,{disabled:e,iconName:"format-italic",onClick:()=>t("italic"),shortcutKey:f.italic,buttonRef:c[1],tabIndex:l(1),title:"Italic"}),(0,u.jsx)(p,{disabled:e,iconName:"format-quote",onClick:()=>t("quote"),shortcutKey:f.quote,buttonRef:c[2],tabIndex:l(2),title:"Quote"}),(0,u.jsx)(p,{disabled:e,iconName:"link",onClick:()=>t("link"),shortcutKey:f.link,buttonRef:c[3],tabIndex:l(3),title:"Insert link"}),(0,u.jsx)(p,{disabled:e,iconName:"image",onClick:()=>t("image"),shortcutKey:f.image,buttonRef:c[4],tabIndex:l(4),title:"Insert image"}),(0,u.jsx)(p,{disabled:e,iconName:"format-functions",onClick:()=>t("math"),buttonRef:c[5],tabIndex:l(5),title:"Insert math (LaTeX is supported)"}),(0,u.jsx)(p,{disabled:e,iconName:"format-list-numbered",onClick:()=>t("numlist"),shortcutKey:f.numlist,buttonRef:c[6],tabIndex:l(6),title:"Numbered list"}),(0,u.jsx)(p,{disabled:e,iconName:"format-list-unordered",onClick:()=>t("list"),shortcutKey:f.list,buttonRef:c[7],tabIndex:l(7),title:"Bulleted list"}),(0,u.jsx)("span",{className:"u-stretch"}),(0,u.jsx)("div",{className:"MarkdownEditor__toolbar-help-link",children:(0,u.jsx)("a",{href:"https://web.hypothes.is/help/formatting-annotations-with-markdown/",target:"_blank",rel:"noopener noreferrer",className:"MarkdownEditor__toolbar-button",ref:c[8],tabIndex:l(8),title:"Formatting help","aria-label":"Formatting help",children:(0,u.jsx)(o.SvgIcon,{name:"help",className:"MarkdownEditor__toolbar-button-icon"})})}),(0,u.jsx)(p,{label:e?"Write":"Preview",onClick:n,buttonRef:c[9],tabIndex:l(9)})]})}},{"../../shared/user-agent":92,"../markdown-commands":184,"./MarkdownView":124,"@hypothesis/frontend-shared":18,classnames:19,preact:26,"preact/hooks":27,"preact/jsx-runtime":28}],124:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({markdown:e="",textClass:t={},textStyle:n={}}){const c=(0,o.useMemo)((()=>e?(0,s.default)(e):""),[e]),l=(0,o.useRef)(null);return(0,o.useEffect)((()=>{(0,i.replaceLinksWithEmbeds)(l.current,{className:"MarkdownView__embed"})}),[e]),(0,a.jsx)("div",{className:(0,r.default)("MarkdownView",t),dir:"auto",lang:"",ref:l,dangerouslySetInnerHTML:{__html:c},style:n})};var r=c(e("classnames")),o=e("preact/hooks"),i=e("../media-embedder"),s=c(e("../render-markdown")),a=e("preact/jsx-runtime");function c(e){return e&&e.__esModule?e:{default:e}}},{"../media-embedder":185,"../render-markdown":186,classnames:19,"preact/hooks":27,"preact/jsx-runtime":28}],125:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({align:e="left",arrowClass:t="",children:n,containerPositioned:c=!0,contentClass:d,defaultOpen:f=!1,label:p,open:h,onOpenChanged:m,menuIndicator:g=!0,title:v}){let[y,_]=(0,i.useState)(f);"boolean"==typeof h&&(y=h,_=m||u);const b=(0,i.useRef)(y);(0,i.useEffect)((()=>{"function"==typeof m&&b.current!==y&&(b.current=y,m(y))}),[y,m]);const j=e=>{if("mousedown"===e.type)l=!0;else if("click"===e.type&&l)return l=!1,e.stopPropagation(),void e.preventDefault();_(!y)},w=(0,i.useCallback)((()=>_(!1)),[_]),x=(0,i.useRef)(null);(0,o.useElementShouldClose)(x,y,w);const O=e=>e.stopPropagation(),S={position:c?"relative":"static"};return(0,a.jsxs)("div",{className:"Menu",ref:x,style:S,onClick:O,onMouseDown:O,children:[(0,a.jsx)("button",{"aria-expanded":y?"true":"false","aria-haspopup":!0,className:"Menu__toggle",onMouseDown:j,onClick:j,"aria-label":v,title:v,children:(0,a.jsxs)("span",{className:"Menu__toggle-wrapper",children:[p,g&&(0,a.jsx)("span",{className:(0,r.default)("Menu__toggle-arrow",y&&"is-open"),children:(0,a.jsx)(o.SvgIcon,{name:"expand-menu",className:"Menu__toggle-icon"})})]})}),y&&(0,a.jsxs)(a.Fragment,{children:[(k=t,(0,a.jsx)("svg",{className:(0,r.default)("Menu__arrow",k),width:15,height:8,children:(0,a.jsx)("path",{d:"M0 8 L7 0 L15 8",stroke:"currentColor",strokeWidth:"2"})})),(0,a.jsx)("div",{className:(0,r.default)("Menu__content",`Menu__content--align-${e}`,d),role:"menu",tabIndex:-1,onClick:w,onKeyDown:e=>{const t=(0,o.normalizeKeyName)(e.key);"Enter"!==t&&" "!==t||setTimeout((()=>{w()}))},children:(0,a.jsx)(s.default,{visible:!0,children:n})})]})]});var k};var r=c(e("classnames")),o=e("@hypothesis/frontend-shared"),i=e("preact/hooks"),s=c(e("./MenuKeyboardNavigation")),a=e("preact/jsx-runtime");function c(e){return e&&e.__esModule?e:{default:e}}let l=!1;const u=()=>{}},{"./MenuKeyboardNavigation":127,"@hypothesis/frontend-shared":18,classnames:19,"preact/hooks":27,"preact/jsx-runtime":28}],126:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({href:e,icon:t,iconAlt:n,isDisabled:l,isExpanded:u,isSelected:d,isSubmenuItem:f,isSubmenuVisible:p,label:h,onClick:m,onToggleSubmenu:g,submenu:v}){const y=t&&-1!==t.indexOf("/"),_=t||f,b=t&&f,j=(0,i.useRef)(null);let w=null,x=null;t&&"blank"!==t&&(x=y?(0,c.jsx)("img",{className:"MenuItem__icon",alt:n,src:t}):(0,c.jsx)(o.SvgIcon,{name:t,className:"MenuItem__icon"}));const O=f?null:x,S=f?x:null;let k;const P="boolean"==typeof p,E="boolean"==typeof d;(0,i.useEffect)((()=>()=>{clearTimeout(w)}),[]);const A=e=>{switch((0,o.normalizeKeyName)(e.key)){case"ArrowRight":g&&(e.stopPropagation(),e.preventDefault(),g(e));break;case"Enter":case" ":m&&m(e)}};return k=e?(0,c.jsxs)("a",{ref:j,className:(0,r.default)("MenuItem",{"is-submenu":f,"is-disabled":l}),href:e,target:"_blank",tabIndex:-1,rel:"noopener noreferrer",role:"menuitem",onKeyDown:A,children:[_&&(0,c.jsx)("div",{className:"MenuItem__icon-container",children:O}),(0,c.jsx)("span",{className:"MenuItem__label",children:h}),b&&(0,c.jsx)("div",{className:"MenuItem__icon-container",children:S})]}):(0,c.jsxs)("div",{ref:j,className:(0,r.default)("MenuItem",{"is-submenu":f,"is-disabled":l,"is-expanded":u,"is-selected":d}),tabIndex:-1,onKeyDown:A,onClick:m,role:E?"menuitemradio":"menuitem","aria-checked":E?d:void 0,"aria-haspopup":P,"aria-expanded":P?p:void 0,children:[_&&(0,c.jsx)("div",{className:"MenuItem__icon-container",children:O}),(0,c.jsx)("span",{className:"MenuItem__label",children:h}),b&&(0,c.jsx)("div",{className:"MenuItem__icon-container",children:S}),P&&(0,c.jsx)("div",{role:"none",icon:p?"collapse-menu":"expand-menu",className:"MenuItem__toggle",onClick:g,title:`Show actions for ${h}`,children:(0,c.jsx)(o.SvgIcon,{name:p?"collapse-menu":"expand-menu",className:"MenuItem__toggle-icon"})})]}),(0,c.jsxs)(c.Fragment,{children:[k,P&&(0,c.jsx)(a.default,{visible:p,children:(0,c.jsx)(s.default,{closeMenu:e=>{g&&g(e),w=setTimeout((()=>{j.current.focus()}))},visible:p,className:"MenuItem__submenu",children:v})})]})};var r=l(e("classnames")),o=e("@hypothesis/frontend-shared"),i=e("preact/hooks"),s=l(e("./MenuKeyboardNavigation")),a=l(e("./Slider")),c=e("preact/jsx-runtime");function l(e){return e&&e.__esModule?e:{default:e}}},{"./MenuKeyboardNavigation":127,"./Slider":142,"@hypothesis/frontend-shared":18,classnames:19,"preact/hooks":27,"preact/jsx-runtime":28}],127:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({className:e,closeMenu:t,children:n,visible:a}){const c=(0,o.useRef)(null);return(0,o.useEffect)((()=>{let e=null;return a&&(e=setTimeout((()=>{const e=c.current.querySelector('[role^="menuitem"]');e&&e.focus()}))),()=>{clearTimeout(e)}}),[a]),(0,i.jsx)("div",{role:"menu",className:e,ref:c,onKeyDown:e=>{const n=Array.from(c.current.querySelectorAll('[role^="menuitem"]')).filter(s);let o=n.findIndex((e=>e.contains(document.activeElement))),i=!1;switch((0,r.normalizeKeyName)(e.key)){case"ArrowLeft":case"Escape":t&&(t(e),i=!0);break;case"ArrowUp":o-=1,o<0&&(o=n.length-1),i=!0;break;case"ArrowDown":o+=1,o===n.length&&(o=0),i=!0;break;case"Home":o=0,i=!0;break;case"End":o=n.length-1,i=!0}i&&o>=0&&(e.stopPropagation(),e.preventDefault(),n[o].focus())},children:n})};var r=e("@hypothesis/frontend-shared"),o=e("preact/hooks"),i=e("preact/jsx-runtime");function s(e){return null!==e.offsetParent}},{"@hypothesis/frontend-shared":18,"preact/hooks":27,"preact/jsx-runtime":28}],128:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({heading:e,children:t}){return(0,o.jsxs)(o.Fragment,{children:[e&&(0,o.jsx)("h2",{className:"MenuSection__heading",children:e}),(0,o.jsx)("ul",{className:"MenuSection__content",children:(0,r.toChildArray)(t).map((e=>(0,o.jsx)("li",{children:e},e.key)))})]})};var r=e("preact"),o=e("preact/jsx-runtime")},{preact:26,"preact/jsx-runtime":28}],129:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,o=(r=e("classnames"))&&r.__esModule?r:{default:r},i=e("../store/use-store"),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var s=o?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(r,i,s):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}(e("../helpers/annotation-metadata")),a=e("../service-context"),c=e("preact/jsx-runtime");function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=(0,a.withServices)((function({annotation:e,api:t,toastMessenger:n}){const r=(0,i.useStoreProxy)(),a=s.flagCount(e),l=null!==a&&(a>0||e.hidden),u=()=>{const o=e.id;t.annotation.hide({id:o}).then((()=>{r.hideAnnotation(o)})).catch((()=>{n.error("Failed to hide annotation")}))},f=()=>{const o=e.id;t.annotation.unhide({id:o}).then((()=>{r.unhideAnnotation(o)})).catch((()=>{n.error("Failed to unhide annotation")}))},p=(()=>{const t={};return e.hidden?(t.onClick=f,t.title="Make this annotation visible to everyone"):(t.onClick=u,t.title="Hide this annotation from non-moderators"),t["aria-label"]=t.title,t})(),h=(0,o.default)("ModerationBanner",{"is-flagged":null!==a&&a>0,"is-hidden":e.hidden,"is-reply":s.isReply(e)});return l?(0,c.jsxs)("div",{className:h,children:[!!a&&!e.hidden&&(0,c.jsxs)("span",{children:["Flagged for review x",a]}),e.hidden&&(0,c.jsxs)("span",{children:["Hidden from users. Flagged x",a]}),(0,c.jsx)("span",{className:"u-stretch"}),(0,c.jsx)("button",d(d({},p),{},{children:e.hidden?"Unhide":"Hide"}))]}):null}),["api","toastMessenger"]);n.default=p},{"../helpers/annotation-metadata":164,"../service-context":188,"../store/use-store":227,classnames:19,"preact/jsx-runtime":28}],130:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,o=e("../store/use-store"),i=e("./hooks/use-filter-options"),s=(r=e("./FilterSelect"))&&r.__esModule?r:{default:r},a=e("preact/jsx-runtime");var c=function(){const e=(0,o.useStoreProxy)(),t=e.getFilter("user"),n=(0,i.useUserFilterOptions)();return(0,a.jsx)(s.default,{defaultOption:{value:"",display:"Everybody"},icon:"profile",onSelect:t=>e.setFilter("user",t),options:n,selectedOption:t,title:"Filter by user"})};n.default=c},{"../store/use-store":227,"./FilterSelect":112,"./hooks/use-filter-options":156,"preact/jsx-runtime":28}],131:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,o=e("@hypothesis/frontend-shared"),i=(r=e("./hooks/use-root-thread"))&&r.__esModule?r:{default:r},s=e("../helpers/thread"),a=e("preact/jsx-runtime");var c=function({forcedVisibleCount:e,isFiltered:t,isLoading:n,resultCount:r}){const c=(0,i.default)(),l=n?r:(0,s.countVisible)(c),u=c.children.length>0,d=t&&e>0,f=l-e,p=c.children.length;return(0,a.jsxs)("div",{className:"NotebookResultCount u-layout-row",children:[n&&(0,a.jsx)(o.Spinner,{size:"small"}),!n&&(0,a.jsxs)("h2",{children:[!u&&(0,a.jsx)("strong",{children:"No results"}),u&&t&&(0,a.jsxs)("strong",{children:[f," ",1===f?"result":"results"]}),u&&!t&&(0,a.jsxs)("strong",{children:[p," ",1===p?"thread":"threads"]})]}),d&&(0,a.jsxs)("h3",{children:["(and ",e," more)"]}),!t&&u&&(0,a.jsxs)("h3",{children:["(",l," ",1===l?"annotation":"annotations",")"]})]})};n.default=c},{"../helpers/thread":178,"./hooks/use-root-thread":157,"@hypothesis/frontend-shared":18,"preact/jsx-runtime":28}],132:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@hypothesis/frontend-shared"),o=e("preact/hooks"),i=h(e("scroll-into-view")),s=e("../search-client"),a=e("../service-context"),c=e("../store/use-store"),l=h(e("./NotebookFilters")),u=h(e("./NotebookResultCount")),d=h(e("./PaginatedThreadList")),f=h(e("./hooks/use-root-thread")),p=e("preact/jsx-runtime");function h(e){return e&&e.__esModule?e:{default:e}}var m=(0,a.withServices)((function({loadAnnotationsService:e,streamer:t}){var n;const a=(0,c.useStoreProxy)(),h=a.getFilterValues(),m=a.focusedGroup(),g=a.forcedVisibleThreads().length,v=a.hasAppliedFilter(),y=a.isLoading(),_=a.annotationResultCount(),b=a.pendingUpdateCount(),j=(0,f.default)(),w=null!==(n=null==m?void 0:m.name)&&void 0!==n?n:"…",x=(null==m?void 0:m.id)||a.directLinkedGroupId(),O=(0,o.useRef)(1),[S,k]=(0,o.useState)(1),[P,E]=(0,o.useState)(!1),A=e=>{e instanceof s.ResultSizeError&&E(!0)},N=a.hasFetchedProfile();(0,o.useEffect)((()=>{N&&t.connect({applyUpdatesImmediately:!1})}),[N,t]),(0,o.useEffect)((()=>{a.setSortKey("Newest"),x&&e.load({groupId:x,sortBy:"updated",sortOrder:"desc",maxResults:5e3,onError:A,streamFilterBy:"group"})}),[e,x,a]);const T=e=>{k(e)};(0,o.useEffect)((()=>{T(1)}),[h,m]);const C=(0,o.useRef)(null);(0,o.useLayoutEffect)((()=>{S!==O.current&&((0,i.default)(C.current),O.current=S)}),[S]);const M=`Show ${b} new or updated ${b>1?"annotations":"annotation"}`;return(0,p.jsxs)("div",{className:"NotebookView",children:[(0,p.jsx)("header",{className:"NotebookView__heading",ref:C,children:(0,p.jsx)("h1",{className:"NotebookView__group-name",children:w})}),(0,p.jsx)("div",{className:"NotebookView__filters",children:(0,p.jsx)(l.default,{})}),(0,p.jsxs)("div",{className:"NotebookView__results u-layout-row--align-center u-font--large",children:[b>0&&!v&&(0,p.jsx)(r.IconButton,{icon:"refresh",onClick:()=>t.applyPendingUpdates(),variant:"primary",title:M}),(0,p.jsx)(u.default,{forcedVisibleCount:g,isFiltered:v,isLoading:y,resultCount:_})]}),(0,p.jsxs)("div",{className:"NotebookView__items",children:[P&&(0,p.jsx)("div",{className:"NotebookView__messages",children:(0,p.jsxs)(r.Panel,{title:"Too many results to show",children:["This preview of the Notebook can show"," ",(0,p.jsxs)("strong",{children:["up to ",5e3," results"]})," at a time (there are"," ",_," to show here)."," ",(0,p.jsx)("a",{href:"mailto:support@hypothes.is?subject=Hypothesis%20Notebook&body=Please%20notify%20me%20when%20the%20Hypothesis%20Notebook%20is%20updated%20to%20support%20more%20than%205000%20annotations",children:"Contact us"})," ","if you would like to be notified when support for more annotations is available."]})}),(0,p.jsx)(d.default,{currentPage:S,isLoading:y,onChangePage:T,threads:j.children})]})]})}),["loadAnnotationsService","streamer"]);n.default=m},{"../search-client":187,"../service-context":188,"../store/use-store":227,"./NotebookFilters":130,"./NotebookResultCount":131,"./PaginatedThreadList":133,"./hooks/use-root-thread":157,"@hypothesis/frontend-shared":18,"preact/hooks":27,"preact/jsx-runtime":28,"scroll-into-view":35}],133:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact/hooks"),o=e("../helpers/thread"),i=c(e("./PaginationNavigation")),s=c(e("./ThreadList")),a=e("preact/jsx-runtime");function c(e){return e&&e.__esModule?e:{default:e}}var l=function({currentPage:e,isLoading:t,onChangePage:n,threads:c,pageSize:l=25}){const{paginatedThreads:u,totalPages:d}=(0,r.useMemo)((()=>{const t=c.filter((e=>(0,o.countVisible)(e)>0)),n=(e-1)*l,r=n+l,i=Math.ceil(t.length/l);return{paginatedThreads:t.slice(n,r),totalPages:i}}),[c,e,l]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.default,{threads:u}),!t&&(0,a.jsx)(i.default,{currentPage:e,onChangePage:n,totalPages:d})]})};n.default=l},{"../helpers/thread":178,"./PaginationNavigation":134,"./ThreadList":150,"preact/hooks":27,"preact/jsx-runtime":28}],134:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@hypothesis/frontend-shared"),o=e("../util/pagination"),i=e("preact/jsx-runtime");var s=function({currentPage:e,onChangePage:t,totalPages:n}){const s=e<n,a=e>1,c=(0,o.pageNumberOptions)(e,n),l=(e,n)=>{t(e),null==n||n.blur()};return(0,i.jsxs)("div",{className:"PaginationNavigation",children:[(0,i.jsx)("div",{className:"PaginationNavigation__relative PaginationNavigation__prev",children:a&&(0,i.jsx)(r.LabeledButton,{className:"PaginationPageButton",icon:"arrow-left",title:"Go to previous page",onClick:t=>l(e-1,t.target),variant:"dark",children:"prev"})}),(0,i.jsx)("ul",{className:"PaginationNavigation__pages",children:c.map(((t,n)=>(0,i.jsx)("li",{children:null===t?(0,i.jsx)("div",{className:"PaginationNavigation__gap",children:"..."}):(0,i.jsx)(r.LabeledButton,{className:"PaginationPageButton",title:`Go to page ${t}`,pressed:t===e,onClick:e=>l(t,e.target),variant:"dark",children:t.toString()},`page-${n}`)},n)))}),(0,i.jsx)("div",{className:"PaginationNavigation__relative PaginationNavigation__next",children:s&&(0,i.jsx)(r.LabeledButton,{className:"PaginationPageButton",icon:"arrow-right",iconPosition:"right",title:"Go to next page",onClick:t=>l(e+1,t.target),variant:"dark",children:"next"})})]})};n.default=s},{"../util/pagination":238,"@hypothesis/frontend-shared":18,"preact/jsx-runtime":28}],135:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({alwaysExpanded:e,query:t,onSearch:n}){const r=(0,a.useStoreProxy)().isLoading(),l=(0,s.useRef)(null),[u,d]=(0,s.useState)(t),[f,p]=(0,s.useState)(t);return t!==u&&(p(t),d(t)),(0,c.jsxs)("form",{action:"#",className:"SearchInput__form",name:"searchForm",onSubmit:e=>{e.preventDefault(),(l.current.value||u)&&n(l.current.value)},children:[(0,c.jsx)("input",{"aria-label":"Search",className:(0,i.default)("SearchInput__input",{"is-expanded":e||t}),dir:"auto",type:"text",name:"query",placeholder:r?"Loading…":"Search…",disabled:r,ref:l,value:f||"",onInput:e=>p(e.target.value)}),!r&&(0,c.jsx)("div",{className:"SearchInput__button-container",children:(0,c.jsx)(o.IconButton,{icon:"search",onClick:()=>l.current.focus(),size:"small",title:"Search annotations"})}),r&&(0,c.jsx)("div",{style:"margin:0.5em 0",children:(0,c.jsx)(o.Spinner,{size:"small"})})]})};var r,o=e("@hypothesis/frontend-shared"),i=(r=e("classnames"))&&r.__esModule?r:{default:r},s=e("preact/hooks"),a=e("../store/use-store"),c=e("preact/jsx-runtime")},{"../store/use-store":227,"@hypothesis/frontend-shared":18,classnames:19,"preact/hooks":27,"preact/jsx-runtime":28}],136:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,o=e("@hypothesis/frontend-shared"),i=(r=e("classnames"))&&r.__esModule?r:{default:r},s=e("../helpers/theme"),a=e("../store/use-store"),c=e("../service-context"),l=e("preact/jsx-runtime");function u({children:e,count:t,isWaitingToAnchor:n,isSelected:r,label:o,onSelect:s}){const a=()=>{r||s()},c=t>0?`${o} (${t} available)`:o;return(0,l.jsx)("div",{children:(0,l.jsxs)("button",{className:(0,i.default)("SelectionTabs__type",{"is-selected":r}),onClick:a,onMouseDown:a,role:"tab",tabIndex:0,title:c,"aria-label":c,"aria-selected":r.toString(),children:[e,t>0&&!n&&(0,l.jsxs)("span",{className:"SelectionTabs__count",children:[" ",t]})]})})}var d=(0,c.withServices)((function({annotationsService:e,isLoading:t,settings:n}){const r=(0,a.useStoreProxy)(),i=r.selectedTab(),c=r.noteCount(),d=r.annotationCount(),f=r.orphanCount(),p=r.isWaitingToAnchorAnnotations(),h=e=>{r.clearSelection(),r.selectTab(e)},m="annotation"===i&&0===d&&!p,g="note"===i&&0===c;return(0,l.jsxs)("div",{className:"SelectionTabs-container",children:[(0,l.jsxs)("div",{className:"SelectionTabs",role:"tablist",children:[(0,l.jsx)(u,{count:d,isWaitingToAnchor:p,isSelected:"annotation"===i,label:"Annotations",onSelect:()=>h("annotation"),children:"Annotations"}),(0,l.jsx)(u,{count:c,isWaitingToAnchor:p,isSelected:"note"===i,label:"Page notes",onSelect:()=>h("note"),children:"Page Notes"}),f>0&&(0,l.jsx)(u,{count:f,isWaitingToAnchor:p,isSelected:"orphan"===i,label:"Orphans",onSelect:()=>h("orphan"),children:"Orphans"})]}),"note"===i&&n.enableExperimentalNewNoteButton&&(0,l.jsx)("div",{className:"u-layout-row--justify-right",children:(0,l.jsx)(o.LabeledButton,{icon:"add",onClick:()=>e.createPageNote(),variant:"primary",style:(0,s.applyTheme)(["ctaBackgroundColor"],n),children:"New note"})}),!t&&g&&(0,l.jsx)("div",{className:"SelectionTabs__message",children:"There are no page notes in this group."}),!t&&m&&(0,l.jsxs)("div",{className:"SelectionTabs__message",children:["There are no annotations in this group.",(0,l.jsx)("br",{}),"Create one by selecting some text and clicking the"," ",(0,l.jsx)(o.SvgIcon,{name:"annotate",inline:!0,className:"SelectionTabs__icon"})," ","button."]})]})}),["annotationsService","settings"]);n.default=d},{"../helpers/theme":175,"../service-context":188,"../store/use-store":227,"@hypothesis/frontend-shared":18,classnames:19,"preact/jsx-runtime":28}],137:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@hypothesis/frontend-shared"),o=e("../store/use-store"),i=e("../helpers/annotation-sharing"),s=e("../util/copy-to-clipboard"),a=e("../service-context"),c=e("../util/typing"),l=f(e("./ShareLinks")),u=f(e("./SidebarPanel")),d=e("preact/jsx-runtime");function f(e){return e&&e.__esModule?e:{default:e}}var p=(0,a.withServices)((function({toastMessenger:e}){const t=(0,o.useStoreProxy)(),n=t.mainFrame(),a=t.focusedGroup(),f=`Share Annotations in ${a&&a.name||"..."}`,p=a&&n,h=p&&(0,i.pageSharingLink)((0,c.notNull)(n).uri,(0,c.notNull)(a).id);return(0,d.jsxs)(u.default,{title:f,panelName:"shareGroupAnnotations",children:[!p&&(0,d.jsx)("div",{className:"hyp-u-layout-row--center",children:(0,d.jsx)(r.Spinner,{})}),p&&(0,d.jsx)("div",{className:"ShareAnnotationsPanel",children:h?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"ShareAnnotationsPanel__intro",children:"private"===(0,c.notNull)(a).type?(0,d.jsx)("p",{children:"Use this link to share these annotations with other group members:"}):(0,d.jsx)("p",{children:"Use this link to share these annotations with anyone:"})}),(0,d.jsxs)("div",{className:"u-layout-row",children:[(0,d.jsx)("input",{"aria-label":"Use this URL to share these annotations",className:"ShareAnnotationsPanel__form-input",type:"text",value:h,readOnly:!0}),(0,d.jsx)(r.IconButton,{className:"InputButton",icon:"copy",onClick:()=>{try{(0,s.copyText)(h),e.success("Copied share link to clipboard")}catch(t){e.error("Unable to copy link")}},title:"Copy share link"})]}),(0,d.jsxs)("p",{children:["private"===(0,c.notNull)(a).type?(0,d.jsxs)("span",{children:["Annotations in the private group"," ",(0,d.jsx)("em",{children:(0,c.notNull)(a).name})," are only visible to group members."]}):(0,d.jsxs)("span",{children:["Anyone using this link may view the annotations in the group"," ",(0,d.jsx)("em",{children:(0,c.notNull)(a).name}),"."]})," ",(0,d.jsxs)("span",{children:["Private (",(0,d.jsx)(r.SvgIcon,{name:"lock",inline:!0,className:"u-icon--inline"})," ",(0,d.jsx)("em",{children:"Only Me"}),") annotations are only visible to you."]})]}),(0,d.jsx)(l.default,{shareURI:h})]}):(0,d.jsx)("p",{children:"These annotations cannot be shared because this document is not available on the web."})})]})}),["toastMessenger"]);n.default=p},{"../helpers/annotation-sharing":165,"../service-context":188,"../store/use-store":227,"../util/copy-to-clipboard":230,"../util/typing":245,"./ShareLinks":138,"./SidebarPanel":140,"@hypothesis/frontend-shared":18,"preact/jsx-runtime":28}],138:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@hypothesis/frontend-shared"),o=e("preact/jsx-runtime");function i({label:e,iconName:t,uri:n}){return(0,o.jsx)("li",{className:"ShareLinks__link",children:(0,o.jsx)("a",{"aria-label":e,href:n,title:e,target:"_blank",rel:"noopener noreferrer",children:(0,o.jsx)(r.SvgIcon,{name:t,className:"ShareLinks__icon"})})})}var s=function({shareURI:e}){const t=encodeURIComponent(e);return(0,o.jsxs)("ul",{className:"ShareLinks",children:[(0,o.jsx)(i,{iconName:"twitter",label:"Tweet share link",uri:`https://twitter.com/intent/tweet?url=${t}&hashtags=annotated`}),(0,o.jsx)(i,{iconName:"facebook",label:"Share on Facebook",uri:`https://www.facebook.com/sharer/sharer.php?u=${t}`}),(0,o.jsx)(i,{iconName:"email",label:"Share via email",uri:`mailto:?subject=${encodeURIComponent("Let's Annotate")}&body=${t}`})]})};n.default=s},{"@hypothesis/frontend-shared":18,"preact/jsx-runtime":28}],139:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({errorType:e,onLoginRequest:t,showClearSelection:n=!1}){const s=(0,o.useStoreProxy)(),a=s.isLoggedIn(),c="annotation"===e?"Annotation unavailable":"Group unavailable",l=a?"group"===e?"The current URL links to a group, but that group cannot be found,\n        or you do not have permission to view the annotations in that group.":"The current URL links to an annotation, but that annotation\n      cannot be found, or you do not have permission to view it.":`The ${e} associated with the current URL is unavailable.\n        You may need to log in to see it.`;return(0,i.jsx)("div",{className:"u-sidebar-container",children:(0,i.jsxs)(r.Panel,{icon:"restricted",title:c,children:[(0,i.jsx)("p",{children:l}),(0,i.jsxs)("div",{className:"u-layout-row--justify-right u-horizontal-rhythm",children:[n&&(0,i.jsx)(r.LabeledButton,{variant:a?"primary":void 0,onClick:()=>s.clearSelection(),children:"Show all annotations"}),!a&&(0,i.jsx)(r.LabeledButton,{variant:"primary",onClick:t,children:"Log in"})]})]})})};var r=e("@hypothesis/frontend-shared"),o=e("../store/use-store"),i=e("preact/jsx-runtime")},{"../store/use-store":227,"@hypothesis/frontend-shared":18,"preact/jsx-runtime":28}],140:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({children:e,icon:t="",panelName:n,title:l,onActiveChanged:u}){const d=(0,s.useStoreProxy)(),f=d.isSidebarPanelOpen(n),p=(0,o.useRef)(null),h=(0,o.useRef)(f);(0,o.useEffect)((()=>{h.current!==f&&(h.current=f,f&&(0,i.default)(p.current),"function"==typeof u&&u(f))}),[f,u]);const m=(0,o.useCallback)((()=>{d.toggleSidebarPanel(n,!1)}),[d,n]);return(0,c.jsx)(a.default,{visible:f,children:(0,c.jsx)("div",{ref:p,className:"u-sidebar-container",children:(0,c.jsx)(r.Panel,{title:l,icon:t,onClose:m,children:e})})})};var r=e("@hypothesis/frontend-shared"),o=e("preact/hooks"),i=l(e("scroll-into-view")),s=e("../store/use-store"),a=l(e("./Slider")),c=e("preact/jsx-runtime");function l(e){return e&&e.__esModule?e:{default:e}}},{"../store/use-store":227,"./Slider":142,"@hypothesis/frontend-shared":18,"preact/hooks":27,"preact/jsx-runtime":28,"scroll-into-view":35}],141:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact/hooks"),o=m(e("./hooks/use-root-thread")),i=e("../service-context"),s=e("../store/use-store"),a=e("../helpers/tabs"),c=m(e("./FilterStatus")),l=m(e("./LoggedOutMessage")),u=m(e("./LoginPromptPanel")),d=m(e("./SelectionTabs")),f=m(e("./SidebarContentError")),p=m(e("./ThreadList")),h=e("preact/jsx-runtime");function m(e){return e&&e.__esModule?e:{default:e}}var g=(0,i.withServices)((function({frameSync:e,onLogin:t,onSignUp:n,loadAnnotationsService:i,streamer:m}){const g=(0,o.default)(),v=(0,s.useStoreProxy)(),y=v.focusedGroupId(),_=v.hasAppliedFilter()||v.hasSelectedAnnotations(),b=v.isLoading(),j=v.isLoggedIn(),w=v.directLinkedAnnotationId(),x=w?v.findAnnotationByID(w):void 0,O=x?(0,a.tabForAnnotation)(x):"annotation",S=v.searchUris(),k=v.hasSidebarOpened(),P=v.profile().userid,E=x&&!1===x.$orphan?x.$tag:null,A=!(b||!w||x),N=v.directLinkedGroupFetchFailed(),T=A||N,C=!T,M=!T&&!_,D=w&&!j&&!A&&!b,L=(0,r.useRef)(y);(0,r.useEffect)((()=>{L.current&&L.current===y||(L.current&&v.clearSelection(),L.current=y),y&&S.length&&i.load({groupId:y,uris:S})}),[v,i,y,P,S]),(0,r.useEffect)((()=>{E?(e.focusAnnotations([E]),e.scrollToAnnotation(E),v.selectTab(O)):x&&v.selectTab(O)}),[O,e,x,E,v]);const I=v.hasFetchedProfile();return(0,r.useEffect)((()=>{I&&(k||j)&&m.connect({applyUpdatesImmediately:!1})}),[I,j,k,m]),(0,h.jsxs)("div",{children:[(0,h.jsx)("h2",{className:"u-screen-reader-only",children:"Annotations"}),C&&(0,h.jsx)(c.default,{}),(0,h.jsx)(u.default,{onLogin:t,onSignUp:n}),A&&(0,h.jsx)(f.default,{errorType:"annotation",onLoginRequest:t,showClearSelection:!0}),N&&(0,h.jsx)(f.default,{errorType:"group",onLoginRequest:t}),M&&(0,h.jsx)(d.default,{isLoading:b}),(0,h.jsx)(p.default,{threads:g.children}),D&&(0,h.jsx)(l.default,{onLogin:t})]})}),["frameSync","loadAnnotationsService","streamer"]);n.default=g},{"../helpers/tabs":174,"../service-context":188,"../store/use-store":227,"./FilterStatus":113,"./LoggedOutMessage":121,"./LoginPromptPanel":122,"./SelectionTabs":136,"./SidebarContentError":139,"./ThreadList":150,"./hooks/use-root-thread":157,"preact/hooks":27,"preact/jsx-runtime":28}],142:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({children:e,visible:t}){const n=(0,r.useRef)(null),[i,s]=(0,r.useState)(t?"auto":0),[a,c]=(0,r.useState)(t);(0,r.useEffect)((()=>{if(t===(0!==i))return;const e=n.current;t?(e.style.display="",c(!0),s(e.scrollHeight)):(e.style.height=`${e.scrollHeight}px`,e.getBoundingClientRect(),s(0))}),[i,t]);const l=(0,r.useCallback)((()=>{t?s("auto"):c(!1)}),[s,t]),u="auto"===i;return(0,o.jsx)("div",{ontransitionend:l,ref:n,style:{display:a?"":"none",height:i,overflow:u?"visible":"hidden",transition:"height 0.15s ease-in"},children:e})};var r=e("preact/hooks"),o=e("preact/jsx-runtime")},{"preact/hooks":27,"preact/jsx-runtime":28}],143:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){const e=(0,o.useStoreProxy)(),t=e.sortKey(),n=e.sortKeys().map((n=>(0,a.jsx)(s.default,{label:n,onClick:()=>e.setSortKey(n),isSelected:n===t},n))),c=(0,a.jsx)("span",{className:"TopBar__menu-label",children:(0,a.jsx)(r.SvgIcon,{name:"sort",className:"TopBar__menu-icon"})});return(0,a.jsx)("div",{className:"SortMenu",children:(0,a.jsx)(i.default,{label:c,title:`Sort by ${t}`,align:"right",menuIndicator:!1,children:n})})};var r=e("@hypothesis/frontend-shared"),o=e("../store/use-store"),i=c(e("./Menu")),s=c(e("./MenuItem")),a=e("preact/jsx-runtime");function c(e){return e&&e.__esModule?e:{default:e}}},{"../store/use-store":227,"./Menu":125,"./MenuItem":126,"@hypothesis/frontend-shared":18,"preact/jsx-runtime":28}],144:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,o=e("../store/use-store"),i=e("../service-context"),s=(r=e("./SearchInput"))&&r.__esModule?r:{default:r},a=e("preact/jsx-runtime");var c=(0,i.withServices)((function({router:e}){const t=(0,o.useStoreProxy)().routeParams().q;return(0,a.jsx)(s.default,{query:t,onSearch:t=>{e.navigate("stream",{q:t})},alwaysExpanded:!0})}),["router"]);n.default=c},{"../service-context":188,"../store/use-store":227,"./SearchInput":135,"preact/jsx-runtime":28}],145:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact/hooks"),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var s=o?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(r,i,s):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}(e("../util/search-filter")),i=e("../service-context"),s=u(e("./hooks/use-root-thread")),a=e("../store/use-store"),c=u(e("./ThreadList")),l=e("preact/jsx-runtime");function u(e){return e&&e.__esModule?e:{default:e}}function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=(0,i.withServices)((function({api:e,toastMessenger:t}){const n=(0,a.useStoreProxy)(),i=n.routeParams().q,u=(0,r.useCallback)((async t=>{const r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({_separate_replies:!0,offset:0,limit:20},o.toObject(t));try{n.annotationFetchStarted();const t=await e.search(r);n.addAnnotations([...t.rows,...t.replies])}finally{n.annotationFetchFinished()}}),[e,n]);(0,r.useEffect)((()=>{n.setSortKey("Newest"),n.clearAnnotations(),u(i).catch((e=>{t.error(`Unable to fetch annotations: ${e.message}`)}))}),[i,u,n,t]);const d=(0,s.default)();return(0,l.jsx)(c.default,{threads:d.children})}),["api","toastMessenger"]);n.default=h},{"../service-context":188,"../store/use-store":227,"../util/search-filter":242,"./ThreadList":150,"./hooks/use-root-thread":157,"preact/hooks":27,"preact/jsx-runtime":28}],146:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,o=e("@hypothesis/frontend-shared"),i=e("preact/hooks"),s=e("../service-context"),a=(r=e("./AutocompleteList"))&&r.__esModule?r:{default:r},c=e("preact/jsx-runtime");let l=0;var u=(0,s.withServices)((function({onAddTag:e,onRemoveTag:t,onTagInput:n,tagList:r,tags:s}){const u=(0,i.useRef)(null),[d,f]=(0,i.useState)([]),[p,h]=(0,i.useState)(-1),[m,g]=(0,i.useState)(!1),[v]=(0,i.useState)((()=>(++l,`TagEditor-${l}`))),y=(0,i.useRef)(null);(0,o.useElementShouldClose)(y,m,(()=>{g(!1)}));const _=()=>u.current.value.trim(),b=()=>_()&&_().length>0,j=()=>{u.current.value="",null==n||n("")},w=t=>{e(t)&&(g(!1),h(-1),j(),u.current.focus())},x=e=>{let t=p+e;t<-1?t=d.length-1:t>=d.length&&(t=-1),h(t)},O=p>=0?`${v}-AutocompleteList-item-${p}`:"";return(0,c.jsxs)("div",{className:"TagEditor",children:[(0,c.jsx)("ul",{className:"TagEditor__tags","aria-label":"Suggested tags for annotation",children:r.map((e=>(0,c.jsxs)("li",{className:"TagEditor__item","aria-label":`Tag: ${e}`,children:[(0,c.jsx)("span",{lang:"",className:"TagEditor__edit",children:e}),(0,c.jsx)("button",{onClick:()=>{t(e)},"aria-label":`Remove Tag: ${e}`,title:`Remove Tag: ${e}`,className:"TagEditor__delete",children:(0,c.jsx)(o.SvgIcon,{name:"cancel"})})]},`${e}`)))}),(0,c.jsxs)("span",{id:v,className:"TagEditor__combobox-wrapper",ref:y,role:"combobox","aria-expanded":m.toString(),"aria-owns":`${v}-AutocompleteList`,"aria-haspopup":"listbox",children:[(0,c.jsx)("input",{onInput:()=>{null==n||n(_()),(()=>{if(b()){const e=s.filter(_());f(((e,t)=>{const n=[];return e.forEach((e=>{t.indexOf(e)<0&&n.push(e)})),n.sort()})(e,r)),g(e.length>0)}else g(!1);h(-1)})()},onKeyDown:e=>{switch((0,o.normalizeKeyName)(e.key)){case"ArrowUp":x(-1),e.preventDefault();break;case"ArrowDown":x(1),e.preventDefault();break;case"Escape":j(),e.preventDefault();break;case"Enter":case",":w(-1===p?_():d[p]),e.preventDefault();break;case"Tab":if(!b())break;-1!==p?w(d[p]):1===d.length?w(d[0]):w(_()),e.preventDefault()}},onFocus:()=>{b()&&g(!0)},ref:u,placeholder:"Add new tags",className:"TagEditor__input",type:"text",autoComplete:"off","aria-autocomplete":"list","aria-activedescendant":O,"aria-controls":`${v}-AutocompleteList`,dir:"auto"}),(0,c.jsx)(a.default,{id:`${v}-AutocompleteList`,list:d,listFormatter:e=>{const t=_().toLowerCase(),n=e.toLowerCase().indexOf(t);if(-1===n)return(0,c.jsx)("span",{children:e});const r=e.slice(0,n),o=e.slice(n,n+t.length),i=e.slice(n+t.length);return(0,c.jsxs)("span",{children:[(0,c.jsx)("strong",{children:r}),o,(0,c.jsx)("strong",{children:i})]})},open:m,onSelectItem:e=>{e&&w(e)},itemPrefixId:`${v}-AutocompleteList-item-`,activeItem:p})]})]})}),["tags"]);n.default=u},{"../service-context":188,"./AutocompleteList":110,"@hypothesis/frontend-shared":18,"preact/hooks":27,"preact/jsx-runtime":28}],147:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact/hooks"),o=e("../store/use-store"),i=e("../helpers/account-id"),s=e("preact/jsx-runtime");var a=function({annotation:e,tags:t}){const n=(0,o.useStoreProxy)(),a=n.defaultAuthority(),c=(0,r.useMemo)((()=>!(0,i.isThirdPartyUser)(e.user,a)),[e,a]),l=e=>n.getLink("search.tag",{tag:e});return(0,s.jsx)("ul",{className:"TagList","aria-label":"Annotation tags",children:t.map((e=>(0,s.jsxs)("li",{className:"TagList__item",children:[c&&(0,s.jsx)("a",{className:"TagList__link",href:l(e),lang:"",target:"_blank",rel:"noopener noreferrer","aria-label":`Tag: ${e}`,title:`View annotations with tag: ${e}`,children:e}),!c&&(0,s.jsx)("span",{className:"TagList__text","aria-label":`Tag: ${e}`,lang:"",children:e})]},e)))})};n.default=a},{"../helpers/account-id":163,"../store/use-store":227,"preact/hooks":27,"preact/jsx-runtime":28}],148:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@hypothesis/frontend-shared"),o=h(e("classnames")),i=e("preact/hooks"),s=e("../store/use-store"),a=e("../service-context"),c=e("../helpers/thread"),l=h(e("./Annotation")),u=h(e("./Annotation/AnnotationHeader")),d=h(e("./ModerationBanner")),f=e("preact/jsx-runtime");const p=["annotation"];function h(e){return e&&e.__esModule?e:{default:e}}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function _(e){let{annotation:t}=e,n=y(e,p);const r=(0,s.useStoreProxy)(),o=t&&r.isSavingAnnotation(t),i=t&&!!r.getDraft(t)&&!o;return t?(0,f.jsx)("div",{className:"Thread__top-annotation-header",children:(0,f.jsx)(u.default,g({annotation:t,isEditing:i},n))}):null}var b=(0,a.withServices)((function e({thread:t,threadsService:n}){const a=!t.collapsed,u=(0,c.countHidden)(t)>0,p=!!t.parent,h=t.collapsed?"collapsed":"expand-menu",m=t.collapsed?"Expand replies":"Collapse replies",g=t.children.filter((e=>(0,c.countVisible)(e)>0)),v=(0,s.useStoreProxy)(),y=v.hasAppliedFilter(),b=(0,i.useCallback)((()=>v.setExpanded(t.id,!!t.collapsed)),[v,t.id,t.collapsed]),j=(0,i.useMemo)((()=>t.visible&&(0,f.jsxs)(f.Fragment,{children:[t.annotation&&(0,f.jsx)(d.default,{annotation:t.annotation}),(0,f.jsx)(l.default,{annotation:t.annotation,hasAppliedFilter:y,isReply:!!t.parent,onToggleReplies:b,replyCount:t.replyCount,threadIsCollapsed:t.collapsed})]})),[y,b,t.annotation,t.parent,t.replyCount,t.collapsed,t.visible]);return(0,f.jsxs)("section",{className:(0,o.default)("Thread",{"Thread--reply":t.depth>0,"is-collapsed":t.collapsed}),children:[p&&(0,f.jsx)("div",{className:"Thread__collapse",children:(0,f.jsx)("div",{className:"Thread__collapse-button-container",children:(0,f.jsx)(r.IconButton,{className:"NonResponsiveIconButton",expanded:!t.collapsed,icon:h,title:m,onClick:b,size:"medium",variant:"light"})})}),(0,f.jsxs)("div",{className:"Thread__content",children:[j,u&&(0,f.jsxs)(f.Fragment,{children:[!t.parent&&(0,f.jsx)(_,{annotation:t.annotation,replyCount:t.replyCount,threadIsCollapsed:t.collapsed}),(0,f.jsx)("div",{className:"Thread__hidden-toggle-button-container",children:(0,f.jsxs)(r.LabeledButton,{onClick:()=>n.forceVisible(t),children:["Show ",(0,c.countHidden)(t)," more in conversation"]})})]}),a&&(0,f.jsx)("ul",{className:"Thread__children",children:g.map((t=>(0,f.jsx)("li",{children:(0,f.jsx)(e,{thread:t,threadsService:n})},t.id)))})]})]})}),["threadsService"]);n.default=b},{"../helpers/thread":178,"../service-context":188,"../store/use-store":227,"./Annotation":108,"./Annotation/AnnotationHeader":99,"./ModerationBanner":129,"@hypothesis/frontend-shared":18,classnames:19,"preact/hooks":27,"preact/jsx-runtime":28}],149:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=u(e("classnames")),o=u(e("lodash.debounce")),i=e("preact/hooks"),s=e("../store/use-store"),a=e("../service-context"),c=u(e("./Thread")),l=e("preact/jsx-runtime");function u(e){return e&&e.__esModule?e:{default:e}}var d=(0,a.withServices)((function({frameSync:e,thread:t}){const n=(0,s.useStoreProxy)(),a=t.annotation&&t.annotation.$tag,u=a&&n.isAnnotationFocused(a),d=(0,i.useMemo)((()=>(0,o.default)((t=>{const n=t?[t]:[];e.focusAnnotations(n)}),10)),[e]),f=(0,i.useCallback)((t=>{e.scrollToAnnotation(t)}),[e]),p=(0,i.useMemo)((()=>(0,l.jsx)(c.default,{thread:t})),[t]);return(0,l.jsx)("div",{onClick:e=>{var t;(t=e.target).closest("button")||t.closest("a")||f(a)},onMouseEnter:()=>d(a),onMouseLeave:()=>d(null),className:(0,r.default)("ThreadCard",{"is-focused":u}),children:p},t.id)}),["frameSync"]);n.default=d},{"../service-context":188,"../store/use-store":227,"./Thread":148,classnames:19,"lodash.debounce":24,"preact/hooks":27,"preact/jsx-runtime":28}],150:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("preact/hooks"),o=f(e("lodash.debounce")),i=e("../store/use-store"),s=e("../helpers/annotation-metadata"),a=e("../util/dom"),c=e("../helpers/visible-threads"),l=f(e("./ThreadCard")),u=e("../../annotator/util/listener-collection"),d=e("preact/jsx-runtime");function f(e){return e&&e.__esModule?e:{default:e}}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(){const e=document.querySelector(".js-thread-list-scroll-root");if(!e)throw new Error("Scroll container is missing");return e}function v(e){return Math.max(e-e%50,0)}var y=function({threads:e}){const[t,n]=(0,r.useState)(window.innerHeight),[f,p]=(0,r.useState)(0);(0,r.useLayoutEffect)((()=>{const e=g();n(e.clientHeight),p(v(e.scrollTop))}),[]);const[m,y]=(0,r.useState)({}),[_,b]=(0,r.useState)(null),j=e,{offscreenLowerHeight:w,offscreenUpperHeight:x,visibleThreads:O}=(0,r.useMemo)((()=>(0,c.calculateVisibleThreads)(j,m,f,t)),[j,m,f,t]),S=(0,i.useStoreProxy)(),k=(()=>{const e=S.unsavedAnnotations().filter((e=>!e.id&&!(0,s.isHighlight)(e)));return e.length?e[e.length-1].$tag:null})();return(0,r.useEffect)((()=>{k&&(S.setForcedVisible(k,!0),b(k))}),[S,k]),(0,r.useEffect)((()=>{if(!_)return;const e=j.findIndex((e=>e.id===_));if(-1===e)return;b(null);const t=j.slice(0,e).reduce(((e,t)=>e+(e=>m[e.id]||c.THREAD_DIMENSION_DEFAULTS.defaultHeight)(t)),0);g().scrollTop=t}),[_,j,m]),(0,r.useEffect)((()=>{const e=new u.ListenerCollection,t=g(),r=(0,o.default)((()=>{n(t.clientHeight),p(v(t.scrollTop))}),10,{maxWait:100});return e.add(t,"scroll",r),e.add(window,"resize",r),()=>{e.removeAll(),r.cancel()}}),[]),(0,r.useEffect)((()=>{y((e=>{const t={};for(let{id:n}of O){const r=document.getElementById(n);if(!r)return console.warn("ThreadList could not measure thread. Element not found."),e;const o=(0,a.getElementHeightWithMargins)(r);o!==e[n]&&(t[n]=o)}return 0===Object.keys(t).length?e:h(h({},e),t)}))}),[O]),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{style:{height:x}}),O.map((e=>(0,d.jsx)("div",{className:"ThreadList__card",id:e.id,children:(0,d.jsx)(l.default,{thread:e})},e.id))),(0,d.jsx)("div",{style:{height:w}})]})};n.default=y},{"../../annotator/util/listener-collection":38,"../helpers/annotation-metadata":164,"../helpers/visible-threads":181,"../store/use-store":227,"../util/dom":232,"./ThreadCard":149,"lodash.debounce":24,"preact/hooks":27,"preact/jsx-runtime":28}],151:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,o=(r=e("classnames"))&&r.__esModule?r:{default:r},i=e("@hypothesis/frontend-shared"),s=e("../store/use-store"),a=e("../service-context"),c=e("preact/jsx-runtime");function l({message:e,onDismiss:t}){const n=e.type.charAt(0).toUpperCase()+e.type.slice(1),r="notice"===e.type?"cancel":e.type;return(0,c.jsx)("li",{className:(0,o.default)("toast-message-container",{"is-dismissed":e.isDismissed}),onClick:()=>t(e.id),children:(0,c.jsxs)("div",{className:(0,o.default)("toast-message",`toast-message--${e.type}`),children:[(0,c.jsx)("div",{className:"toast-message__type",children:(0,c.jsx)(i.SvgIcon,{name:r,className:"toast-message__icon"})}),(0,c.jsxs)("div",{className:"toast-message__message",children:[(0,c.jsxs)("strong",{children:[n,": "]}),e.message,e.moreInfoURL&&(0,c.jsx)("div",{className:"toast-message__link",children:(0,c.jsx)("a",{href:e.moreInfoURL,onClick:e=>e.stopPropagation(),target:"_new",children:"More info"})})]})]})})}var u=(0,a.withServices)((function({toastMessenger:e}){const t=(0,s.useStoreProxy)().getToastMessages();return(0,c.jsx)("div",{children:(0,c.jsx)("ul",{"aria-live":"polite","aria-relevant":"additions",className:"ToastMessages",children:t.map((t=>(0,c.jsx)(l,{message:t,onDismiss:t=>e.dismiss(t)},t.id)))})})}),["toastMessenger"]);n.default=u},{"../service-context":188,"../store/use-store":227,"@hypothesis/frontend-shared":18,classnames:19,"preact/jsx-runtime":28}],152:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@hypothesis/frontend-shared"),o=g(e("../../shared/bridge-events")),i=e("../config/service-config"),s=e("../store/use-store"),a=e("../helpers/is-third-party-service"),c=e("../service-context"),l=e("../helpers/theme"),u=g(e("./GroupList")),d=g(e("./SearchInput")),f=g(e("./SortMenu")),p=g(e("./StreamSearchInput")),h=g(e("./UserMenu")),m=e("preact/jsx-runtime");function g(e){return e&&e.__esModule?e:{default:e}}var v=(0,c.withServices)((function({auth:e,bridge:t,isSidebar:n,onLogin:c,onLogout:g,onSignUp:v,settings:y,streamer:_}){const b=!(0,a.isThirdPartyService)(y),j=(0,l.applyTheme)(["accentColor"],y),w=(0,s.useStoreProxy)(),x=w.filterQuery(),O=w.pendingUpdateCount(),S=w.isSidebarPanelOpen("help"),k=w.isSidebarPanelOpen("shareGroupAnnotations"),P=()=>{const e=(0,i.serviceConfig)(y);e&&e.onHelpRequestProvided?t.call(o.default.HELP_REQUESTED):w.toggleSidebarPanel("help")},E=(0,m.jsxs)(m.Fragment,{children:["unknown"===e.status&&(0,m.jsx)("span",{className:"TopBar__login-links",children:"⋯"}),"logged-out"===e.status&&(0,m.jsxs)("span",{className:"TopBar__login-links u-font--large u-horizontal-rhythm",children:[(0,m.jsx)(r.LinkButton,{className:"InlineLinkButton",onClick:v,style:j,variant:"primary",children:"Sign up"}),(0,m.jsx)("div",{children:"/"}),(0,m.jsx)(r.LinkButton,{className:"InlineLinkButton",onClick:c,style:j,variant:"primary",children:"Log in"})]}),"logged-in"===e.status&&(0,m.jsx)(h.default,{auth:e,onLogout:g})]});return(0,m.jsxs)("div",{className:"TopBar",children:[!n&&(0,m.jsxs)("div",{className:"TopBar__inner content",children:[(0,m.jsx)(p.default,{}),(0,m.jsx)("div",{className:"u-stretch"}),(0,m.jsx)(r.IconButton,{icon:"help",expanded:S,onClick:P,size:"small",title:"Help"}),E]}),n&&(0,m.jsxs)("div",{className:"TopBar__inner content",children:[(0,m.jsx)(u.default,{}),(0,m.jsx)("div",{className:"u-stretch"}),O>0&&(0,m.jsx)(r.IconButton,{icon:"refresh",onClick:()=>_.applyPendingUpdates(),size:"small",variant:"primary",title:`Show ${O} new/updated ${1===O?"annotation":"annotations"}`}),(0,m.jsx)(d.default,{query:x||null,onSearch:w.setFilterQuery}),(0,m.jsx)(f.default,{}),b&&(0,m.jsx)(r.IconButton,{icon:"share",expanded:k,onClick:()=>{w.toggleSidebarPanel("shareGroupAnnotations")},size:"small",title:"Share annotations on this page"}),(0,m.jsx)(r.IconButton,{icon:"help",expanded:S,onClick:P,size:"small",title:"Help"}),E]})]})}),["bridge","settings","streamer"]);n.default=v},{"../../shared/bridge-events":85,"../config/service-config":161,"../helpers/is-third-party-service":171,"../helpers/theme":175,"../service-context":188,"../store/use-store":227,"./GroupList":117,"./SearchInput":135,"./SortMenu":143,"./StreamSearchInput":144,"./UserMenu":154,"@hypothesis/frontend-shared":18,"preact/jsx-runtime":28}],153:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@hypothesis/frontend-shared"),o=e("../helpers/is-third-party-service"),i=e("../service-context"),s=e("preact/jsx-runtime");function a({commandName:e,iconName:t}){return(0,s.jsxs)("span",{className:"Tutorial__instruction",children:[(0,s.jsx)(r.SvgIcon,{name:t,inline:!0,className:"Tutorial__icon"}),(0,s.jsx)("em",{children:e})]})}var c=(0,i.withServices)((function({settings:e}){const t=!(0,o.isThirdPartyService)(e);return(0,s.jsxs)("ol",{className:"Tutorial__list",children:[(0,s.jsxs)("li",{className:"Tutorial__item",children:["To create an annotation, select text and then select the"," ",(0,s.jsx)(a,{iconName:"annotate",commandName:"Annotate"})," ","button."]}),(0,s.jsxs)("li",{className:"Tutorial__item",children:["To create a highlight (",(0,s.jsx)("a",{href:"https://web.hypothes.is/help/why-are-highlights-private-by-default/",target:"_blank",rel:"noopener noreferrer",children:"visible only to you"}),"), select text and then select the"," ",(0,s.jsx)(a,{iconName:"highlight",commandName:"Highlight"})," ","button."]}),t&&(0,s.jsxs)("li",{className:"Tutorial__item",children:["To annotate in a private group, select the group from the groups dropdown. Don't see your group? Ask the group creator to send a"," ",(0,s.jsx)("a",{href:"https://web.hypothes.is/help/how-to-join-a-private-group/",target:"_blank",rel:"noopener noreferrer",children:"join link"}),")."]}),(0,s.jsxs)("li",{className:"Tutorial__item",children:["To reply to an annotation, select the"," ",(0,s.jsx)(a,{iconName:"reply",commandName:"Reply"})," button."]})]})}),["settings"]);n.default=c},{"../helpers/is-third-party-service":171,"../service-context":188,"@hypothesis/frontend-shared":18,"preact/jsx-runtime":28}],154:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@hypothesis/frontend-shared"),o=e("preact/hooks"),i=h(e("../../shared/bridge-events")),s=e("../config/service-config"),a=e("../helpers/account-id"),c=e("../store/use-store"),l=e("../service-context"),u=h(e("./Menu")),d=h(e("./MenuItem")),f=h(e("./MenuSection")),p=e("preact/jsx-runtime");function h(e){return e&&e.__esModule?e:{default:e}}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=(0,l.withServices)((function({auth:e,bridge:t,onLogout:n,settings:l}){const h=(0,c.useStoreProxy)(),m=h.defaultAuthority(),v=(0,a.isThirdPartyUser)(e.userid,m),y=(0,s.serviceConfig)(l),_=h.isFeatureEnabled("notebook_launch"),[b,j]=(0,o.useState)(!1),w=e=>y&&!!y[e],x=!v||w("onProfileRequestProvided"),O=!v||w("onLogoutRequestProvided"),S=()=>{t.call("openNotebook",h.focusedGroupId())},k=()=>v&&t.call(i.default.PROFILE_REQUESTED),P=(()=>{const t={};return x&&(v||(t.href=h.getLink("user",{user:e.username})),t.onClick=k),t})(),E=(0,p.jsx)("span",{className:"TopBar__menu-label",children:(0,p.jsx)(r.SvgIcon,{name:"profile",className:"TopBar__menu-icon"})});return(0,p.jsx)("div",{className:"UserMenu",onKeyDown:e=>{"n"===e.key&&(S(),j(!1))},children:(0,p.jsxs)(u.default,{label:E,title:e.displayName,align:"right",open:b,onOpenChanged:j,children:[(0,p.jsxs)(f.default,{children:[(0,p.jsx)(d.default,g({label:e.displayName,isDisabled:!x},P)),!v&&(0,p.jsx)(d.default,{label:"Account settings",href:h.getLink("account.settings")}),_&&(0,p.jsx)(d.default,{label:"Open notebook",onClick:()=>S()})]}),O&&(0,p.jsx)(f.default,{children:(0,p.jsx)(d.default,{label:"Log out",onClick:n})})]})})}),["bridge","settings"]);n.default=y},{"../../shared/bridge-events":85,"../config/service-config":161,"../helpers/account-id":163,"../service-context":188,"../store/use-store":227,"./Menu":125,"./MenuItem":126,"./MenuSection":128,"@hypothesis/frontend-shared":18,"preact/hooks":27,"preact/jsx-runtime":28}],155:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@hypothesis/frontend-shared"),o=e("../util/copy-to-clipboard"),i=e("../service-context"),s=e("preact/jsx-runtime");var a=(0,i.withServices)((function({toastMessenger:e,versionData:t}){return(0,s.jsxs)("div",{className:"u-vertical-rhythm",children:[(0,s.jsxs)("dl",{className:"VersionInfo",children:[(0,s.jsx)("dt",{className:"VersionInfo__key",children:"Version"}),(0,s.jsx)("dd",{className:"VersionInfo__value",children:t.version}),(0,s.jsx)("dt",{className:"VersionInfo__key",children:"User Agent"}),(0,s.jsx)("dd",{className:"VersionInfo__value",children:t.userAgent}),(0,s.jsx)("dt",{className:"VersionInfo__key",children:"URL"}),(0,s.jsx)("dd",{className:"VersionInfo__value",children:t.url}),(0,s.jsx)("dt",{className:"VersionInfo__key",children:"Fingerprint"}),(0,s.jsx)("dd",{className:"VersionInfo__value",children:t.fingerprint}),(0,s.jsx)("dt",{className:"VersionInfo__key",children:"Account"}),(0,s.jsx)("dd",{className:"VersionInfo__value",children:t.account}),(0,s.jsx)("dt",{className:"VersionInfo__key",children:"Date"}),(0,s.jsx)("dd",{className:"VersionInfo__value",children:t.timestamp})]}),(0,s.jsx)("div",{className:"u-layout-row--justify-center",children:(0,s.jsx)(r.LabeledButton,{onClick:()=>{try{(0,o.copyText)(t.asFormattedString()),e.success("Copied version info to clipboard")}catch(n){e.error("Unable to copy version info")}},icon:"copy",children:"Copy version details"})})]})}),["toastMessenger"]);n.default=a},{"../service-context":188,"../util/copy-to-clipboard":230,"@hypothesis/frontend-shared":18,"preact/jsx-runtime":28}],156:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.useUserFilterOptions=function(){const e=(0,o.useStoreProxy)(),t=e.allAnnotations(),n=e.defaultAuthority(),a=e.isFeatureEnabled("client_display_names"),c=e.getFocusFilters(),l=(0,i.username)(e.profile().userid);return(0,r.useMemo)((()=>{const e={};if(t.forEach((t=>{const r=(0,i.username)(t.user);e[r]=(0,s.annotationDisplayName)(t,(0,i.isThirdPartyUser)(t.user,n),a)})),c.user){const t=(0,i.username)(c.user.value)||c.user.value;e[t]=c.user.display}const r=Object.keys(e).map((t=>({display:t===l?`${e[t]} (Me)`:e[t],value:t})));return r.sort(((e,t)=>l===e.value?-1:l===t.value?1:e.display.localeCompare(t.display))),r}),[t,l,n,a,c.user])};var r=e("preact/hooks"),o=e("../../store/use-store"),i=e("../../helpers/account-id"),s=e("../../helpers/annotation-user")},{"../../helpers/account-id":163,"../../helpers/annotation-user":166,"../../store/use-store":227,"preact/hooks":27}],157:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){const e=(0,i.useStoreProxy)(),t=e.allAnnotations(),n=e.filterQuery(),r=e.route(),a=e.selectionState(),l=e.getFilterValues(),u=(0,o.useMemo)((()=>({annotations:t,route:r,selection:c(c({},a),{},{filterQuery:n,filters:l})})),[t,n,r,a,l]);return(0,s.default)(u)};var r,o=e("preact/hooks"),i=e("../../store/use-store"),s=(r=e("../../helpers/thread-annotations"))&&r.__esModule?r:{default:r};function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},{"../../helpers/thread-annotations":176,"../../store/use-store":227,"preact/hooks":27}],158:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.fetchConfig=async function(e,t=window){const n=(0,o.default)(window),s=n.requestConfigFromFrame;if(!s)return d(e,n);if("string"==typeof s)return await function(e,t=window){let n;return n=function(e,t=window){const n=[];for(let r of function(e){if(e===e.top)return[];const t=[];do{e=e.parent,t.push(e)}while(e!==e.top);return t}(t)){const t=3e3,o=i.call(r,e,"requestConfig",[],t);n.push(o)}return 0===n.length&&n.push(Promise.reject(new Error("Client is top frame"))),Promise.race(n)}((0,o.default)(t).requestConfigFromFrame,t),n.then((t=>{const n=Object.assign({},e,t);return n.apiUrl=(0,r.default)(n),n}))}(e,t);if("number"==typeof s.ancestorLevel&&"string"==typeof s.origin){const r=function(e,t=window){let n=t;for(let r=0;r<e;r++){if(n===n.top)throw new Error("The target parent frame has exceeded the ancestor tree. Try reducing the `requestConfigFromFrame.ancestorLevel` value in the `hypothesisConfig`");n=n.parent}return n}(s.ancestorLevel,t);return l(l({},await async function(e,t,n){return async function(e,t){return Array.isArray(e.services)&&e.services.forEach(((e,n)=>{"$rpc:requestGroups"===e.groups&&(e.groups=t("requestGroups",[n],null).catch((()=>{throw new Error("Unable to fetch groups")})))})),e}(d(e,await i.call(t,n,"requestConfig",[],3e3)),((e,r=[],o=3e3)=>i.call(t,n,e,r,o)))}(e,r,s.origin)),n.group?{group:n.group}:{})}throw new Error("Improper `requestConfigFromFrame` object. Both `ancestorLevel` and `origin` need to be specified")};var r=a(e("./get-api-url")),o=a(e("./host-config")),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}(e("../util/postmessage-json-rpc"));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function a(e){return e&&e.__esModule?e:{default:e}}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){const n=l(l({},e),t);return n.apiUrl=(0,r.default)(n),n}},{"../util/postmessage-json-rpc":239,"./get-api-url":159,"./host-config":160}],159:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){const t=(0,r.serviceConfig)(e);if(t){if(t.apiUrl)return t.apiUrl;throw new Error("Service should contain an apiUrl value.")}return e.apiUrl};var r=e("./service-config")},{"./service-config":161}],160:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){const t=e.location.hash.slice(1),n=new URLSearchParams(t).get("config"),o=JSON.parse(n||"{}"),i=["annotations","group","query","appType","openSidebar","showHighlights","services","branding","enableExperimentalNewNoteButton","focus","requestConfigFromFrame","theme","usernameUrl"],s={openSidebar:r.toBoolean,requestConfigFromFrame:e=>{if("string"==typeof e)return e;const t=(0,r.toObject)(e);return{origin:(0,r.toString)(t.origin),ancestorLevel:(0,r.toInteger)(t.ancestorLevel)}}};return Object.keys(o).reduce(((e,t)=>(-1!==i.indexOf(t)&&null!==o[t]&&(s[t]?e[t]=s[t](o[t]):e[t]=o[t]),e)),{})};var r=e("../../shared/type-coercions")},{"../../shared/type-coercions":91}],161:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.serviceConfig=function({services:e}){return Array.isArray(e)&&e[0]?e[0]:null}},{}],162:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.startServer=s,n.preStartServer=function(e=window){e.addEventListener("message",a)};var r,o=(r=e("../shared/warn-once"))&&r.__esModule?r:{default:r};let i=[];function s(e,t,n){const r=(e=>({changeFocusModeUser:e.changeFocusModeUser}))(e);function s(e){let n=t.rpcAllowedOrigins||[];if(!function(e){return null!=e&&"object"==typeof e&&"2.0"===e.jsonrpc}(e.data))return;if(!n.includes(e.origin))return void(0,o.default)(`Ignoring JSON-RPC request from non-whitelisted origin ${e.origin}`);let i=e.data;e.source.postMessage(function(e){const t=r[e.method];return void 0===t?{jsonrpc:"2.0",id:e.id,error:{code:-32601,message:"Method not found"}}:(e.params?t(...e.params):t(),{jsonrpc:"2.0",result:"ok",id:e.id})}(i),e.origin)}i.forEach((e=>{s(e)})),i=[],window.removeEventListener("message",a),n.addEventListener("message",s)}function a(e){i.push(e)}s.$inject=["store","settings","$window"]},{"../shared/warn-once":93}],163:[function(e,t,n){"use strict";function r(e){if(!e)return null;const t=e.match(/^acct:([^@]+)@(.+)/);return t?{username:t[1],provider:t[2]}:null}Object.defineProperty(n,"__esModule",{value:!0}),n.parseAccountID=r,n.username=function(e){const t=r(e);return t?t.username:""},n.isThirdPartyUser=function(e,t){const n=r(e);return!!n&&n.provider!==t}},{}],164:[function(e,t,n){"use strict";function r(e){const t=e.uri;let n;try{n=new URL(t).hostname}catch(o){n=""}"localhost"===n&&(n="");let r=n;return e.document&&e.document.title&&(r=e.document.title[0]),{uri:t,domain:n,title:r}}function o(e){let t=e.uri;return t&&0!==t.indexOf("http://")&&0!==t.indexOf("https://")&&(t=null),e.links&&e.links.incontext&&(t=e.links.incontext),t}function i(e){const t=r(e);let n="";if(t.uri&&0===t.uri.indexOf("file://")&&t.title){const e=t.uri.split("/"),r=e[e.length-1];r&&(n=r)}else t.domain&&t.domain!==t.title&&(n=t.domain);return n}function s(e){let t=r(e).title;return t.length>30&&(t=t.slice(0,30)+"…"),t}function a(e){return(e.references||[]).length>0}function c(e){return!e.id}function l(e){return!!(e.target&&e.target.length>0&&e.target[0].selector)}function u(e){return l(e)&&!0===e.$orphan}function d(e){return!l(e)&&!a(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.documentMetadata=r,n.domainAndTitle=function(e){return{domain:i(e),titleText:s(e),titleLink:o(e)}},n.isReply=a,n.isNew=c,n.isPublic=function(e){let t=!1;return e.permissions?(e.permissions.read.forEach((e=>{const n=e.split(":");2===n.length&&"group"===n[0]&&(t=!0)})),t):t},n.isWaitingToAnchor=function(e){return l(e)&&void 0===e.$orphan&&!e.$anchorTimeout},n.isHidden=function(e){return!!e.hidden},n.isHighlight=function(e){return!!e.$highlight||!c(e)&&!(d(e)||a(e)||e.hidden||e.text||e.tags&&e.tags.length)},n.isOrphan=u,n.isPageNote=d,n.isAnnotation=function(e){return!(!l(e)||u(e))},n.location=function(e){if(e){const t=e.target||[];for(let e=0;e<t.length;e++){const n=t[e].selector||[];for(const e of n)if("TextPositionSelector"===e.type)return e.start}}return Number.POSITIVE_INFINITY},n.flagCount=function(e){return e.moderation?e.moderation.flagCount:null},n.quote=function(e){if(0===e.target.length)return null;const t=e.target[0];if(!t.selector)return null;const n=t.selector.find((e=>"TextQuoteSelector"===e.type));return n?n.exact:null},n.hasBeenEdited=function(e){if(!e.updated||!e.created||e.updated===e.created)return!1;const t=new Date(e.created).getTime(),n=new Date(e.updated).getTime();return!isNaN(t)&&!isNaN(n)&&n-t>2e3}},{}],165:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.annotationSharingLink=function(e){var t,n,r,i,s,a;return o(e.uri)?null!==(t=null!==(n=null===(r=e.links)||void 0===r?void 0:r.incontext)&&void 0!==n?n:null===(i=e.links)||void 0===i?void 0:i.html)&&void 0!==t?t:null:null!==(s=null===(a=e.links)||void 0===a?void 0:a.html)&&void 0!==s?s:null},n.pageSharingLink=function(e,t){return o(e)?`https://hyp.is/go?url=${encodeURIComponent(e)}&group=${t}`:null},n.isShareableURI=o,n.sharingEnabled=function(e){const t=(0,r.serviceConfig)(e);return!1!==(null==t?void 0:t.enableShareLinks)};var r=e("../config/service-config");function o(e){return/^http(s?):/i.test(e)}},{"../config/service-config":161}],166:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.annotationDisplayName=function(e,t,n){var o;return(n||t)&&null!==(o=e.user_info)&&void 0!==o&&o.display_name?e.user_info.display_name:(0,r.username)(e.user)};var r=e("./account-id")},{"./account-id":163}],167:[function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){const n=t.selected.length>0,r=t.forcedVisible.length>0;let i=function(e){const t={};e.forEach((e=>{const n=a(e);t[n]=o(o({},s),{},{children:[],annotation:e,id:n})})),e.forEach((e=>{const n=(e.references||[]).filter((t=>t!==e.id));return l(t,a(e),n)}));const n=[];for(const r in t)t[r].parent||(t[r].collapsed=!0,n.push(t[r]));return o(o({},s),{},{id:"root",children:n})}(e);return n&&(i.children=i.children.filter((e=>{const n=t.selected.includes(e.id),o=r&&t.forcedVisible.includes(e.id);return n||o}))),t.threadFilterFn&&(i.children=i.children.filter(t.threadFilterFn)),i.visible=!1,i=u(i,(e=>{let n=e.visible;return t.filterFn&&(n=!(!r||!t.forcedVisible.includes(e.id))||!!e.annotation&&!!t.filterFn(e.annotation)),o(o({},e),{},{visible:n})})),i.children=i.children.filter((e=>e.visible||p(e))),i=u(i,(e=>{const n={collapsed:e.collapsed};if(t.expanded.hasOwnProperty(e.id))n.collapsed=!t.expanded[e.id];else{const r=t.filterFn&&p(e);n.collapsed=e.collapsed&&!r}return o(o({},e),n)})),i=d(i,t.sortCompareFn,h),i=f(i,-1),i};const s={collapsed:!1,depth:0,visible:!0,replyCount:0};function a(e){return e.id||e.$tag}function c(e,t,n){return!(!e[n]||e[n].parent===t)&&(!e[n].parent||c(e,t,e[n].parent))}function l(e,t,n=[]){if(e[t].parent||!n.length)return;const r=n[n.length-1];e[r]||(e[r]=o(o({},s),{},{children:[],id:r}),l(e,r,n.slice(0,-1))),c(e,t,r)&&(e[t].parent=r,e[r].children.push(e[t]))}function u(e,t){return Object.assign({},t(e),{children:e.children.map((e=>u(e,t)))})}function d(e,t,n){const r=e.children.map((e=>d(e,n,n))).slice().sort(t);return o(o({},e),{},{children:r})}function f(e,t){const n=e.children.map((e=>f(e,t+1))),r=n.reduce(((e,t)=>e+1+t.replyCount),0);return o(o({},e),{},{children:n,depth:t,replyCount:r})}function p(e){return e.children.some((e=>e.visible||p(e)))}const h=(e,t)=>e.annotation&&t.annotation?e.annotation.created<t.annotation.created?-1:e.annotation.created>t.annotation.created?1:0:0},{}],168:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.orgName=function(e){return e.organization&&e.organization.name}},{}],169:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){const t=function(e){const t={};return e.forEach((e=>{if("object"!=typeof e.organization)return;const n=function(e){return"__default__"===e.id?"__default__":`${e.name.toLowerCase()}${e.id}`}(e.organization);void 0===t[n]&&(t[n]=Object.assign({},e.organization),t[n].groups=[]),function(e,t){const n=Object.assign({},e),r=t.groups;!r.length&&e.organization.logo&&(n.logo=e.organization.logo),r.push((0,o.default)(n))}(e,t[n])})),t}(e),n=[],r=[];return Object.keys(t).sort().forEach((e=>{"__default__"===e?n.push(...t[e].groups):r.push(...t[e].groups)})),n.length&&r.push(...n),r};var r,o=(r=e("../util/immutable"))&&r.__esModule?r:{default:r}},{"../util/immutable":234}],170:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.combineGroups=function(e,t,n,r){const s=t.find((e=>"__world__"===e.id));s&&e.unshift(s);const a=e.map((e=>e.id));(t=t.filter((e=>!a.includes(e.id)))).forEach((e=>e.isMember=!1)),e.forEach((e=>e.isMember=!0));const c=e.concat(t);return c.forEach((e=>{e.canLeave=!!function(e){const t=(0,i.serviceConfig)(e);return!t||!!t.allowLeavingGroups}(r)&&"private"===e.type})),c.forEach((e=>e.isScopedToUri=function(e,t){return!(e.scopes&&e.scopes.uri_patterns.length>0&&t)||function(e,t){return void 0!==t.find((t=>e.match(t.split("*").map(o.default).join(".*"))))}(t,e.scopes.uri_patterns)}(e,n))),c};var r,o=(r=e("escape-string-regexp"))&&r.__esModule?r:{default:r},i=e("../config/service-config")},{"../config/service-config":161,"escape-string-regexp":22}],171:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isThirdPartyService=function(e){const t=(0,r.serviceConfig)(e);return!(null==t||!t.authority)&&t.authority!==e.authDomain};var r=e("../config/service-config")},{"../config/service-config":161}],172:[function(e,t,n){"use strict";function r(e){return{read:[e],update:[e],delete:[e]}}function o(e,t){return Object.assign(r(e),{read:["group:"+t]})}function i(e){return e.read.some((e=>0===e.indexOf("group:")))}Object.defineProperty(n,"__esModule",{value:!0}),n.privatePermissions=r,n.sharedPermissions=o,n.defaultPermissions=function(e,t,n){return"private"===function(e){switch(e){case"private":case"shared":return e;default:return"shared"}}(n)&&e?r(e):o(e,t)},n.isShared=i,n.isPrivate=function(e){return!i(e)},n.permits=function(e,t,n){return-1!==e[t].indexOf(n||"")}},{}],173:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shouldShowSidebarTutorial=function(e){return!!e.preferences.show_sidebar_tutorial},n.shouldAutoDisplayTutorial=function(e,t,n){const o="object"==typeof t.preferences&&!!t.preferences.show_sidebar_tutorial,i=(0,r.serviceConfig)(n)||{onHelpRequestProvided:!1};return e&&!i.onHelpRequestProvided&&o};var r=e("../config/service-config")},{"../config/service-config":161}],174:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.tabForAnnotation=i,n.shouldShowInTab=function(e,t){return!r.isWaitingToAnchor(e)&&i(e)===t};var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=o(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=i?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=e[s]}return r.default=e,n&&n.set(e,r),r}(e("../helpers/annotation-metadata"));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(o=function(e){return e?n:t})(e)}function i(e){return r.isOrphan(e)?"orphan":r.isPageNote(e)?"note":"annotation"}},{"../helpers/annotation-metadata":164}],175:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.applyTheme=function(e,t){const n={};return t.branding?(e.forEach((e=>{const o=r[e],i=t.branding[e];o&&i&&(n[o]=i)})),n):n};const r={accentColor:"color",appBackgroundColor:"backgroundColor",ctaBackgroundColor:"backgroundColor",ctaTextColor:"color",selectionFontFamily:"fontFamily",annotationFontFamily:"fontFamily"}},{}],176:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=l(e("./build-thread")),o=l(e("../util/memoize")),i=e("../util/search-filter"),s=l(e("./view-filter")),a=e("./tabs"),c=e("./thread-sorters");function l(e){return e&&e.__esModule?e:{default:e}}var u=(0,o.default)((function(e){const t=e.selection,n={expanded:t.expanded,forcedVisible:t.forcedVisible,selected:t.selected,sortCompareFn:c.sorters[t.sortKey]},o=!!t.filterQuery||Object.keys(t.filters).length>0;if(o){const e=(0,i.generateFacetedFilter)(t.filterQuery||"",t.filters);n.filterFn=t=>(0,s.default)([t],e).length>0}return!o&&"sidebar"===e.route&&(n.threadFilterFn=e=>!!e.annotation&&(0,a.shouldShowInTab)(e.annotation,t.selectedTab)),(0,r.default)(e.annotations,n)}));n.default=u},{"../util/memoize":235,"../util/search-filter":242,"./build-thread":167,"./tabs":174,"./thread-sorters":177,"./view-filter":180}],177:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.sorters=void 0;var r=e("./annotation-metadata"),o=e("./thread");function i(e){return(0,o.rootAnnotations)([e]).reduce(((e,t)=>t.created>e?t.created:e),"")}function s(e){return(0,o.rootAnnotations)([e]).reduce(((e,t)=>(e||(e=t.created),t.created<e?t.created:e)),"")}const a={Newest:function(e,t){const n=i(e),r=i(t);return n>r?-1:n<r?1:0},Oldest:function(e,t){const n=s(e),r=s(t);return n<r?-1:n>r?1:0},Location:function(e,t){if(!e.annotation||!t.annotation)return function(e,t){return e.annotation||t.annotation?e.annotation?1:-1:0}(e,t);const n=(0,r.location)(e.annotation),o=(0,r.location)(t.annotation);return n<o?-1:n>o?1:0}};n.sorters=a},{"./annotation-metadata":164,"./thread":178}],178:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.countHidden=function(e){return o(e,!1)},n.countVisible=function(e){return o(e,!0)},n.rootAnnotations=function e(t){const n=t.filter((e=>!!e.annotation)).map((e=>(0,r.notNull)(e.annotation)));if(n.length)return n;const o=[];if(t.forEach((e=>{e.children&&o.push(...e.children)})),o.length)return e(o);throw new Error("Thread contains no annotations")};var r=e("../util/typing");function o(e,t){const n=e.visible===t;return e.children.reduce(((e,n)=>e+o(n,t)),n?1:0)}},{"../util/typing":245}],179:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=class{constructor(e,t,n=window){const r="N/A",o=t.metadata;let i=r;e.userid&&(i=e.userid,e.displayName&&(i=`${e.displayName} (${i})`)),this.version="1.856.0",this.userAgent=n.navigator.userAgent,this.url=t.uri||r,this.fingerprint=o&&o.documentFingerprint?o.documentFingerprint:r,this.account=i,this.timestamp=(new Date).toString()}asFormattedString(){return`Version: ${this.version}\nUser Agent: ${this.userAgent}\nURL: ${this.url}\nFingerprint: ${this.fingerprint}\nAccount: ${this.account}\nDate: ${this.timestamp}\n`}asEncodedURLString(){return encodeURIComponent(this.asFormattedString())}}},{}],180:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){const n=Object.entries(t).filter((([,e])=>e.terms.length>0)).map((([e,t])=>{const n=t.terms.map(s);let r;if("any"===e){const e=["quote","text","tag","user"];r=n.map((t=>new c("or",e.map((e=>new a(e,t,l[e]))))))}else r=n.map((t=>new a(e,t,l[e])));return new c(t.operator,r)})),r=new c("and",n);return e.filter((e=>e.id&&r.matches(e))).map((e=>e.id))};var r=e("./annotation-metadata"),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=o?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=e[s]}return r.default=e,n&&n.set(e,r),r}(e("../util/unicode"));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}function s(e){return"string"!=typeof e?e:o.fold(o.normalize(e)).toLowerCase()}class a{constructor(e,t,n){this.field=e,this.term=t,this.checker=n}matches(e){const t=this.checker;if(t.autofalse&&t.autofalse(e))return!1;let n=t.value(e);return n=Array.isArray(n)?n.map(s):s(n),t.match(this.term,n)}}class c{constructor(e,t){this.operator=e,this.filters=t}matches(e){return"and"===this.operator?this.filters.every((t=>t.matches(e))):this.filters.some((t=>t.matches(e)))}}const l={quote:{autofalse:e=>(e.references||[]).length>0,value:e=>(0,r.quote)(e)||"",match:(e,t)=>t.indexOf(e)>-1},since:{autofalse:e=>"string"!=typeof e.updated,value:e=>new Date(e.updated),match:(e,t)=>(Date.now()-t)/1e3<=e},tag:{autofalse:e=>!Array.isArray(e.tags),value:e=>e.tags,match:(e,t)=>t.includes(e)},text:{autofalse:e=>"string"!=typeof e.text,value:e=>e.text,match:(e,t)=>t.indexOf(e)>-1},uri:{autofalse:e=>"string"!=typeof e.uri,value:e=>e.uri,match:(e,t)=>t.indexOf(e)>-1},user:{autofalse:e=>"string"!=typeof e.user,value:e=>e.user+" "+function(e){return e.user_info&&e.user_info.display_name||""}(e),match:(e,t)=>t.indexOf(e)>-1}}},{"../util/unicode":246,"./annotation-metadata":164}],181:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.calculateVisibleThreads=function(e,t,n,o,i=r){const{defaultHeight:s,marginAbove:a,marginBelow:c}=i,l=[];let u=0,d=0,f=0;return e.forEach((e=>{const r=t[e.id]||s;u+r<n-a?d+=r:u<n+o+c?l.push(e):f+=r,u+=r})),{visibleThreads:l,offscreenUpperHeight:d,offscreenLowerHeight:f}},n.THREAD_DIMENSION_DEFAULTS=void 0;const r={defaultHeight:200,marginAbove:800,marginBelow:800};n.THREAD_DIMENSION_DEFAULTS=r},{}],182:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r={add:e("../images/icons/add.svg"),annotate:e("../images/icons/annotate.svg"),"arrow-left":e("../images/icons/arrow-left.svg"),"arrow-right":e("../images/icons/arrow-right.svg"),cancel:e("../images/icons/cancel.svg"),"caret-right":e("../images/icons/caret-right.svg"),"cc-std":e("../images/icons/cc-std.svg"),"cc-zero":e("../images/icons/cc-zero.svg"),"collapse-menu":e("../images/icons/collapse-menu.svg"),collapsed:e("../images/icons/collapsed.svg"),copy:e("../images/icons/copy.svg"),cursor:e("../images/icons/cursor.svg"),edit:e("../images/icons/edit.svg"),email:e("../images/icons/email.svg"),"expand-menu":e("../images/icons/expand-menu.svg"),error:e("../images/icons/cancel.svg"),external:e("../images/icons/external.svg"),facebook:e("../images/icons/facebook.svg"),flag:e("../images/icons/flag.svg"),"flag--active":e("../images/icons/flag--active.svg"),"format-bold":e("../images/icons/format-bold.svg"),"format-functions":e("../images/icons/format-functions.svg"),"format-italic":e("../images/icons/format-italic.svg"),"format-list-numbered":e("../images/icons/format-list-numbered.svg"),"format-list-unordered":e("../images/icons/format-list-unordered.svg"),"format-quote":e("../images/icons/format-quote.svg"),groups:e("../images/icons/groups.svg"),help:e("../images/icons/help.svg"),highlight:e("../images/icons/highlight.svg"),image:e("../images/icons/image.svg"),leave:e("../images/icons/leave.svg"),link:e("../images/icons/link.svg"),lock:e("../images/icons/lock.svg"),logo:e("../images/icons/logo.svg"),pointer:e("../images/icons/pointer.svg"),profile:e("../images/icons/profile.svg"),public:e("../images/icons/public.svg"),refresh:e("../images/icons/refresh.svg"),restricted:e("../images/icons/restricted.svg"),reply:e("../images/icons/reply.svg"),search:e("../images/icons/search.svg"),share:e("../images/icons/share.svg"),success:e("../images/icons/check.svg"),sort:e("../images/icons/sort.svg"),trash:e("../images/icons/trash.svg"),twitter:e("../images/icons/twitter.svg")};n.default=r},{"../images/icons/add.svg":40,"../images/icons/annotate.svg":41,"../images/icons/arrow-left.svg":42,"../images/icons/arrow-right.svg":43,"../images/icons/cancel.svg":44,"../images/icons/caret-right.svg":45,"../images/icons/cc-std.svg":46,"../images/icons/cc-zero.svg":47,"../images/icons/check.svg":48,"../images/icons/collapse-menu.svg":49,"../images/icons/collapsed.svg":50,"../images/icons/copy.svg":51,"../images/icons/cursor.svg":52,"../images/icons/edit.svg":53,"../images/icons/email.svg":54,"../images/icons/expand-menu.svg":55,"../images/icons/external.svg":56,"../images/icons/facebook.svg":57,"../images/icons/flag--active.svg":58,"../images/icons/flag.svg":59,"../images/icons/format-bold.svg":60,"../images/icons/format-functions.svg":61,"../images/icons/format-italic.svg":62,"../images/icons/format-list-numbered.svg":63,"../images/icons/format-list-unordered.svg":64,"../images/icons/format-quote.svg":65,"../images/icons/groups.svg":66,"../images/icons/help.svg":67,"../images/icons/highlight.svg":68,"../images/icons/image.svg":69,"../images/icons/leave.svg":70,"../images/icons/link.svg":71,"../images/icons/lock.svg":72,"../images/icons/logo.svg":73,"../images/icons/pointer.svg":74,"../images/icons/profile.svg":75,"../images/icons/public.svg":76,"../images/icons/refresh.svg":77,"../images/icons/reply.svg":78,"../images/icons/restricted.svg":79,"../images/icons/search.svg":80,"../images/icons/share.svg":81,"../images/icons/sort.svg":82,"../images/icons/trash.svg":83,"../images/icons/twitter.svg":84}],183:[function(e,t,n){"use strict";var r=e("../boot/parse-json-config"),o=B(e("../shared/renderer-options")),i=e("./cross-origin-rpc.js"),s=R(e("./util/disable-opener-for-external-links")),a=e("./config/fetch-config"),c=B(e("./util/sentry"));e("focus-visible");var l=e("@hypothesis/frontend-shared"),u=R(e("./icons")),d=e("preact"),f=R(e("./components/HypothesisApp")),p=R(e("./components/LaunchErrorPanel")),h=e("./service-context"),m=e("../shared/bridge"),g=e("./services/annotations"),v=e("./services/api"),y=e("./services/api-routes"),_=e("./services/auth"),b=e("./services/autosave"),j=e("./services/features"),w=e("./services/frame-sync"),x=e("./services/groups"),O=e("./services/load-annotations"),S=e("./services/local-storage"),k=e("./services/persisted-defaults"),P=e("./services/router"),E=e("./services/service-url"),A=e("./services/session"),N=e("./services/stream-filter"),T=e("./services/streamer"),C=e("./services/tags"),M=e("./services/threads"),D=e("./services/toast-messenger"),L=e("./store"),I=e("../shared/injector"),F=e("preact/jsx-runtime");function R(e){return e&&e.__esModule?e:{default:e}}function U(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(U=function(e){return e?n:t})(e)}function B(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=U(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var s=o?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(r,i,s):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}const H=(0,r.parseJsonConfig)(document);function $(e,t){e.setClientId(t.clientId)}function z(e,t,n){e.load(),t.load(),n.sync()}function G(e,t,n,r){e.init(),t.init(),n.init(),r.init()}function V(e,t){"sidebar"===t.route()&&e.connect()}H.sentry&&c.init(H.sentry),(0,s.default)(document.body),o.setupBrowserFixes(),$.$inject=["api","streamer"],z.$inject=["groups","session","router"],G.$inject=["autosaveService","features","persistedDefaults","serviceURL"],V.$inject=["frameSync","store"],(0,l.registerIcons)(u.default);const W=document.querySelector("hypothesis-app");(0,i.preStartServer)(),(0,a.fetchConfig)(H).then((e=>{!function(e,t){const n=new I.Injector;n.register("annotationsService",g.AnnotationsService).register("api",v.APIService).register("apiRoutes",y.APIRoutesService).register("auth",_.AuthService).register("autosaveService",b.AutosaveService).register("bridge",m.Bridge).register("features",j.FeaturesService).register("frameSync",w.FrameSyncService).register("groups",x.GroupsService).register("loadAnnotationsService",O.LoadAnnotationsService).register("localStorage",S.LocalStorageService).register("persistedDefaults",k.PersistedDefaultsService).register("router",P.RouterService).register("serviceURL",E.ServiceURLService).register("session",A.SessionService).register("streamer",T.StreamerService).register("streamFilter",N.StreamFilter).register("tags",C.TagsService).register("threadsService",M.ThreadsService).register("toastMessenger",D.ToastMessengerService).register("store",{factory:L.createSidebarStore}),n.register("$window",{value:window}).register("settings",{value:e}),n.run(G),n.run($),n.run(z),n.run(i.startServer),n.run(V),(0,d.render)((0,F.jsx)(h.ServiceContext.Provider,{value:n,children:(0,F.jsx)(f.default,{})}),t)}(e,W)})).catch((e=>{console.error("Failed to start Hypothesis client: ",e),(0,d.render)((0,F.jsx)(p.default,{error:e}),W)}))},{"../boot/parse-json-config":39,"../shared/bridge":86,"../shared/injector":87,"../shared/renderer-options":90,"./components/HypothesisApp":119,"./components/LaunchErrorPanel":120,"./config/fetch-config":158,"./cross-origin-rpc.js":162,"./icons":182,"./service-context":188,"./services/annotations":189,"./services/api":191,"./services/api-routes":190,"./services/auth":192,"./services/autosave":193,"./services/features":194,"./services/frame-sync":195,"./services/groups":196,"./services/load-annotations":197,"./services/local-storage":198,"./services/persisted-defaults":199,"./services/router":200,"./services/service-url":201,"./services/session":202,"./services/stream-filter":203,"./services/streamer":204,"./services/tags":205,"./services/threads":206,"./services/toast-messenger":207,"./store":210,"./util/disable-opener-for-external-links":231,"./util/sentry":243,"@hypothesis/frontend-shared":18,"focus-visible":23,preact:26,"preact/jsx-runtime":28}],184:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.convertSelectionToLink=function(e,t=r.ANCHOR_LINK){const n=e.text.slice(e.selectionStart,e.selectionEnd);let i,s="";if(t===r.IMAGE_LINK&&(s="!"),n.match(/[a-z]+:\/\/.*/)){const t="Description";return i=o(e,e.selectionStart,n.length,s+"["+t+"]("+n+")"),i.selectionStart=e.selectionStart+s.length+1,i.selectionEnd=i.selectionStart+t.length,i}{const t=s+"["+n+"](",r="http://insert-your-link-here.com";return i=o(e,e.selectionStart,n.length,t+r+")"),i.selectionStart=e.selectionStart+t.length,i.selectionEnd=i.selectionStart+r.length,i}},n.toggleSpanStyle=function(e,t,n,r){void 0===n&&(n=t);const i=e.text.slice(e.selectionStart-t.length,e.selectionStart),s=e.text.slice(e.selectionEnd,e.selectionEnd+t.length);let a=e;return e.selectionStart===e.selectionEnd&&r&&(a=o(e,e.selectionStart,0,r),a.selectionStart=a.selectionEnd-r.length),i===t&&s===n?(a=o(a,a.selectionStart-t.length,t.length,""),a=o(a,a.selectionEnd,n.length,"")):(a=o(a,a.selectionStart,0,t),a=o(a,a.selectionEnd,0,n)),a},n.toggleBlockStyle=function(e,t){const n=e.selectionStart,r=e.selectionEnd;let i=!0;return s(e,n,r,((e,n)=>(e.text.slice(n,n+t.length)!==t&&(i=!1),e))),s(e,n,r,i?(e,n)=>o(e,n,t.length,""):(e,n)=>e.text.slice(n,n+t.length)===t?e:o(e,n,0,t))},n.LinkType=void 0;const r={ANCHOR_LINK:0,IMAGE_LINK:1};function o(e,t,n,r){let o=e.selectionStart,i=e.selectionEnd;return o>=t+n?(o+=r.length-n,i+=r.length-n):i<=t||(o<=t&&i>=t+n?i+=r.length-n:o<t&&i<t+n?o=t:o<t+n&&i>t+n?i+=r.length-n:t<o&&t+n>i&&(o=t,i=t+n)),{text:e.text.slice(0,t)+r+e.text.slice(t+n),selectionStart:o,selectionEnd:i}}function i(e,t){const n=e.indexOf("\n",t);return n<0?e.length:n}function s(e,t,n,r){let o=function(e,t){const n=e.lastIndexOf("\n",t);return n<0?0:n+1}(e.text,t),s=i(e.text,t);for(;s<=i(e.text,n);){const t=s===e.text.length,a=s-o,c=i((e=r(e,o,s)).text,o)-o;if(n+=c-a,t)break;o=o+c+1,s=i(e.text,o)}return e}n.LinkType=r},{}],185:[function(e,t,n){"use strict";function r(e,t=16/9){const n=document.createElement("iframe");return n.src=e,n.setAttribute("frameborder","0"),n.setAttribute("allowfullscreen",""),function(e,t){e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%";const n=document.createElement("div");return n.style.paddingBottom=1/t*100+"%",n.style.position="relative",n.appendChild(e),n}(n,t)}function o(e){const t=/(\d+)([hms]?)/g,n={h:3600,m:60,s:1};let r,o=0;for(;null!==(r=t.exec(e));)r[2]?o+=Number(r[1])*n[r[2]]:o+=+r[1];return o.toString()}function i(e,t){return r(`https://www.youtube.com/embed/${e}${function(e){const t=["end","start","t"],n=new URLSearchParams(e.search),r=new URLSearchParams;for(let[s,a]of n)t.includes(s)&&("t"===s?r.append("start",o(a)):r.append(s,a));r.sort();let i=r.toString();return i&&(i=`?${i}`),i}(t)}`)}function s(e,t,n,{aspectRatio:o}={}){return i=>{if(i.hostname!==e)return null;const s=t.exec(i.pathname);if(!s)return null;const a=s[1];return r(n(a),o)}}Object.defineProperty(n,"__esModule",{value:!0}),n.replaceLinksWithEmbeds=function(e,{className:t}={}){const n=Array.from(e.getElementsByTagName("a"));for(let r of n){const e=c(r);e&&(t?e.className=t:e.style.width="350px")}};const a=[function(e){if("www.youtube.com"!==e.hostname)return null;if(!/\/watch\/?/.test(e.pathname))return null;const t=/[&?]v=([^&#]+)/.exec(e.search);return t?i(t[1],e):null},function(e){if("youtu.be"!==e.hostname)return null;const t=/^\/([^/]+)\/?$/.exec(e.pathname);return t?i(t[1],e):null},s("vimeo.com",/^\/([^/?#]+)\/?$/,(e=>`https://player.vimeo.com/video/${e}`)),s("vimeo.com",/^\/channels\/[^/]+\/([^/?#]+)\/?$/,(e=>`https://player.vimeo.com/video/${e}`)),s("flipgrid.com",/^\/s\/([^/]+)$/,(e=>`https://flipgrid.com/s/${e}?embed=true`)),function(e){if("archive.org"!==e.hostname)return null;const t=/^\/(embed|details)\/(.+)/.exec(e.pathname);if(!t)return null;let n=t[2];const o=new URLSearchParams(e.search);let i=o.get("start"),s=o.get("end");if(!i){const e=n.match(/\/start\/([^/]+)/);e&&(i=e[1],n=n.replace(e[0],""))}if(!s){const e=n.match(/\/end\/([^/]+)/);e&&(s=e[1],n=n.replace(e[0],""))}const a=new URL(`https://archive.org/embed/${n}`);return i&&a.searchParams.append("start",i),s&&a.searchParams.append("end",s),r(a.href)},function(e){return e.pathname.endsWith(".mp3")||e.pathname.endsWith(".ogg")||e.pathname.endsWith(".wav")?function(e){const t=document.createElement("audio");return t.controls=!0,t.src=e,t}(e.href):null}];function c(e){if(e.href!==e.textContent&&decodeURI(e.href)!==e.textContent)return null;const t=function(e){let t,n;for(n=0;n<a.length;n++)if(t=a[n](e),t)return t;return null}(e);return t&&e.parentElement.replaceChild(t,e),t}},{}],186:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){const t=function(e){const t=[];let n=0,r=e;for(;;){const e=r.indexOf("$$",n),o=r.indexOf("\\(",n);if(-1===e&&-1===o)break;let i,s;if(-1!==e&&(-1===o||e<o)?(i=e,s=r.indexOf("$$",i+2)):(i=o,s=r.indexOf("\\)",i+2)),-1===s)break;s+=2;const a=t.length+1,c=f(a);let l;t.push({id:a,expression:r.slice(i+2,s-2),inline:-1!==o}),l=-1!==o?c:"\n\n"+c+"\n\n",r=r.slice(0,i)+l+r.slice(s),n=i+l.length}return{mathBlocks:t,content:r}}(e);return function(e,t){return t.reduce(((e,t)=>{let n;try{n=t.inline?i.renderToString(t.expression):i.renderToString(t.expression,{displayMode:!0})}catch(r){n=(0,o.default)(t.expression)}return e.replace(f(t.id),n)}),e)}(l.sanitize(function(e){return d||(d=new s.default.Converter({extensions:[u],simplifiedAutoLink:!0,literalMidWordUnderscores:!0,strikethrough:!0})),d.makeHtml(e)}(t.content)),t.mathBlocks)};var r=c(e("dompurify")),o=c(e("escape-html")),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var s=o?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(r,i,s):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}(e("katex")),s=c(e("showdown"));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}function c(e){return e&&e.__esModule?e:{default:e}}const l=(0,r.default)(window);function u(){return[{type:"output",filter:function(e){return e.replace(/<a href=/g,'<a target="_blank" href=')}}]}let d;function f(e){return"{math:"+e.toString()+"}"}l.addHook("afterSanitizeAttributes",(e=>{"target"in e&&e.setAttribute("target","_blank")}))},{dompurify:20,"escape-html":21,katex:"katex",showdown:"showdown"}],187:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SearchClient=n.ResultSizeError=void 0;var r=e("tiny-emitter");function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class s extends Error{constructor(e){super(`Results size exceeds ${e}`)}}function a(e){return 0===e?50:200}n.ResultSizeError=s;class c extends r.TinyEmitter{constructor(e,{getPageSize:t=a,separateReplies:n=!0,incremental:r=!0,maxResults:o=null,sortBy:i="created",sortOrder:s="asc"}={}){super(),this._searchFn=e,this._getPageSize=t,this._separateReplies=n,this._incremental=r,this._maxResults=o,this._sortBy=i,this._sortOrder=s,this._canceled=!1,this._results=[],this._resultCount=null}async _getPage(e,t,n=0){const r=this._getPageSize(n),a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({limit:r,sort:this._sortBy,order:this._sortOrder,_separate_replies:this._separateReplies},e);t&&(a.search_after=t);try{const t=await this._searchFn(a);if(this._canceled)return;if(null===this._resultCount&&(this._resultCount=t.total,this.emit("resultCount",this._resultCount)),this._maxResults&&t.total>this._maxResults)return this.emit("error",new s(this._maxResults)),void this.emit("end");const o=t.rows.concat(t.replies||[]);this._incremental?this.emit("results",o):this._results=this._results.concat(o);const i=o.length===r,c=o.length>0?o[o.length-1][this._sortBy]:null;i&&c?this._getPage(e,c,n+1):(this._incremental||this.emit("results",this._results),this.emit("end"))}catch(c){if(this._canceled)return;this.emit("error",c),this.emit("end")}}get(e){this._results=[],this._resultCount=null,this._getPage(e)}cancel(){this._canceled=!0,this.emit("end")}}n.SearchClient=c},{"tiny-emitter":37}],188:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.withServices=function(e,t){function n(n){const r=(0,o.useContext)(u),s={};for(let e of t)e in n||(s[e]=r.get(e));return(0,i.jsx)(e,a(a({},s),n))}const r=e.displayName||e.name;return n.displayName=`withServices(${r})`,n},n.useService=function(e){return(0,o.useContext)(u).get(e)},n.ServiceContext=void 0;var r=e("preact"),o=e("preact/hooks"),i=e("preact/jsx-runtime");function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const l={get(e){throw new Error(`Missing ServiceContext provider to provide "${e}" prop`)}},u=(0,r.createContext)(l);n.ServiceContext=u},{preact:26,"preact/hooks":27,"preact/jsx-runtime":28}],189:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationsService=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}(e("../helpers/annotation-metadata")),o=e("../helpers/permissions"),i=e("../util/random");function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class u{constructor(e,t){this._api=e,this._store=t}_applyDraftChanges(e){const t={},n=this._store.getDraft(e);return n&&(t.tags=n.tags,t.text=n.text,t.permissions=n.isPrivate?(0,o.privatePermissions)(e.user):(0,o.sharedPermissions)(e.user,e.group)),c(c({},e),t)}_initialize(e,t=new Date){const n=this._store.getDefault("annotationPrivacy"),s=this._store.focusedGroupId(),a=this._store.profile();if(!s)throw new Error("Cannot create annotation without a group");const c=a.userid,l=a.user_info,u=(0,i.generateHexString)(8),d=Object.assign({created:t.toISOString(),group:s,permissions:(0,o.defaultPermissions)(c,s,n),tags:[],text:"",updated:t.toISOString(),user:c,user_info:l,$tag:u,hidden:!1,links:{}},e);return r.isHighlight(d)&&(d.permissions=(0,o.privatePermissions)(c)),d}create(e,t=new Date){const n=this._initialize(e,t);this._store.addAnnotations([n]),this._store.deleteNewAndEmptyDrafts(),r.isHighlight(n)||this._store.createDraft(n,{tags:n.tags,text:n.text,isPrivate:!r.isPublic(n)}),r.isPageNote(n)?this._store.selectTab("note"):r.isAnnotation(n)&&this._store.selectTab("annotation"),(n.references||[]).forEach((e=>{this._store.setExpanded(e,!0)}))}createPageNote(){const e=this._store.mainFrame();if(!this._store.isLoggedIn())return void this._store.openSidebarPanel("loginPrompt");if(!e)return;const t={target:[],uri:e.uri};this.create(t)}async delete(e){await this._api.annotation.delete({id:e.id}),this._store.removeAnnotations([e])}async flag(e){await this._api.annotation.flag({id:e.id}),this._store.updateFlagStatus(e.id,!0)}reply(e,t){const n={group:e.group,permissions:r.isPublic(e)?(0,o.sharedPermissions)(t,e.group):(0,o.privatePermissions)(t),references:(e.references||[]).concat(e.id),target:[{source:e.target[0].source}],uri:e.uri};this.create(n)}async save(e){let t;const n=this._applyDraftChanges(e);let o;t=r.isNew(e)?this._api.annotation.create({},n):this._api.annotation.update({id:e.id},n),this._store.annotationSaveStarted(e);try{o=await t}finally{this._store.annotationSaveFinished(e)}return Object.keys(e).forEach((t=>{"$"===t[0]&&(o[t]=e[t])})),this._store.removeDraft(e),this._store.addAnnotations([o]),o}}n.AnnotationsService=u,u.$inject=["api","store"]},{"../helpers/annotation-metadata":164,"../helpers/permissions":172,"../util/random":240}],190:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.APIRoutesService=void 0;var r=e("../util/fetch"),o=e("../util/retry");function i(e){return(0,o.retryPromiseOperation)((()=>(0,r.fetchJSON)(e)))}class s{constructor(e){this._apiUrl=e.apiUrl,this._routeCache=null,this._linkCache=null}routes(){return this._routeCache||(this._routeCache=i(this._apiUrl).then((e=>e.links))),this._routeCache}links(){return this._linkCache||(this._linkCache=this.routes().then((e=>i(e.links.url)))),this._linkCache}}n.APIRoutesService=s,s.$inject=["settings"]},{"../util/fetch":233,"../util/retry":241}],191:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.APIService=void 0;var r=e("../util/fetch"),o=e("../util/url");function i(e){const t={};for(const n in e)e.hasOwnProperty(n)&&"$"!==n[0]&&(t[n]=e[n]);return t}class s{constructor(e,t,n){const s=e.routes();this._clientId=null;const a=()=>this._clientId,c=e=>function(e,t,{getAccessToken:n,getClientId:s,onRequestStarted:a,onRequestFinished:c}){return async(l,u)=>{a();try{const[a,d]=await Promise.all([e,n()]),f=function(e,t){let n=e;return t.split(".").forEach((e=>{n=n[e]})),n}(a,t),p={"Content-Type":"application/json","Hypothesis-Client-Version":"1.856.0"};d&&(p.Authorization="Bearer "+d);const h=s();h&&(p["X-Client-Id"]=h);const{url:m,unusedParams:g}=(0,o.replaceURLParams)(f.url,l),v=new URL(m);for(let[e,t]of Object.entries(g)){Array.isArray(t)||(t=[t]);for(let n of t)null!=n&&v.searchParams.append(e,n.toString())}return await(0,r.fetchJSON)(v.toString(),{body:u?JSON.stringify(i(u)):null,headers:p,method:f.method})}finally{c()}}}(s,e,{getAccessToken:t.getAccessToken,getClientId:a,onRequestStarted:n.apiRequestStarted,onRequestFinished:n.apiRequestFinished});this.search=c("search"),this.annotation={create:c("annotation.create"),delete:c("annotation.delete"),get:c("annotation.read"),update:c("annotation.update"),flag:c("annotation.flag"),hide:c("annotation.hide"),unhide:c("annotation.unhide")},this.group={member:{delete:c("group.member.delete")},read:c("group.read")},this.groups={list:c("groups.read")},this.profile={groups:{read:c("profile.groups.read")},read:c("profile.read"),update:c("profile.update")}}setClientId(e){this._clientId=e}}n.APIService=s,s.$inject=["apiRoutes","auth","store"]},{"../util/fetch":233,"../util/url":247}],192:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AuthService=void 0;var r,o=e("tiny-emitter"),i=e("../config/service-config"),s=(r=e("../util/oauth-client"))&&r.__esModule?r:{default:r},a=e("../util/url");class c extends o.TinyEmitter{constructor(e,t,n,r,o){let c,l,u;super();const d=(0,a.resolve)("token",r.apiUrl);function f(){let e=new URL(r.apiUrl).hostname;return e=e.replace(/\./g,"%2E"),`hypothesis.oauth.${e}.token`}function p(e){n.setObject(f(),e)}const h=async function(){if(u)return u;const e=await t.links();return u=new s.default({clientId:r.oauthClientId,authorizationEndpoint:e["oauth.authorize"],revokeEndpoint:e["oauth.revoke"],tokenEndpoint:d}),u},m=()=>{var e;return null===(e=(0,i.serviceConfig)(r))||void 0===e?void 0:e.grantToken};(()=>{e.addEventListener("storage",(({key:e})=>{e===f()&&(l=null,this.emit("oauthTokensChanged"))}))})(),this.login=async function(){const t=s.default.openAuthPopupWindow(e),n=await h(),r=await n.authorize(e,t);c=r,l=null},this.logout=async function(){const[e,t]=await Promise.all([l,h()]);e&&await t.revokeToken(e.accessToken),l=Promise.resolve(null),n.removeItem(f())},this.getAccessToken=async function e(){if(!l){const e=m();void 0!==e?l=e?h().then((t=>t.exchangeGrantToken(e))).catch((e=>{throw"You must reload the page to annotate.",o.error("Hypothesis login lost: You must reload the page to annotate.",{autoDismiss:!1}),e})):Promise.resolve(null):c?(l=async function(e){const t=await h(),n=await t.exchangeAuthCode(e);return p(n),n}(c),c=null):l=Promise.resolve(function(){const e=n.getObject(f());return e&&"string"==typeof e.accessToken&&"string"==typeof e.refreshToken&&"number"==typeof e.expiresAt?{accessToken:e.accessToken,refreshToken:e.refreshToken,expiresAt:e.expiresAt}:null}())}const t=l,r=await l;if(!r)return null;if(t!==l)return e();if(Date.now()>r.expiresAt){const t=m();return l=async function(e,t){const n=await h();let r;try{if(r=await n.refreshToken(e),Date.now()>r.expiresAt)throw new Error("Refreshed token expired in the past")}catch(o){return null}return t.persist&&p(r),r}(r.refreshToken,{persist:void 0===t}),e()}return r.accessToken}}}n.AuthService=c,c.$inject=["$window","apiRoutes","localStorage","settings","toastMessenger"]},{"../config/service-config":161,"../util/oauth-client":236,"../util/url":247,"tiny-emitter":37}],193:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AutosaveService=void 0;var r=e("../util/retry");class o{constructor(e,t){this._annotationsService=e,this._store=t,this._saving=new Set,this._failed=new Set}init(){const e=e=>!this._saving.has(e)&&!this._failed.has(e);this._store.subscribe((()=>{this._store.newHighlights().forEach((t=>{const n=t.$tag;e(n)&&(this._saving.add(n),(0,r.retryPromiseOperation)((()=>this._annotationsService.save(t))).catch((()=>{this._failed.add(n)})).finally((()=>{this._saving.delete(n)})))}))}))}isSaving(){return this._saving.size>0}}n.AutosaveService=o,o.$inject=["annotationsService","store"]},{"../util/retry":241}],194:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.FeaturesService=void 0;var r,o=(r=e("../../shared/bridge-events"))&&r.__esModule?r:{default:r},i=e("../util/watch");class s{constructor(e,t){this._bridge=e,this._store=t}init(){const e=()=>this._store.profile().features;(0,i.watch)(this._store.subscribe,[e,()=>this._store.frames()],(()=>{this._bridge.call(o.default.FEATURE_FLAGS_UPDATED,e()||{})}))}}n.FeaturesService=s,s.$inject=["bridge","store"]},{"../../shared/bridge-events":85,"../util/watch":248}],195:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.formatAnnot=c,n.FrameSyncService=void 0;var r=a(e("lodash.debounce")),o=a(e("../../shared/bridge-events")),i=e("../helpers/annotation-metadata"),s=e("../util/watch");function a(e){return e&&e.__esModule?e:{default:e}}function c(e){return{tag:e.$tag,msg:{document:e.document,target:e.target,uri:e.uri}}}class l{constructor(e,t,n,a){this._bridge=n,this._store=a,this._window=e;const l=new Set;this._setupSyncToFrame=()=>{let e=0;(0,s.watch)(a.subscribe,[()=>a.allAnnotations(),()=>a.frames()],(([t,r],[s])=>{let a=0;const u=new Set,d=[];t.forEach((e=>{(0,i.isReply)(e)||((0,i.isPublic)(e)&&++a,u.add(e.$tag),l.has(e.$tag)||d.push(e))}));const f=s.filter((e=>!u.has(e.$tag)));d.length>0&&(n.call("loadAnnotations",d.map(c)),d.forEach((e=>{l.add(e.$tag)}))),f.forEach((e=>{n.call("deleteAnnotation",c(e)),l.delete(e.$tag)})),r.length>0&&r.every((e=>e.isAnnotationFetchComplete))&&(0!==a&&a===e||(n.call(o.default.PUBLIC_ANNOTATION_COUNT_CHANGED,a),e=a))}))},this._setupSyncFromFrame=()=>{n.on("beforeCreateAnnotation",(e=>{const r=Object.assign({},e.msg,{$tag:e.tag});if(!a.isLoggedIn())return n.call("openSidebar"),a.openSidebarPanel("loginPrompt"),void n.call("deleteAnnotation",c(r));l.add(e.tag),t.create(r)})),n.on("destroyFrame",(e=>(e=>{const t=a.frames().find((t=>t.id===e));t&&a.destroyFrame(t)})(e)));let e={};const o=(0,r.default)((()=>{a.updateAnchorStatus(e),e={}}),10);n.on("sync",(t=>{t.forEach((t=>{l.add(t.tag),e[t.tag]=t.msg.$orphan?"orphan":"anchored",o()}))})),n.on("showAnnotations",(e=>{a.selectAnnotations(a.findIDsForTags(e)),a.selectTab("annotation")})),n.on("focusAnnotations",(e=>{a.focusAnnotations(e||[])})),n.on("toggleAnnotationSelection",(e=>{a.toggleSelectedAnnotations(a.findIDsForTags(e))})),n.on("sidebarOpened",(()=>{a.setSidebarOpened(!0)})),n.on("openSidebar",(()=>{n.call("openSidebar")})),n.on("closeSidebar",(()=>{n.call("closeSidebar")})),n.on("setVisibleHighlights",(e=>{n.call("setVisibleHighlights",e)}))}}connect(){this._bridge.onConnect((e=>{e.call("getDocumentInfo",((t,n)=>{t?e.destroy():this._store.connectFrame({id:n.frameIdentifier,metadata:n.metadata,uri:n.uri})}))})),this._window.addEventListener("message",(e=>{var t;if("hypothesisGuestReady"!==(null===(t=e.data)||void 0===t?void 0:t.type))return;if(0===e.ports.length)return void console.warn("Ignoring `hypothesisGuestReady` message without a MessagePort");const n=e.ports[0];this._bridge.createChannel(n)})),this._window.parent.postMessage({type:"hypothesisSidebarReady"},"*"),this._setupSyncToFrame(),this._setupSyncFromFrame()}focusAnnotations(e){this._store.focusAnnotations(e),this._bridge.call("focusAnnotations",e)}scrollToAnnotation(e){this._bridge.call("scrollToAnnotation",e)}}n.FrameSyncService=l,l.$inject=["$window","annotationsService","bridge","store"]},{"../../shared/bridge-events":85,"../helpers/annotation-metadata":164,"../util/watch":248,"lodash.debounce":24}],196:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.GroupsService=void 0;var r=e("../config/service-config"),o=e("../helpers/annotation-metadata"),i=e("../helpers/groups"),s=e("../store/util"),a=e("../util/watch");function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const d={id:"__default__",name:"__DEFAULT__",logo:"data:image/svg+xml;utf8,"+encodeURIComponent(e("../../images/icons/logo.svg"))};const f=["organization","scopes"];class p{constructor(e,t,n,o,i,s){this._store=e,this._api=t,this._auth=n,this._settings=i,this._toastMessenger=s,this._serviceConfig=(0,r.serviceConfig)(i),this._reloadSetUp=!1}_mainURI(){var e,t;return null!==(e=null===(t=this._store.mainFrame())||void 0===t?void 0:t.uri)&&void 0!==e?e:null}async _filterGroups(e,t,n,r){if(r){const t=e.find((e=>e.id===r));t&&!t.isScopedToUri&&t.scopes&&t.scopes.enforced&&(e=e.filter((e=>e.id!==r)),this._store.setDirectLinkedGroupFetchFailed(),r=null)}return t?e:e.some((e=>"__world__"!==e.id&&e.isScopedToUri))?"__world__"===r||"__world__"===n?e:e.filter((e=>"__world__"!==e.id)):e}_setupAutoReload(){this._reloadSetUp||(this._reloadSetUp=!0,(0,a.watch)(this._store.subscribe,(()=>this._mainURI()),(()=>{this.load()})),(0,a.watch)(this._store.subscribe,[()=>this._store.hasFetchedProfile(),()=>this._store.profile().userid],((e,[t])=>{t&&this.load()})))}_addGroupsToStore(e,t){!function(e){e.forEach((e=>{e.organization&&"object"==typeof e.organization||(e.organization=d)}))}(e);const n=0===this._store.allGroups().length,r=this._store.getDefault("focusedGroup");this._store.loadGroups(e),n&&(t&&e.some((e=>e.id===t))?this.focus(t):r&&e.some((e=>e.id===r))&&this.focus(r))}_fetchGroup(e){return this._api.group.read({id:e,expand:f})}async _loadGroupsForUserAndDocument(){var e;let t=null;"sidebar"===this._store.route()&&(t=await(()=>(0,s.awaitStateChange)(this._store,(()=>this._mainURI())))()),this._setupAutoReload();const n=this._store.directLinkedAnnotationId();let r=null;n&&(r=this._api.annotation.get({id:n}).catch((()=>null)));const o=this._store.directLinkedGroupId();let a=null;o&&(a=this._fetchGroup(o).then((e=>(this._store.clearDirectLinkedGroupFetchFailed(),e))).catch((()=>(this._store.setDirectLinkedGroupFetchFailed(),null))));const c={expand:f},l=null===(e=this._serviceConfig)||void 0===e?void 0:e.authority;l&&(c.authority=l),t&&(c.document_uri=t);const[u,d,p,h,m]=await Promise.all([this._api.profile.groups.read({expand:f}),this._api.groups.list(c),this._auth.getAccessToken(),r,a]);m&&!d.some((e=>e.id===m.id))&&d.push(m);let g=null;if(h&&(g=h.group,!u.concat(d).find((e=>e.id===h.group))))try{const e=await this._fetchGroup(h.group);d.push(e)}catch(b){this._toastMessenger.error("Unable to fetch group for linked annotation")}const v=null!==p,y=await this._filterGroups((0,i.combineGroups)(u,d,t,this._settings),v,g,o),_=g||o||null;return this._addGroupsToStore(y,_),y}async _loadServiceSpecifiedGroups(e){var t=this;const n=await this._api.profile.groups.read({expand:f});let r;const o=(await Promise.all(e.map((e=>n.find((t=>t.id===e||t.groupid===e))||async function(e){try{return await t._fetchGroup(e)}catch(n){return r=n,null}}(e))))).filter((e=>null!==e)),i=this._store.directLinkedGroupId();return this._addGroupsToStore(o,i),r&&this._toastMessenger.error(`Unable to fetch groups: ${r.message}`,{autoDismiss:!1}),o}async load(){var e;if(null!==(e=this._serviceConfig)&&void 0!==e&&e.groups){let e=[];try{e=await this._serviceConfig.groups}catch(t){this._toastMessenger.error(`Unable to fetch group configuration: ${t.message}`)}return this._loadServiceSpecifiedGroups(e)}return this._loadGroupsForUserAndDocument()}focus(e){const t=this._store.focusedGroupId();this._store.focusGroup(e);const n=this._store.focusedGroupId();if(t!==n&&null!==t&&n){const e=this._store.newAnnotations().filter((e=>!(0,o.isReply)(e))).map((e=>l(l({},e),{},{group:n})));e.length&&this._store.addAnnotations(e),this._store.setDefault("focusedGroup",n)}}leave(e){return this._api.group.member.delete({pubid:e,userid:"me"})}}n.GroupsService=p,p.$inject=["store","api","auth","session","settings","toastMessenger"]},{"../../images/icons/logo.svg":73,"../config/service-config":161,"../helpers/annotation-metadata":164,"../helpers/groups":170,"../store/util":228,"../util/watch":248}],197:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LoadAnnotationsService=void 0;var r=e("../helpers/annotation-metadata"),o=e("../search-client");class i{constructor(e,t,n,r){this._api=e,this._store=t,this._streamer=n,this._streamFilter=r,this._searchClient=null}load({groupId:e,uris:t,onError:n,maxResults:r,sortBy:i,sortOrder:s,streamFilterBy:a="uri"}){switch(this._store.removeAnnotations(this._store.savedAnnotations()),this._searchClient&&this._searchClient.cancel(),a){case"group":this._streamFilter.resetFilter().addClause("/group","equals",e,!0),this._streamer.setConfig("filter",{filter:this._streamFilter.getFilter()});break;case"uri":default:t&&t.length>0&&(this._streamFilter.resetFilter().addClause("/uri","one_of",t),this._streamer.setConfig("filter",{filter:this._streamFilter.getFilter()}))}const c={incremental:!0,separateReplies:!1,maxResults:r,sortBy:i,sortOrder:s};this._searchClient=new o.SearchClient(this._api.search,c),this._searchClient.on("resultCount",(e=>{this._store.setAnnotationResultCount(e)})),this._searchClient.on("results",(e=>{e.length&&this._store.addAnnotations(e)})),this._searchClient.on("error",(e=>{"function"==typeof n?n(e):console.error(e)})),this._searchClient.on("end",(()=>{this._searchClient=null,t&&t.length>0&&this._store.frames().forEach((e=>{t.indexOf(e.uri)>=0&&this._store.updateFrameAnnotationFetchStatus(e.uri,!0)})),this._store.annotationFetchFinished()})),this._store.annotationFetchStarted(),this._searchClient.get({group:e,uri:t})}async loadThread(e){let t,n;this._store.clearAnnotations();try{this._store.annotationFetchStarted(),t=await this._api.annotation.get({id:e}),(0,r.isReply)(t)&&(t=await this._api.annotation.get({id:t.references[0]})),n=await this._api.search({references:t.id})}finally{this._store.annotationFetchFinished()}const o=[t,...n.rows];if(this._store.addAnnotations(o),!(0,r.isReply)(t)){const e=t.id;this._streamFilter.addClause("/references","one_of",e,!0).addClause("/id","equals",e,!0),this._streamer.setConfig("filter",{filter:this._streamFilter.getFilter()}),this._streamer.connect()}return o}}n.LoadAnnotationsService=i,i.$inject=["api","store","streamer","streamFilter"]},{"../helpers/annotation-metadata":164,"../search-client":187}],198:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LocalStorageService=void 0;class r{constructor(){this._store={}}getItem(e){return e in this._store?this._store[e]:null}setItem(e,t){this._store[e]=t}removeItem(e){delete this._store[e]}}class o{constructor(e){let t="hypothesis.testKey";try{this._storage=e.localStorage,e.localStorage.setItem(t,t),e.localStorage.getItem(t),e.localStorage.removeItem(t)}catch(n){this._storage=new r}}getItem(e){return this._storage.getItem(e)}getObject(e){const t=this._storage.getItem(e);return t?JSON.parse(t):null}setItem(e,t){this._storage.setItem(e,t)}setObject(e,t){const n=JSON.stringify(t);this._storage.setItem(e,n)}removeItem(e){this._storage.removeItem(e)}}n.LocalStorageService=o,o.$inject=["$window"]},{}],199:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.PersistedDefaultsService=void 0;var r=e("../util/watch");const o={annotationPrivacy:"hypothesis.privacy",focusedGroup:"hypothesis.groups.focus"};class i{constructor(e,t){this._storage=e,this._store=t}init(){Object.keys(o).forEach((e=>{const t=this._storage.getItem(o[e]);this._store.setDefault(e,t)})),(0,r.watch)(this._store.subscribe,(()=>this._store.getDefaults()),((e,t)=>{for(let n in e)t[n]!==e[n]&&n in o&&this._storage.setItem(o[n],e[n])}))}}n.PersistedDefaultsService=i,i.$inject=["localStorage","store"]},{"../util/watch":248}],200:[function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(n,"__esModule",{value:!0}),n.RouterService=void 0;class i{constructor(e,t){this._window=e,this._store=t,this._didRegisterPopstateListener=!1}currentRoute(){const e=this._window.location.pathname.slice(1).split("/"),t=new URLSearchParams(this._window.location.search),n={};for(let[o,i]of t)n[o]=i;let r;switch("client"===e[0]&&e.shift(),e[0].replace(/\.html$/,"")){case"a":r="annotation",n.id=e[1]||"";break;case"notebook":r="notebook";break;case"stream":r="stream";break;default:r="sidebar"}return{route:r,params:n}}routeUrl(e,t={}){let n;const i=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t);switch(e){case"annotation":{const e=t.id;delete i.id,n=`/a/${e}`}break;case"notebook":n="/notebook";break;case"stream":n="/stream";break;default:throw new Error(`Cannot generate URL for route "${e}"`)}let s=!1;const a=new URLSearchParams;for(let[r,o]of Object.entries(i))s=!0,a.set(r,o);return s&&(n+="?"+a.toString()),n}sync(){const{route:e,params:t}=this.currentRoute();this._store.changeRoute(e,t),this._didRegisterPopstateListener||(this._window.addEventListener("popstate",(()=>{this.sync()})),this._didRegisterPopstateListener=!0)}navigate(e,t){this._window.history.pushState({},"",this.routeUrl(e,t)),this.sync()}}n.RouterService=i,i.$inject=["$window","store"]},{}],201:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ServiceURLService=void 0;class r{constructor(e,t){this._apiRoutes=e,this._store=t}async init(){try{const e=await this._apiRoutes.links();this._store.updateLinks(e)}catch(e){console.warn(`Failed to fetch Hypothesis links: ${e.message}`)}}}n.ServiceURLService=r,r.$inject=["apiRoutes","store"]},{}],202:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SessionService=void 0;var r=e("../config/service-config"),o=e("../util/retry"),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}(e("../util/sentry"));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}class a{constructor(e,t,n,o,i){var s,a;this._api=t,this._auth=n,this._store=e,this._toastMessenger=i,this._authority=null!==(s=null===(a=(0,r.serviceConfig)(o))||void 0===a?void 0:a.authority)&&void 0!==s?s:null,this._lastLoad=null,this._lastLoadTime=null,n.on("oauthTokensChanged",(()=>this.reload()))}load(){return(!this._lastLoad||!this._lastLoadTime||Date.now()-this._lastLoadTime>3e5)&&(this._lastLoadTime=Date.now(),this._lastLoad=(0,o.retryPromiseOperation)((()=>{const e=this._authority?{authority:this._authority}:{};return this._api.profile.read(e)})).then((e=>(this.update(e),this._lastLoadTime=Date.now(),e))).catch((e=>{throw this._lastLoadTime=null,e}))),this._lastLoad}async dismissSidebarTutorial(){const e=await this._api.profile.update({},{preferences:{show_sidebar_tutorial:!1}});this.update(e)}update(e){const t=this._store.profile(),n=e.userid!==t.userid;return this._store.updateProfile(e),this._lastLoad=Promise.resolve(e),this._lastLoadTime=Date.now(),n&&(e.userid?i.setUserInfo({id:e.userid}):i.setUserInfo(null)),e}async logout(){try{return await this._auth.logout(),this.reload()}catch(e){throw this._toastMessenger.error("Log out failed"),new Error(e)}}reload(){return this._lastLoad=null,this._lastLoadTime=null,this.load()}}n.SessionService=a,a.$inject=["store","api","auth","settings","toastMessenger"]},{"../config/service-config":161,"../util/retry":241,"../util/sentry":243}],203:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.StreamFilter=void 0;n.StreamFilter=class{constructor(){this._filter={match_policy:"include_any",clauses:[],actions:{create:!0,update:!0,delete:!0}}}addClause(e,t,n,r=!1){return this._filter.clauses.push({field:e,operator:t,value:n,case_sensitive:r}),this}getFilter(){return this._filter}resetFilter(){return this._filter={match_policy:"include_any",clauses:[],actions:{create:!0,update:!0,delete:!0}},this}}},{}],204:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.StreamerService=void 0;var r,o=(r=e("../../shared/warn-once"))&&r.__esModule?r:{default:r},i=e("../util/random"),s=e("../websocket"),a=e("../util/watch");class c{constructor(e,t,n,r,o){this._auth=t,this._groups=n,this._session=r,this._store=e,this._websocketURL=o.websocketUrl,this.clientId=(0,i.generateHexString)(32),this._socket=null,this._updateImmediately=!0,this._configMessages={},this._reconnectSetUp=!1}applyPendingUpdates(){const e=Object.values(this._store.pendingUpdates());e.length&&this._store.addAnnotations(e);const t=Object.keys(this._store.pendingDeletions()).map((e=>({id:e})));t.length&&this._store.removeAnnotations(t),this._store.clearPendingUpdates()}_handleSocketError(e){(0,o.default)("Error connecting to H push notification service:",e);const t=new URL(this._websocketURL).hostname;-1!==["localhost","127.0.0.1"].indexOf(t)&&(0,o.default)("Check that your H service is configured to allow WebSocket connections from "+window.location.origin)}_handleSocketMessage(e){const t=JSON.parse(e.data);if(t)if("annotation-notification"===t.type){const e=t.payload;switch(t.options.action){case"create":case"update":case"past":this._store.receiveRealTimeUpdates({updatedAnnotations:e});break;case"delete":this._store.receiveRealTimeUpdates({deletedAnnotations:e})}this._updateImmediately&&this.applyPendingUpdates()}else if("session-change"===t.type)this._session.update(t.model),this._groups.load();else if("whoyouare"===t.type){const e=this._store.profile().userid;t.userid!==e&&console.warn('WebSocket user ID "%s" does not match logged-in ID "%s"',t.userid,e)}else(0,o.default)("Received unsupported notification",t.type)}_sendClientConfig(e){Object.keys(this._configMessages).forEach((t=>{this._configMessages[t]&&e.send(this._configMessages[t])}))}setConfig(e,t){var n;this._configMessages[e]=t,null!==(n=this._socket)&&void 0!==n&&n.isConnected()&&this._socket.send(t)}async _reconnect(){var e;if(!this._websocketURL)return;let t,n;null===(e=this._socket)||void 0===e||e.close();try{t=await this._auth.getAccessToken()}catch(o){throw console.error("Failed to fetch token for WebSocket authentication",o),o}if(t){const e=new URL(this._websocketURL);e.searchParams.set("access_token",t),n=e.toString()}else n=this._websocketURL;const r=new s.Socket(n);r.on("open",(()=>this._sendClientConfig(r))),r.on("error",(e=>this._handleSocketError(e))),r.on("message",(e=>this._handleSocketMessage(e))),this._socket=r,this.setConfig("client-id",{messageType:"client_id",value:this.clientId}),this.setConfig("auth-check",{type:"whoami",id:1})}async connect(e={}){var t;this._updateImmediately=null===(t=e.applyUpdatesImmediately)||void 0===t||t,this._reconnectSetUp||(this._reconnectSetUp=!0,(0,a.watch)(this._store.subscribe,(()=>this._store.profile().userid),(()=>{this._reconnect()}))),this._socket||await this._reconnect()}}n.StreamerService=c,c.$inject=["store","auth","groups","session","settings"]},{"../../shared/warn-once":93,"../util/random":240,"../util/watch":248,"../websocket":249}],205:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.TagsService=void 0;var r,o=(r=e("escape-string-regexp"))&&r.__esModule?r:{default:r};const i="hypothesis.user.tags.list",s="hypothesis.user.tags.map";class a{constructor(e){this._storage=e}filter(e,t=null){const n=this._storage.getObject(i)||[];let r=0;return n.filter((n=>{if(null!==t&&r>=t)return!1;const i=n.split(/\W+/),s=new RegExp(`^${(0,o.default)(e)}`,"i");return!(!i.some((e=>e.match(s)))&&!n.match(s)||(++r,0))}))}store(e){const t=this._storage.getObject(s)||{};e.forEach((e=>{t[e]?(t[e].count+=1,t[e].updated=Date.now()):t[e]={text:e,count:1,updated:Date.now()}})),this._storage.setObject(s,t);const n=Object.keys(t).sort(((e,n)=>t[e].count!==t[n].count?t[n].count-t[e].count:e.localeCompare(n)));this._storage.setObject(i,n)}}n.TagsService=a,a.$inject=["localStorage"]},{"escape-string-regexp":22}],206:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ThreadsService=void 0;class r{constructor(e){this._store=e}forceVisible(e){e.children.forEach((e=>{this.forceVisible(e)})),e.visible||this._store.setForcedVisible(e.id,!0)}}n.ThreadsService=r,r.$inject=["store"]},{}],207:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ToastMessengerService=void 0;var r=e("../util/random");function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class a{constructor(e){this._store=e}dismiss(e){const t=this._store.getToastMessage(e);t&&!t.isDismissed&&(this._store.updateToastMessage(i(i({},t),{},{isDismissed:!0})),setTimeout((()=>{this._store.removeToastMessage(e)}),500))}_addMessage(e,t,{autoDismiss:n=!0,moreInfoURL:o=""}={}){if(this._store.hasToastMessage(e,t))return;const s=(0,r.generateHexString)(10),a={type:e,id:s,message:t,moreInfoURL:o};this._store.addToastMessage(i({isDismissed:!1},a)),n&&setTimeout((()=>{this.dismiss(s)}),5e3)}error(e,t){this._addMessage("error",e,t)}success(e,t){this._addMessage("success",e,t)}notice(e,t){this._addMessage("notice",e,t)}}n.ToastMessengerService=a,a.$inject=["store"]},{"../util/random":240}],208:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createStore=function(e,t=[],n=[]){const s={},a={},c={};e.forEach((e=>{e.namespace?(s[e.namespace]=e.initialState(...t),a[e.namespace]=(0,i.createReducer)(e.reducers),c[e.namespace]={selectors:e.selectors,rootSelectors:e.rootSelectors||{}}):console.warn("Store module does not specify a namespace",e)}));const l=[o.default],u=r.applyMiddleware(...l,...n);let d=r.combineReducers(a);const f=r.createStore(d,s,u),p=Object.assign({},...e.map((e=>e.actionCreators))),h=r.bindActionCreators(p,f.dispatch),m=(0,i.bindSelectors)(c,f.getState);return Object.assign(f,h,m),f},n.createStoreModule=function(e,t){if(!(e instanceof Function)){const t=e;e=()=>t}return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({initialState:e},t)};var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var s=o?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(r,i,s):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}(e("redux")),o=s(e("redux-thunk")),i=(s(e("../util/immutable")),e("./util"));function s(e){return e&&e.__esModule?e:{default:e}}function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},{"../util/immutable":234,"./util":228,redux:30,"redux-thunk":29}],209:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){let t=0;return function(n){return function(r){if(!window.debug)return void n(r);++t;const o=r.type+" ("+t.toString()+")";console.group(o),console.log("Prev State:",e.getState()),console.log("Action:",r),n(r),console.log("Next State:",e.getState()),console.groupEnd()}}}},{}],210:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createSidebarStore=w;var r=e("./create-store"),o=j(e("./debug-middleware")),i=j(e("./modules/activity")),s=j(e("./modules/annotations")),a=j(e("./modules/defaults")),c=j(e("./modules/direct-linked")),l=j(e("./modules/drafts")),u=j(e("./modules/filters")),d=j(e("./modules/frames")),f=j(e("./modules/groups")),p=j(e("./modules/links")),h=j(e("./modules/real-time-updates")),m=j(e("./modules/route")),g=j(e("./modules/selection")),v=j(e("./modules/session")),y=j(e("./modules/sidebar-panels")),_=j(e("./modules/toast-messages")),b=j(e("./modules/viewer"));function j(e){return e&&e.__esModule?e:{default:e}}function w(e){const t=[o.default],n=[i.default,s.default,a.default,c.default,l.default,u.default,d.default,p.default,f.default,h.default,m.default,g.default,v.default,y.default,_.default,b.default];return(0,r.createStore)(n,[e],t)}w.$inject=["settings"]},{"./create-store":208,"./debug-middleware":209,"./modules/activity":211,"./modules/annotations":212,"./modules/defaults":213,"./modules/direct-linked":214,"./modules/drafts":215,"./modules/filters":216,"./modules/frames":217,"./modules/groups":218,"./modules/links":219,"./modules/real-time-updates":220,"./modules/route":221,"./modules/selection":222,"./modules/session":223,"./modules/sidebar-panels":224,"./modules/toast-messages":225,"./modules/viewer":226}],211:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("../util"),o=e("../create-store");function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const c={API_REQUEST_STARTED:e=>s(s({},e),{},{activeApiRequests:e.activeApiRequests+1}),API_REQUEST_FINISHED(e){if(0===e.activeApiRequests)throw new Error("API_REQUEST_FINISHED action when no requests were active");return s(s({},e),{},{activeApiRequests:e.activeApiRequests-1})},ANNOTATION_SAVE_STARTED(e,t){let n=[];t.annotation.$tag&&!e.activeAnnotationSaveRequests.includes(t.annotation.$tag)&&n.push(t.annotation.$tag);const r=e.activeAnnotationSaveRequests.concat(n);return s(s({},e),{},{activeAnnotationSaveRequests:r})},ANNOTATION_SAVE_FINISHED(e,t){const n=e.activeAnnotationSaveRequests.filter((e=>e!==t.annotation.$tag));return s(s({},e),{},{activeAnnotationSaveRequests:n})},ANNOTATION_FETCH_STARTED:e=>s(s({},e),{},{activeAnnotationFetches:e.activeAnnotationFetches+1}),ANNOTATION_FETCH_FINISHED(e){if(0===e.activeAnnotationFetches)throw new Error("ANNOTATION_FETCH_FINISHED action when no annotation fetches were active");return s(s({},e),{},{hasFetchedAnnotations:!0,activeAnnotationFetches:e.activeAnnotationFetches-1})},SET_ANNOTATION_RESULT_COUNT:(e,t)=>({annotationResultCount:t.resultCount})},l=(0,r.actionTypes)(c);var u=(0,o.createStoreModule)({activeAnnotationSaveRequests:[],activeApiRequests:0,activeAnnotationFetches:0,hasFetchedAnnotations:!1,annotationResultCount:null},{reducers:c,namespace:"activity",actionCreators:{annotationFetchStarted:function(){return{type:l.ANNOTATION_FETCH_STARTED}},annotationFetchFinished:function(){return{type:l.ANNOTATION_FETCH_FINISHED}},annotationSaveStarted:function(e){return{type:l.ANNOTATION_SAVE_STARTED,annotation:e}},annotationSaveFinished:function(e){return{type:l.ANNOTATION_SAVE_FINISHED,annotation:e}},apiRequestStarted:function(){return{type:l.API_REQUEST_STARTED}},apiRequestFinished:function(){return{type:l.API_REQUEST_FINISHED}},setAnnotationResultCount:function(e){return{type:l.SET_ANNOTATION_RESULT_COUNT,resultCount:e}}},selectors:{hasFetchedAnnotations:function(e){return e.hasFetchedAnnotations},isLoading:function(e){return e.activeApiRequests>0||!e.hasFetchedAnnotations},isFetchingAnnotations:function(e){return e.activeAnnotationFetches>0},isSavingAnnotation:function(e,t){return!!t.$tag&&e.activeAnnotationSaveRequests.includes(t.$tag)},annotationResultCount:function(e){return e.annotationResultCount}}});n.default=u},{"../create-store":208,"../util":228}],212:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.removeAnnotations=_,n.default=void 0;var r,o=e("reselect"),i=d(e("../../helpers/annotation-metadata")),s=e("../../util/collections"),a=d(e("../util")),c=e("../create-store"),l=(r=e("./route"))&&r.__esModule?r:{default:r};function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}function d(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var s=o?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(r,i,s):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t){return e.find((e=>e.id===t))}function g(e,t){return e.find((e=>e.$tag===t))}const v={ADD_ANNOTATIONS:function(e,t){const n={},r={},o=[],i=[],s=[];let a=e.nextTag;return t.annotations.forEach((t=>{let i;t.id&&(i=m(e.annotations,t.id)),!i&&t.$tag&&(i=g(e.annotations,t.$tag)),i?(s.push(Object.assign({},i,t)),t.id&&(n[t.id]=!0),i.$tag&&(r[i.$tag]=!0)):(o.push(function(e,t){let n=e.$orphan;return e.id||(n=!1),Object.assign({},e,{$anchorTimeout:!1,$tag:e.$tag||t,$orphan:n})}(t,"t"+a)),++a)})),e.annotations.forEach((e=>{n[e.id]||r[e.$tag]||i.push(e)})),{annotations:o.concat(s).concat(i),nextTag:a}},CLEAR_ANNOTATIONS:function(){return{annotations:[],focused:{},highlighted:{}}},FOCUS_ANNOTATIONS:function(e,t){return{focused:(0,s.toTrueMap)(t.focusedTags)}},HIDE_ANNOTATION:function(e,t){return{annotations:e.annotations.map((e=>e.id!==t.id?e:p(p({},e),{},{hidden:!0})))}},HIGHLIGHT_ANNOTATIONS:function(e,t){return{highlighted:t.highlighted}},REMOVE_ANNOTATIONS:function(e,t){return{annotations:[...t.remainingAnnotations]}},UNHIDE_ANNOTATION:function(e,t){return{annotations:e.annotations.map((e=>e.id!==t.id?e:Object.assign({},e,{hidden:!1})))}},UPDATE_ANCHOR_STATUS:function(e,t){return{annotations:e.annotations.map((e=>{if(!t.statusUpdates.hasOwnProperty(e.$tag))return e;const n=t.statusUpdates[e.$tag];return"timeout"===n?Object.assign({},e,{$anchorTimeout:!0}):Object.assign({},e,{$orphan:"orphan"===n})}))}},UPDATE_FLAG_STATUS:function(e,t){return{annotations:e.annotations.map((e=>{if(e.id&&e.id===t.id){if(e.flagged===t.isFlagged)return e;const n=Object.assign({},e,{flagged:t.isFlagged});if(n.moderation){const r=t.isFlagged?1:-1;n.moderation=Object.assign({},e.moderation,{flagCount:e.moderation.flagCount+r})}return n}return e}))}}},y=a.actionTypes(v);function _(e){return(t,n)=>{const r=function(e,t){const n={},r={};return t.forEach((e=>{e.id&&(n[e.id]=!0),e.$tag&&(r[e.$tag]=!0)})),e.filter((e=>!(e.id&&e.id in n||e.$tag&&e.$tag in r)))}(n().annotations.annotations,e);t({type:y.REMOVE_ANNOTATIONS,annotationsToRemove:e,remainingAnnotations:r})}}function b(e){return{type:y.UPDATE_ANCHOR_STATUS,statusUpdates:e}}const j=(0,o.createSelector)((e=>e.annotations),(e=>(0,s.countIf)(e,i.isAnnotation)));const w=(0,o.createSelector)((e=>e.focused),(e=>(0,s.trueKeys)(e))),x=(0,o.createSelector)((e=>e.highlighted),(e=>(0,s.trueKeys)(e)));const O=(0,o.createSelector)((e=>e.annotations),(e=>e.some(i.isWaitingToAnchor))),S=(0,o.createSelector)((e=>e.annotations),(e=>e.filter((e=>i.isNew(e)&&!i.isHighlight(e))))),k=(0,o.createSelector)((e=>e.annotations),(e=>e.filter((e=>i.isNew(e)&&i.isHighlight(e))))),P=(0,o.createSelector)((e=>e.annotations),(e=>(0,s.countIf)(e,i.isPageNote))),E=(0,o.createSelector)((e=>e.annotations),(e=>(0,s.countIf)(e,i.isOrphan)));var A=(0,c.createStoreModule)({annotations:[],focused:{},highlighted:{},nextTag:1},{namespace:"annotations",reducers:v,actionCreators:{addAnnotations:function(e){return function(t,n){const r=e.filter((e=>!m(n().annotations.annotations,e.id)));if(t({type:y.ADD_ANNOTATIONS,annotations:e,currentAnnotationCount:n().annotations.annotations.length}),"sidebar"!==l.default.selectors.route(n().route))return;const o=r.filter(i.isWaitingToAnchor).map((e=>e.id));o.length>0&&setTimeout((()=>{const e=n().annotations.annotations,r=o.map((t=>m(e,t))).filter((e=>e&&i.isWaitingToAnchor(e))).reduce(((e,t)=>(e[t.$tag]="timeout",e)),{});t(b(r))}),500)}},clearAnnotations:function(){return{type:y.CLEAR_ANNOTATIONS}},focusAnnotations:function(e){return{type:y.FOCUS_ANNOTATIONS,focusedTags:e}},hideAnnotation:function(e){return{type:y.HIDE_ANNOTATION,id:e}},highlightAnnotations:function(e){return{type:y.HIGHLIGHT_ANNOTATIONS,highlighted:(0,s.toTrueMap)(e)}},removeAnnotations:_,unhideAnnotation:function(e){return{type:y.UNHIDE_ANNOTATION,id:e}},updateAnchorStatus:b,updateFlagStatus:function(e,t){return{type:y.UPDATE_FLAG_STATUS,id:e,isFlagged:t}}},selectors:{allAnnotations:function(e){return e.annotations},annotationCount:j,annotationExists:function(e,t){return e.annotations.some((e=>e.id===t))},findAnnotationByID:function(e,t){return m(e.annotations,t)},findIDsForTags:function(e,t){const n=[];return t.forEach((t=>{const r=g(e.annotations,t);r&&r.id&&n.push(r.id)})),n},focusedAnnotations:w,highlightedAnnotations:x,isAnnotationFocused:function(e,t){return!0===e.focused[t]},isWaitingToAnchorAnnotations:O,newAnnotations:S,newHighlights:k,noteCount:P,orphanCount:E,savedAnnotations:function(e){return e.annotations.filter((e=>!i.isNew(e)))}}});n.default=A},{"../../helpers/annotation-metadata":164,"../../util/collections":229,"../create-store":208,"../util":228,"./route":221,reselect:31}],213:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=o?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=e[s]}return r.default=e,n&&n.set(e,r),r}(e("../util")),o=e("../create-store");function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}const s={SET_DEFAULT:function(e,t){return{[t.defaultKey]:t.value}}},a=r.actionTypes(s);var c=(0,o.createStoreModule)({annotationPrivacy:null,focusedGroup:null},{namespace:"defaults",reducers:s,actionCreators:{setDefault:function(e,t){return{type:a.SET_DEFAULT,defaultKey:e,value:t}}},selectors:{getDefault:function(e,t){return e[t]},getDefaults:function(e){return e}}});n.default=c},{"../create-store":208,"../util":228}],214:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=o?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=e[s]}return r.default=e,n&&n.set(e,r),r}(e("../util")),o=e("../create-store");function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}const s={UPDATE_DIRECT_LINKED_GROUP_FETCH_FAILED:(e,t)=>({directLinkedGroupFetchFailed:t.directLinkedGroupFetchFailed}),UPDATE_DIRECT_LINKED_GROUP_ID:(e,t)=>({directLinkedGroupId:t.directLinkedGroupId}),UPDATE_DIRECT_LINKED_ANNOTATION_ID:(e,t)=>({directLinkedAnnotationId:t.directLinkedAnnotationId}),CLEAR_DIRECT_LINKED_IDS:()=>({directLinkedAnnotationId:null,directLinkedGroupId:null}),CLEAR_SELECTION:function(){return{directLinkedAnnotationId:null,directLinkedGroupId:null,directLinkedGroupFetchFailed:!1}}},a=r.actionTypes(s);var c=(0,o.createStoreModule)((function(e){return{directLinkedGroupId:e.group||null,directLinkedAnnotationId:e.annotations||null,directLinkedGroupFetchFailed:!1}}),{namespace:"directLinked",reducers:s,actionCreators:{setDirectLinkedGroupFetchFailed:function(){return{type:a.UPDATE_DIRECT_LINKED_GROUP_FETCH_FAILED,directLinkedGroupFetchFailed:!0}},setDirectLinkedGroupId:function(e){return{type:a.UPDATE_DIRECT_LINKED_GROUP_ID,directLinkedGroupId:e}},setDirectLinkedAnnotationId:function(e){return{type:a.UPDATE_DIRECT_LINKED_ANNOTATION_ID,directLinkedAnnotationId:e}},clearDirectLinkedGroupFetchFailed:function(){return{type:a.UPDATE_DIRECT_LINKED_GROUP_FETCH_FAILED,directLinkedGroupFetchFailed:!1}},clearDirectLinkedIds:function(){return{type:a.CLEAR_DIRECT_LINKED_IDS}}},selectors:{directLinkedAnnotationId:function(e){return e.directLinkedAnnotationId},directLinkedGroupFetchFailed:function(e){return e.directLinkedGroupFetchFailed},directLinkedGroupId:function(e){return e.directLinkedGroupId}}});n.default=c},{"../create-store":208,"../util":228}],215:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Draft=void 0;var r=e("reselect"),o=c(e("../../helpers/annotation-metadata")),i=c(e("../util")),s=e("../create-store");function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}function c(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var s=o?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(r,i,s):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}class l{constructor(e,t){this.annotation={id:e.id,$tag:e.$tag},this.isPrivate=t.isPrivate,this.tags=t.tags,this.text=t.text}match(e){return this.annotation.$tag&&e.$tag===this.annotation.$tag||this.annotation.id&&e.id===this.annotation.id}isEmpty(){return!this.text&&0===this.tags.length}}n.Draft=l;const u={DISCARD_ALL_DRAFTS:function(){return[]},REMOVE_DRAFT:function(e,t){return e.filter((e=>!e.match(t.annotation)))},UPDATE_DRAFT:function(e,t){const n=e.filter((e=>!e.match(t.draft.annotation)));return n.push(t.draft),n}},d=i.actionTypes(u);function f(e){return{type:d.REMOVE_DRAFT,annotation:e}}function p(e,t){const n=e;for(let r=0;r<n.length;r++){const e=n[r];if(e.match(t))return e}return null}function h(e,t){const n=p(e,t);return n?n.isEmpty()?null:n:null}const m=(0,r.createSelector)((e=>e),(e=>e.filter((e=>!e.annotation.id)).map((e=>e.annotation))));var g=(0,s.createStoreModule)([],{namespace:"drafts",reducers:u,actionCreators:{createDraft:function(e,t){return{type:d.UPDATE_DRAFT,draft:new l(e,t)}},deleteNewAndEmptyDrafts:function(){const{removeAnnotations:t}=e("./annotations");return(e,n)=>{const r=n().drafts.filter((e=>o.isNew(e.annotation)&&!h(n().drafts,e.annotation))).map((t=>(e(f(t.annotation)),t.annotation)));e(t(r))}},discardAllDrafts:function(){return{type:d.DISCARD_ALL_DRAFTS}},removeDraft:f},selectors:{countDrafts:function(e){return e.length},getDraft:p,getDraftIfNotEmpty:h,unsavedAnnotations:m}});n.default=g},{"../../helpers/annotation-metadata":164,"../create-store":208,"../util":228,"./annotations":212,reselect:31}],216:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("reselect"),o=e("../util"),i=e("../create-store");function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e){var t,n;return!!(null!==(t=e.user)&&void 0!==t&&t.username||null!==(n=e.user)&&void 0!==n&&n.userid)}function u(e){if(!l(e))return{};const t=e.user.username||e.user.userid||"";return{user:{value:t,display:e.user.displayName||t}}}const d={CHANGE_FOCUS_MODE_USER:function(e,t){return l({user:t.user})?{focusActive:!0,focusFilters:u({user:t.user})}:{focusActive:!1}},SET_FILTER:function(e,t){var n;const r=a(a({},e.filters),{},{[t.filterName]:t.filterOption});return""===(null===(n=t.filterOption)||void 0===n?void 0:n.value)&&delete r[t.filterName],{filters:r}},SET_FILTER_QUERY:function(e,t){return{query:t.query}},SET_FOCUS_MODE:function(e,t){var n;return{focusActive:null!==(n=t.active)&&void 0!==n?n:!e.focusActive}},CLEAR_SELECTION:function(){return{filters:{},focusActive:!1,query:null}}},f=(0,o.actionTypes)(d);const p=(0,r.createSelector)((e=>e.focusActive),(e=>e.focusFilters),((e,t)=>{var n;return{active:e,configured:!(null==t||!t.user),displayName:(null==t||null===(n=t.user)||void 0===n?void 0:n.display)||""}})),h=(0,r.createSelector)((e=>e.filters),(e=>e.focusActive),(e=>e.focusFilters),((e,t,n)=>a(t?a({},n):{},e)));const m=(0,r.createSelector)((e=>h(e)),(e=>{const t={};return Object.keys(e).forEach((n=>t[n]=e[n].value)),t}));var g=(0,i.createStoreModule)((function(e){const t=e.focus||{};return{filters:{},focusActive:l(t),focusFilters:u(t),query:e.query||null}}),{namespace:"filters",reducers:d,actionCreators:{changeFocusModeUser:function(e){return{type:f.CHANGE_FOCUS_MODE_USER,user:e}},setFilter:function(e,t){return(n,r)=>{var o;null!==(o=r().filters.focusFilters)&&void 0!==o&&o[e]&&n({type:f.SET_FOCUS_MODE,active:!1}),n({type:f.SET_FILTER,filterName:e,filterOption:t})}},setFilterQuery:function(e){return{type:f.SET_FILTER_QUERY,query:e}},toggleFocusMode:function(e){return{type:f.SET_FOCUS_MODE,active:e}}},selectors:{filterQuery:function(e){return e.query},focusState:p,getFilter:function(e,t){return h(e)[t]},getFilters:h,getFilterValues:m,getFocusFilters:function(e){return e.focusFilters},hasAppliedFilter:function(e){return!(!e.query&&!Object.keys(h(e)).length)}}});n.default=g},{"../create-store":208,"../util":228,reselect:31}],217:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,o=e("reselect"),i=(r=e("shallowequal"))&&r.__esModule?r:{default:r},s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var s=o?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(r,i,s):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}(e("../util")),a=e("../create-store");function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}const l={CONNECT_FRAME:function(e,t){return[...e,t.frame]},DESTROY_FRAME:function(e,t){return e.filter((e=>e!==t.frame))},UPDATE_FRAME_ANNOTATION_FETCH_STATUS:function(e,t){return e.map((e=>e.uri&&e.uri===t.uri?Object.assign({},e,{isAnnotationFetchComplete:t.isAnnotationFetchComplete}):e))}},u=s.actionTypes(l);const d=(0,o.createSelector)((e=>e),(e=>e.find((e=>!e.id))||null));const f=(0,o.createSelectorCreator)(o.defaultMemoize,i.default)((e=>e.reduce(((e,t)=>e.concat(function(e){let t=[e.uri];return e.metadata&&e.metadata.documentFingerprint&&(t=e.metadata.link.map((e=>e.href))),e.metadata&&e.metadata.link&&e.metadata.link.forEach((e=>{e.href.startsWith("doi:")&&t.push(e.href)})),t}(t))),[])),(e=>e));var p=(0,a.createStoreModule)([],{namespace:"frames",reducers:l,actionCreators:{connectFrame:function(e){return{type:u.CONNECT_FRAME,frame:e}},destroyFrame:function(e){return{type:u.DESTROY_FRAME,frame:e}},updateFrameAnnotationFetchStatus:function(e,t){return{type:u.UPDATE_FRAME_ANNOTATION_FETCH_STATUS,isAnnotationFetchComplete:t,uri:e}}},selectors:{frames:function(e){return e},mainFrame:d,searchUris:f}});n.default=p},{"../create-store":208,"../util":228,reselect:31,shallowequal:36}],218:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,o=e("reselect"),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var s=o?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(r,i,s):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}(e("../util")),s=e("../create-store"),a=(r=e("./session"))&&r.__esModule?r:{default:r};function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}const l={FOCUS_GROUP:(e,t)=>e.groups.find((e=>e.id===t.id))?{focusedGroupId:t.id}:(console.error(`Attempted to focus group ${t.id} which is not loaded`),{}),LOAD_GROUPS(e,t){const n=t.groups;let r=e.focusedGroupId;return null!==e.focusedGroupId&&n.find((t=>t.id===e.focusedGroupId))||(r=n.length>0?n[0].id:null),{focusedGroupId:r,groups:t.groups}},CLEAR_GROUPS:()=>({focusedGroupId:null,groups:[]})},u=i.actionTypes(l);function d(e){return e.groups}function f(e,t){return e.groups.find((e=>e.id===t))}const p=(0,o.createSelector)((e=>e.groups),(e=>e.filter((e=>!e.isMember&&e.isScopedToUri)))),h=(0,o.createSelector)((e=>e.groups),(e=>e.filter((e=>e.isScopedToUri)))),m=(0,o.createSelector)((e=>e.groups.groups),(e=>a.default.selectors.isLoggedIn(e.session)),((e,t)=>t?e.filter((e=>e.isMember)):[])),g=(0,o.createSelector)((e=>d(e.groups)),(e=>m(e)),(e=>p(e.groups)),((e,t,n)=>e.filter((e=>!t.includes(e)&&!n.includes(e)))));var v=(0,s.createStoreModule)({groups:[],focusedGroupId:null},{namespace:"groups",reducers:l,actionCreators:{focusGroup:function(e){return{type:u.FOCUS_GROUP,id:e}},loadGroups:function(e){return{type:u.LOAD_GROUPS,groups:e}},clearGroups:function(){return{type:u.CLEAR_GROUPS}}},selectors:{allGroups:d,focusedGroup:function(e){return e.focusedGroupId?f(e,e.focusedGroupId):null},focusedGroupId:function(e){return e.focusedGroupId},getFeaturedGroups:p,getGroup:f,getInScopeGroups:h},rootSelectors:{getCurrentlyViewingGroups:g,getMyGroups:m}});n.default=v},{"../create-store":208,"../util":228,"./session":223,reselect:31}],219:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("../util"),o=e("../../util/url"),i=e("../create-store");function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const c={UPDATE_LINKS:(e,t)=>function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t.links)},l=(0,r.actionTypes)(c);var u=(0,i.createStoreModule)(null,{namespace:"links",reducers:c,actionCreators:{updateLinks:function(e){return{type:l.UPDATE_LINKS,links:e}}},selectors:{getLink:function(e,t,n={}){if(!e)return"";const r=e[t];if(!r)throw new Error(`Unknown link "${t}"`);const{url:i,unusedParams:s}=(0,o.replaceURLParams)(r,n),a=Object.keys(s);if(a.length>0)throw new Error(`Unused parameters: ${a.join(", ")}`);return i}}});n.default=u},{"../../util/url":247,"../create-store":208,"../util":228}],220:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("reselect"),o=e("../create-store"),i=e("../util"),s=l(e("./annotations")),a=l(e("./groups")),c=l(e("./route"));function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const p={RECEIVE_REAL_TIME_UPDATES:(e,t)=>({pendingUpdates:d({},t.pendingUpdates),pendingDeletions:d({},t.pendingDeletions)}),CLEAR_PENDING_UPDATES:()=>({pendingUpdates:{},pendingDeletions:{}}),ADD_ANNOTATIONS(e,{annotations:t}){const n=d({},e.pendingUpdates);return t.forEach((e=>delete n[e.id])),{pendingUpdates:n}},REMOVE_ANNOTATIONS(e,{annotationsToRemove:t}){const n=d({},e.pendingUpdates),r=d({},e.pendingDeletions);return t.forEach((e=>{delete n[e.id],delete r[e.id]})),{pendingUpdates:n,pendingDeletions:r}},FOCUS_GROUP:()=>({pendingUpdates:{},pendingDeletions:{}})},h=(0,i.actionTypes)(p);const m=(0,r.createSelector)((e=>[e.pendingUpdates,e.pendingDeletions]),(([e,t])=>Object.keys(e).length+Object.keys(t).length));var g=(0,o.createStoreModule)({pendingUpdates:{},pendingDeletions:{}},{namespace:"realTimeUpdates",reducers:p,actionCreators:{receiveRealTimeUpdates:function({updatedAnnotations:e=[],deletedAnnotations:t=[]}){return(n,r)=>{const o=d({},r().realTimeUpdates.pendingUpdates),i=d({},r().realTimeUpdates.pendingDeletions);e.forEach((e=>{const t=r().groups,n=r().route;e.group!==a.default.selectors.focusedGroupId(t)&&"sidebar"===c.default.selectors.route(n)||(o[e.id]=e)})),t.forEach((e=>{const t=e.id;delete o[t];const n=r().annotations;s.default.selectors.annotationExists(n,t)&&(i[t]=!0)})),n({type:h.RECEIVE_REAL_TIME_UPDATES,pendingUpdates:o,pendingDeletions:i})}},clearPendingUpdates:function(){return{type:h.CLEAR_PENDING_UPDATES}}},selectors:{hasPendingDeletion:function(e,t){return e.pendingDeletions.hasOwnProperty(t)},pendingDeletions:function(e){return e.pendingDeletions},pendingUpdates:function(e){return e.pendingUpdates},pendingUpdateCount:m}});n.default=g},{"../create-store":208,"../util":228,"./annotations":212,"./groups":218,"./route":221,reselect:31}],221:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("../util"),o=e("../create-store");const i={CHANGE_ROUTE:(e,{name:t,params:n})=>({name:t,params:n})},s=(0,r.actionTypes)(i);var a=(0,o.createStoreModule)({name:null,params:{}},{namespace:"route",reducers:i,actionCreators:{changeRoute:function(e,t={}){return{type:s.CHANGE_ROUTE,name:e,params:t}}},selectors:{route:function(e){return e.name},routeParams:function(e){return e.params}}});n.default=a},{"../create-store":208,"../util":228}],222:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("reselect"),o=l(e("../../helpers/annotation-metadata")),i=e("../../util/collections"),s=l(e("../util")),a=e("../create-store");function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}function l(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var s=o?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(r,i,s):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const p={annotation:"Location",note:"Oldest",orphan:"Location"};function h(e){const t={};return e.annotations&&!e.query&&(t[e.annotations]=!0),t}const m=(e,t)=>t===e?{}:{selectedTab:e,sortKey:p[e]},g={CLEAR_SELECTION:function(){return{forcedVisible:{},selected:{}}},SELECT_ANNOTATIONS:function(e,t){return{selected:t.selection}},SELECT_TAB:function(e,t){return m(t.tab,e.selectedTab)},SET_EXPANDED:function(e,t){const n=d({},e.expanded);return n[t.id]=t.expanded,{expanded:n}},SET_FORCED_VISIBLE:function(e,t){return{forcedVisible:d(d({},e.forcedVisible),{},{[t.id]:t.visible})}},SET_SORT_KEY:function(e,t){return{sortKey:t.key}},TOGGLE_SELECTED_ANNOTATIONS:function(e,t){const n=d({},e.selected);return t.toggleIds.forEach((e=>{n[e]=!n[e]})),{selected:n}},ADD_ANNOTATIONS(e,t){const n=t.annotations.filter((e=>!o.isReply(e))),r=(0,i.countIf)(t.annotations,o.isPageNote)===n.length;return 0===t.currentAnnotationCount&&r?m("note",e.selectedTab):{}},CHANGE_FOCUS_MODE_USER:function(){return{forcedVisible:{},selected:{}}},SET_FILTER:function(){return d(d({},{forcedVisible:{},selected:{}}),{},{expanded:{}})},SET_FILTER_QUERY:function(){return d(d({},{forcedVisible:{},selected:{}}),{},{expanded:{}})},SET_FOCUS_MODE:function(){return{forcedVisible:{},selected:{}}},REMOVE_ANNOTATIONS:function(e,t){let n=e.selectedTab;"orphan"===n&&0===(0,i.countIf)(t.remainingAnnotations,o.isOrphan)&&(n="annotation");const r=e=>(t.annotationsToRemove.forEach((t=>{t.id&&delete e[t.id],t.$tag&&delete e[t.$tag]})),e);return d(d({},m(n,e.selectedTab)),{},{expanded:r(d({},e.expanded)),forcedVisible:r(d({},e.forcedVisible)),selected:r(d({},e.selected))})}},v=s.actionTypes(g);function y(e){return e.expanded}const _=(0,r.createSelector)((e=>e.forcedVisible),(e=>(0,i.trueKeys)(e))),b=(0,r.createSelector)((e=>e.selected),(e=>(0,i.trueKeys)(e).length>0)),j=(0,r.createSelector)((e=>e.selected),(e=>(0,i.trueKeys)(e)));function w(e){return e.selectedTab}const x=(0,r.createSelector)((e=>e),(e=>({expanded:y(e),forcedVisible:_(e),selected:j(e),sortKey:O(e),selectedTab:w(e)})));function O(e){return e.sortKey}const S=(0,r.createSelector)((e=>e.selectedTab),(e=>{const t=["Newest","Oldest"];return"note"!==e&&t.push("Location"),t}));var k=(0,a.createStoreModule)((function(e){return{selected:h(e),expanded:h(e)||{},forcedVisible:{},selectedTab:"annotation",sortKey:p.annotation}}),{namespace:"selection",reducers:g,actionCreators:{clearSelection:function(){return{type:v.CLEAR_SELECTION}},selectAnnotations:function(e){return t=>{t({type:v.CLEAR_SELECTION}),t({type:v.SELECT_ANNOTATIONS,selection:(0,i.toTrueMap)(e)})}},selectTab:function(e){return{type:v.SELECT_TAB,tab:e}},setExpanded:function(e,t){return{type:v.SET_EXPANDED,id:e,expanded:t}},setForcedVisible:function(e,t){return{type:v.SET_FORCED_VISIBLE,id:e,visible:t}},setSortKey:function(e){return{type:v.SET_SORT_KEY,key:e}},toggleSelectedAnnotations:function(e){return{type:v.TOGGLE_SELECTED_ANNOTATIONS,toggleIds:e}}},selectors:{expandedMap:y,forcedVisibleThreads:_,hasSelectedAnnotations:b,selectedAnnotations:j,selectedTab:w,selectionState:x,sortKey:O,sortKeys:S}});n.default=k},{"../../helpers/annotation-metadata":164,"../../util/collections":229,"../create-store":208,"../util":228,reselect:31}],223:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=o?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=e[s]}return r.default=e,n&&n.set(e,r),r}(e("../util")),o=e("../create-store");function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const l={features:{},preferences:{},userid:null};const u={UPDATE_PROFILE:function(e,t){return{profile:a({},t.profile)}}},d=r.actionTypes(u);var f=(0,o.createStoreModule)((function(e){var t;return{defaultAuthority:null!==(t=null==e?void 0:e.authDomain)&&void 0!==t?t:"",profile:l}}),{namespace:"session",reducers:u,actionCreators:{updateProfile:function(e){return{type:d.UPDATE_PROFILE,profile:e}}},selectors:{defaultAuthority:function(e){return e.defaultAuthority},hasFetchedProfile:function(e){return e.profile!==l},isFeatureEnabled:function(e,t){return!!e.profile.features[t]},isLoggedIn:function(e){return null!==e.profile.userid},profile:function(e){return e.profile}}});n.default=f},{"../create-store":208,"../util":228}],224:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=o?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=e[s]}return r.default=e,n&&n.set(e,r),r}(e("../util")),o=e("../create-store");function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}const s={OPEN_SIDEBAR_PANEL:function(e,t){return{activePanelName:t.panelName}},CLOSE_SIDEBAR_PANEL:function(e,t){let n=e.activePanelName;return t.panelName===n&&(n=null),{activePanelName:n}},TOGGLE_SIDEBAR_PANEL:function(e,t){let n;const r=e.activePanelName===t.panelName,o=void 0!==t.panelState?t.panelState:!r;return n=o?t.panelName:r&&!o?null:e.activePanelName,{activePanelName:n}}},a=r.actionTypes(s);var c=(0,o.createStoreModule)({activePanelName:null},{namespace:"sidebarPanels",reducers:s,actionCreators:{openSidebarPanel:function(e){return{type:a.OPEN_SIDEBAR_PANEL,panelName:e}},closeSidebarPanel:function(e){return{type:a.CLOSE_SIDEBAR_PANEL,panelName:e}},toggleSidebarPanel:function(e,t){return{type:a.TOGGLE_SIDEBAR_PANEL,panelName:e,panelState:t}}},selectors:{isSidebarPanelOpen:function(e,t){return e.activePanelName===t}}});n.default=c},{"../create-store":208,"../util":228}],225:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("../create-store");function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(o=function(e){return e?n:t})(e)}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const c={ADD_MESSAGE:function(e,t){return{messages:e.messages.concat(s({},t.message))}},REMOVE_MESSAGE:function(e,t){return{messages:e.messages.filter((e=>e.id!==t.id))}},UPDATE_MESSAGE:function(e,t){return{messages:e.messages.map((e=>e.id&&e.id===t.message.id?s({},t.message):e))}}},l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=o(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=i?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=e[s]}return r.default=e,n&&n.set(e,r),r}(e("../util")).actionTypes(c);var u=(0,r.createStoreModule)({messages:[]},{namespace:"toastMessages",reducers:c,actionCreators:{addToastMessage:function(e){return{type:l.ADD_MESSAGE,message:e}},removeToastMessage:function(e){return{type:l.REMOVE_MESSAGE,id:e}},updateToastMessage:function(e){return{type:l.UPDATE_MESSAGE,message:e}}},selectors:{getToastMessage:function(e,t){return e.messages.find((e=>e.id===t))},getToastMessages:function(e){return e.messages},hasToastMessage:function(e,t,n){return e.messages.some((e=>e.type===t&&e.message===n))}}});n.default=u},{"../create-store":208,"../util":228}],226:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=o?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=e[s]}return r.default=e,n&&n.set(e,r),r}(e("../util")),o=e("../create-store");function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}const s={SET_HIGHLIGHTS_VISIBLE:function(e,t){return{visibleHighlights:t.visible}},SET_SIDEBAR_OPENED:(e,t)=>!0===t.opened?{sidebarHasOpened:!0}:{}},a=r.actionTypes(s);var c=(0,o.createStoreModule)({sidebarHasOpened:!1,visibleHighlights:!1},{namespace:"viewer",reducers:s,actionCreators:{setShowHighlights:function(e){return{type:a.SET_HIGHLIGHTS_VISIBLE,visible:e}},setSidebarOpened:function(e){return{type:a.SET_SIDEBAR_OPENED,opened:e}}},selectors:{hasSidebarOpened:function(e){return e.sidebarHasOpened}}});n.default=c},{"../create-store":208,"../util":228}],227:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.useStoreProxy=function(){const e=(0,o.useService)("store"),[,t]=(0,r.useReducer)((e=>e+1),0),n=(0,r.useRef)([]).current,s=(0,r.useRef)(null);if(!s.current){const t={},r=(e,r)=>{const o=e[r];if("function"!=typeof o)return o;let s=t[r];return s||(s=(...t)=>{const s=n.find((e=>e.matches(r,t)));if(s)return s.result;const a=e.getState(),c=o.apply(e,t);return a===e.getState()&&n.push(new i(r,o,t,c)),c},t[r]=s,s)};s.current=new Proxy(e,{get:r})}return(0,r.useEffect)((()=>e.subscribe((()=>{n.find((t=>t.method.apply(e,t.args)!==t.result))&&(n.splice(0,n.length),t(0))}))),[n,e]),s.current};var r=e("preact/hooks"),o=e("../service-context");class i{constructor(e,t,n,r){this.name=e,this.method=t,this.args=n,this.result=r}matches(e,t){return this.name===e&&this.args.every(((e,n)=>t[n]===e))}}},{"../service-context":188,"preact/hooks":27}],228:[function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(n,"__esModule",{value:!0}),n.actionTypes=function(e){return Object.keys(e).reduce(((e,t)=>(e[t]=t,e)),{})},n.createReducer=function(e){return(t={},n)=>{const r=e[n.type];if(!r)return t;const i=r(t,n);return Array.isArray(i)?i:o(o({},t),i)}},n.bindSelectors=function(e,t){const n={};return Object.keys(e).forEach((r=>{const{selectors:o,rootSelectors:i={}}=e[r];Object.keys(o).forEach((e=>{if(n[e])throw new Error(`Duplicate selector "${e}"`);n[e]=(...n)=>o[e](t()[r],...n)})),Object.keys(i).forEach((e=>{if(n[e])throw new Error(`Duplicate selector "${e}"`);n[e]=(...n)=>i[e](t(),...n)}))})),n},n.awaitStateChange=function(e,t){const n=t(e);return null!==n?Promise.resolve(n):new Promise((n=>{const r=e.subscribe((()=>{const o=t(e);null!==o&&(r(),n(o))}))}))}},{}],229:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.countIf=function(e,t){return e.reduce(((e,n)=>t(n)?e+1:e),0)},n.toTrueMap=function(e){const t={};return e.forEach((e=>t[e]=!0)),t},n.trueKeys=function(e){return Object.keys(e).filter((t=>!0===e[t]))}},{}],230:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.copyText=function(e){const t=document.createElement("textarea");t.value=e,t.setAttribute("data-testid","copy-text"),t.contentEditable="true",document.body.appendChild(t),t.focus();try{const e=document.createRange(),n=document.getSelection();n.removeAllRanges(),e.selectNodeContents(t),n.addRange(e),t.setSelectionRange(0,t.value.length),document.execCommand("copy")}finally{t.remove()}}},{}],231:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){e.addEventListener("click",(e=>{const t=e.target;if("A"===t.tagName){const e=t;"_blank"===e.target&&(e.rel="noopener")}}))}},{}],232:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getElementHeightWithMargins=function(e){const t=window.getComputedStyle(e);return e.getBoundingClientRect().height+(parseFloat(t.marginTop)+parseFloat(t.marginBottom))}},{}],233:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.fetchJSON=async function(e,t){let n,o;try{n=await fetch(e,t)}catch(s){throw new r(e,null,s.message)}if(204===n.status)return null;try{o=await n.json()}catch(s){throw new r(e,n,"Failed to parse response")}var i;if(!n.ok)throw new r(e,n,null===(i=o)||void 0===i?void 0:i.reason);return o},n.FetchError=void 0;class r extends Error{constructor(e,t,n=""){let r="Network request failed";t&&(r+=` (${t.status})`),n&&(r+=`: ${n}`),super(r),this.url=e,this.response=t,this.reason=n}}n.FetchError=r},{}],234:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return e}},{}],235:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){if(1!==e.length)throw new Error("Memoize input must be a function of one argument");let t,n;return function(r){return r===t||(t=r,n=e(r)),n}}},{}],236:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.TokenError=void 0;var r=e("./fetch"),o=e("./random");class i extends Error{constructor(e,t){super(e),this.cause=t}}n.TokenError=i;n.default=class{constructor(e){this.clientId=e.clientId,this.tokenEndpoint=e.tokenEndpoint,this.authorizationEndpoint=e.authorizationEndpoint,this.revokeEndpoint=e.revokeEndpoint}exchangeAuthCode(e){return this._getAccessToken({client_id:this.clientId,grant_type:"authorization_code",code:e})}exchangeGrantToken(e){return this._getAccessToken({grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:e})}refreshToken(e){return this._getAccessToken({grant_type:"refresh_token",refresh_token:e})}async revokeToken(e){try{await this._formPost(this.revokeEndpoint,{token:e})}catch(t){throw new i("Failed to revoke access token",t)}}authorize(e,t){const n=(0,o.generateHexString)(16),r=new Promise(((t,r)=>{e.addEventListener("message",(function o(i){"object"==typeof i.data&&i.data.state===n&&("authorization_response"===i.data.type&&t(i.data),"authorization_canceled"===i.data.type&&r(new Error("Authorization window was closed")),e.removeEventListener("message",o))}))})),i=new URL(this.authorizationEndpoint);return i.searchParams.set("client_id",this.clientId),i.searchParams.set("origin",e.location.origin),i.searchParams.set("response_mode","web_message"),i.searchParams.set("response_type","code"),i.searchParams.set("state",n),t.location=i.toString(),r.then((e=>e.code))}async _formPost(e,t){const n=new URLSearchParams;for(let[r,o]of Object.entries(t))n.set(r,o);return n.sort(),(0,r.fetchJSON)(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n.toString()})}async _getAccessToken(e){let t;try{t=await this._formPost(this.tokenEndpoint,e)}catch(n){throw new i("Failed to fetch access token",n)}return{accessToken:t.access_token,expiresAt:Date.now()+1e3*(t.expires_in-10),refreshToken:t.refresh_token}}static openAuthPopupWindow(e){const t=`left=${e.screen.width/2-237.5},top=${e.screen.height/2-215},width=475,height=430`,n=e.open("about:blank","Log in to Hypothesis",t);if(!n)throw new Error("Failed to open login window");return n}}},{"./fetch":233,"./random":240}],237:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){if("undefined"!=typeof ResizeObserver){const n=new ResizeObserver((()=>t(e.clientWidth,e.clientHeight)));return n.observe(e),()=>n.disconnect()}const n=new r.ListenerCollection;let o=e.clientWidth,i=e.clientHeight;const s=()=>{o===e.clientWidth&&i===e.clientHeight||(o=e.clientWidth,i=e.clientHeight,t(o,i))};n.add(e,"load",s),n.add(window,"resize",s);const a=new MutationObserver(s);return a.observe(e,{characterData:!0,childList:!0,subtree:!0}),()=>{n.removeAll(),a.disconnect()}};var r=e("../../annotator/util/listener-collection")},{"../../annotator/util/listener-collection":38}],238:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.pageNumberOptions=function(e,t,n=5){if(t<=1)return[];const r=new Set([1,e,t]);let o=1;for(;r.size<Math.min(t,n);)e+o<=t&&r.add(e+o),e-o>=1&&r.add(e-o),++o;const i=[];return[...r].sort(((e,t)=>e-t)).forEach(((e,t,n)=>{t>0&&e-n[t-1]>1&&i.push(null),i.push(e)})),i}},{}],239:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.call=function(e,t,n,o=[],i=2e3,s=window,a=function(){return(0,r.generateHexString)(10)}()){const c={jsonrpc:"2.0",method:n,params:o,id:a};try{e.postMessage(c,t)}catch(d){return Promise.reject(d)}let l;const u=[new Promise(((e,n)=>{l=r=>{if(r.origin!==t)return;if(!(r.data instanceof Object)||"2.0"!==r.data.jsonrpc||r.data.id!==a)return;const{error:o,result:i}=r.data;void 0!==o?n(o):void 0!==i?e(i):n(new Error("RPC reply had no result or error"))},s.addEventListener("message",l)}))];return i&&u.push(function(e,t){return new Promise(((n,r)=>{setTimeout((()=>r(new Error(t))),e)}))}(i,`Request to ${t} timed out`)),Promise.race(u).then((e=>(s.removeEventListener("message",l),e))).catch((e=>{throw s.removeEventListener("message",l),e}))};var r=e("./random")},{"./random":240}],240:[function(e,t,n){"use strict";function r(e){const t=e.toString(16);return 1===t.length?"0"+t:t}Object.defineProperty(n,"__esModule",{value:!0}),n.generateHexString=function(e){const t=new Uint8Array(e/2);return window.crypto.getRandomValues(t),Array.from(t).map(r).join("")}},{}],241:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.retryPromiseOperation=function(e,t){return new Promise(((n,r)=>{const i=o.default.operation(t);i.attempt((async()=>{try{const t=await e();i.retry(),n(t)}catch(t){i.retry(t)||r(t)}}))}))};var r,o=(r=e("retry"))&&r.__esModule?r:{default:r}},{retry:32}],242:[function(e,t,n){"use strict";function r(e){const t=e.slice(0,e.indexOf(":"));return t&&["group","quote","since","tag","text","uri","user"].includes(t)?[t,e.slice(t.length+1)]:[null,e]}function o(e){if(!e)return[];const t=function(e){const t=e.slice(0,1),n=e.slice(-1);return'"'!==t&&"'"!==t||t!==n||(e=e.slice(1,e.length-1)),e};let n=e.match(/(?:[^\s"']+|"[^"]*"|'[^']*')+/g)||[];n=n.map(t);for(let o=0;o<n.length;o++){const e=n[o],[i,s]=r(e);i&&(n[o]=i+":"+t(s))}return n}Object.defineProperty(n,"__esModule",{value:!0}),n.toObject=function(e){const t={},n=(e,n)=>t[e]?t[e].push(n):t[e]=[n];if(e){const t=o(e);for(const e of t){let[t,o]=r(e);t||(t="any",o=e),n("tag"===(i=t)?"tags":i,o)}}var i;return t},n.generateFacetedFilter=function(e,t={}){let n;const r=[],i=[],s=[],a=[],c=[],l=[],u=t.user?[t.user]:[];if(e){n=o(e);for(const e of n){const t=e.slice(0,e.indexOf(":")),n=e.slice(t.length+1);switch(t){case"quote":i.push(n);break;case"since":{const t=86400,n={sec:1,min:60,hour:3600,day:t,week:7*t,month:30*t,year:365*t},r=e.slice(6).toLowerCase().match(/^(\d+)(sec|min|hour|day|week|month|year)?$/);if(r){const e=parseFloat(r[1]),t=r[2]||"sec";s.push(e*n[t])}}break;case"tag":a.push(n);break;case"text":c.push(n);break;case"uri":l.push(n);break;case"user":u.push(n);break;default:r.push(e)}}}return{any:{terms:r,operator:"and"},quote:{terms:i,operator:"and"},since:{terms:s,operator:"and"},tag:{terms:a,operator:"and"},text:{terms:c,operator:"and"},uri:{terms:l,operator:"or"},user:{terms:u,operator:"or"}}}},{}],243:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.init=function(e){const t=function(){try{const e=document.currentScript;return new URL(e.src).origin}catch(e){return null}}(),n=t?[t]:void 0;o.init({dsn:e.dsn,environment:e.environment,allowUrls:n,ignoreErrors:["Network request failed","Object Not Found Matching Id"],release:"1.856.0",beforeSend:(e,t)=>{if(a>=5)return(0,i.default)("Client-side Sentry quota reached. No further Sentry events will be sent"),null;++a;try{const n=t&&t.originalException;n instanceof Event&&Object.assign(e.extra,{type:n.type,detail:n.detail,isTrusted:n.isTrusted})}catch(n){}return e}}),o.setExtra("document_url",document.referrer);const r=Array.from(document.querySelectorAll("script")).filter((e=>!e.type||e.type.match(/javascript|module/))).map((e=>e.src||"<inline>"));o.setExtra("loaded_scripts",r)},n.setUserInfo=function(e){o.setUser(e)},n.reset=function(){a=0};var r,o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}(e("@sentry/browser")),i=(r=e("../../shared/warn-once"))&&r.__esModule?r:{default:r};function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}let a=0},{"../../shared/warn-once":93,"@sentry/browser":"@sentry/browser"}],244:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.clearFormatters=function(){o={}},n.nextFuzzyUpdate=d,n.decayingInterval=function(e,t){let n;const r=new Date(e),o=()=>{const e=d(r,new Date);null!==e&&(n=setTimeout((()=>{t(),o()}),e+500))};return o(),()=>clearTimeout(n)},n.formatRelativeDate=function(e,t,n){return e?l(e,t).formatter(e,t,n):""},n.formatDate=function(e,t){return s(e,{year:"numeric",month:"short",day:"2-digit",weekday:"long",hour:"2-digit",minute:"2-digit"},t)};const r=36e5;let o={};function i(e,t){return t-e}function s(e,t,n=window.Intl){const r=JSON.stringify(t);let i=o[r];return i||(i=o[r]=new n.DateTimeFormat(void 0,t)),i.format(e)}const a=[{test:(e,t)=>i(e,t)<3e4,formatter:()=>"Just now",nextUpdate:1e3},{test:(e,t)=>i(e,t)<6e4,formatter:function(e,t){return`${Math.floor(i(e,t)/1e3)} secs ago`},nextUpdate:1e3},{test:(e,t)=>i(e,t)<1*r,formatter:function(e,t){const n=Math.floor(i(e,t)/6e4);return`${n} min${n>1?"s":""} ago`},nextUpdate:6e4},{test:(e,t)=>i(e,t)<24*r,formatter:function(e,t){const n=Math.floor(i(e,t)/r);return`${n} hr${n>1?"s":""} ago`},nextUpdate:1*r},{test:(e,t)=>e.getFullYear()===t.getFullYear(),formatter:function(e,t,n){return s(e,{month:"short",day:"numeric"},n)},nextUpdate:null}],c={test:()=>!0,formatter:function(e,t,n){return s(e,{day:"numeric",month:"short",year:"numeric"},n)},nextUpdate:null};function l(e,t){for(let n of a)if(n.test(e,t))return n;return c}function u(e){return!isNaN(e.valueOf())}function d(e,t){if(!e||!u(e)||!u(t))return null;let n=l(e,t).nextUpdate;return null===n?null:(n=Math.max(n,5e3),n=Math.min(n,20736e5),n)}},{}],245:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.notNull=function(e){return e}},{}],246:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.fold=function(e){return e.replace(r,"")},n.normalize=function(e){return e.normalize("NFKD")};const r=/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08E4-\u08FE\u0900-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C01-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C82\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D02\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u18A9\u1920-\u192B\u1930-\u193B\u19B0-\u19C0\u19C8\u19C9\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1DC0-\u1DE6\u1DFC-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C4\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE26]/g},{}],247:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.replaceURLParams=function(e,t){const n={};for(const r in t)if(t.hasOwnProperty(r)){const o=t[r],i=":"+r;-1!==e.indexOf(i)?e=e.replace(i,encodeURIComponent(String(o))):n[r]=o}return{url:e,unusedParams:n}},n.resolve=function(e,t){return new URL(e,t).href}},{}],248:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.watch=function(e,t,n){const r=Array.isArray(t),i=()=>r?t.map((e=>e())):t();let s=i();return e((()=>{const e=i();if(r?(0,o.default)(e,s):e===s)return;const t=s;s=e,n(e,t)}))};var r,o=(r=e("shallowequal"))&&r.__esModule?r:{default:r}},{shallowequal:36}],249:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Socket=n.RECONNECT_MIN_DELAY=n.CLOSE_ABNORMAL=n.CLOSE_GOING_AWAY=n.CLOSE_NORMAL=void 0;var r,o=(r=e("retry"))&&r.__esModule?r:{default:r},i=e("tiny-emitter");n.CLOSE_NORMAL=1e3;n.CLOSE_GOING_AWAY=1001;n.CLOSE_ABNORMAL=1006;n.RECONNECT_MIN_DELAY=1e3;class s extends i.TinyEmitter{constructor(e){super();const t=[];let n,r=null;const i=()=>{for(;t.length>0;){const e=JSON.stringify(t.shift());n.send(e)}},s=()=>{r=o.default.operation({minTimeout:2e3,retries:10,randomize:!0}),r.attempt((()=>{n=new WebSocket(e),n.onopen=e=>{r=null,i(),this.emit("open",e)},n.onclose=e=>{if(1e3===e.code||1001===e.code)return void this.emit("close",e);const t=new Error(`WebSocket closed abnormally, code: ${e.code}`);console.warn(t),((e,t)=>{if(r)return void(r.retry(e)||console.error("Reached max retries attempting to reconnect WebSocket"));let n=1e3;n+=Math.floor(Math.random()*n),setTimeout(t,n)})(t,s)},n.onerror=e=>{this.emit("error",e)},n.onmessage=e=>{this.emit("message",e)}}))};this.close=()=>{n.close(1e3)},this.send=e=>{t.push(e),this.isConnected()&&i()},this.isConnected=()=>n.readyState===WebSocket.OPEN,s()}}n.Socket=s},{retry:32,"tiny-emitter":37}]},{},[183]);
//# sourceMappingURL=sidebar.bundle.js.map